!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=171)}([function(module,exports){module.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},function(module,exports){var isArray=Array.isArray;module.exports=isArray},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var freeGlobal=__webpack_require__(37),freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},function(module,exports){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}module.exports=function(value){var type=_typeof(value);return null!=value&&("object"==type||"function"==type)}},function(module,exports,__webpack_require__){var baseTimes=__webpack_require__(43),castFunction=__webpack_require__(105),toInteger=__webpack_require__(106),nativeMin=Math.min;module.exports=function(n,iteratee){if((n=toInteger(n))<1||n>9007199254740991)return[];var index=4294967295,length=nativeMin(n,4294967295);iteratee=castFunction(iteratee),n-=4294967295;for(var result=baseTimes(length,iteratee);++index<n;)iteratee(index);return result}},function(module,exports,__webpack_require__){var baseIsNative=__webpack_require__(70),getValue=__webpack_require__(73);module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},function(module,exports){function backtrace(node){for(var path=[[node.x,node.y]];node.parent;)node=node.parent,path.push([node.x,node.y]);return path.reverse()}function interpolate(x0,y0,x1,y1){var sx,sy,dx,dy,err,e2,abs=Math.abs,line=[];for(sx=x0<x1?1:-1,sy=y0<y1?1:-1,err=(dx=abs(x1-x0))-(dy=abs(y1-y0));line.push([x0,y0]),x0!==x1||y0!==y1;)(e2=2*err)>-dy&&(err-=dy,x0+=sx),e2<dx&&(err+=dx,y0+=sy);return line}exports.backtrace=backtrace,exports.biBacktrace=function(nodeA,nodeB){var pathA=backtrace(nodeA),pathB=backtrace(nodeB);return pathA.concat(pathB.reverse())},exports.pathLength=function(path){var i,a,b,dx,dy,sum=0;for(i=1;i<path.length;++i)a=path[i-1],b=path[i],dx=a[0]-b[0],dy=a[1]-b[1],sum+=Math.sqrt(dx*dx+dy*dy);return sum},exports.interpolate=interpolate,exports.expandPath=function(path){var coord0,coord1,interpolated,interpolatedLen,i,j,expanded=[],len=path.length;if(len<2)return expanded;for(i=0;i<len-1;++i)for(coord0=path[i],coord1=path[i+1],interpolatedLen=(interpolated=interpolate(coord0[0],coord0[1],coord1[0],coord1[1])).length,j=0;j<interpolatedLen-1;++j)expanded.push(interpolated[j]);return expanded.push(path[len-1]),expanded},exports.smoothenPath=function(grid,path){var sx,sy,newPath,i,j,coord,line,testCoord,blocked,len=path.length,x0=path[0][0],y0=path[0][1],x1=path[len-1][0],y1=path[len-1][1];for(newPath=[[sx=x0,sy=y0]],i=2;i<len;++i){for(line=interpolate(sx,sy,(coord=path[i])[0],coord[1]),blocked=!1,j=1;j<line.length;++j)if(testCoord=line[j],!grid.isWalkableAt(testCoord[0],testCoord[1])){blocked=!0;break}blocked&&(lastValidCoord=path[i-1],newPath.push(lastValidCoord),sx=lastValidCoord[0],sy=lastValidCoord[1])}return newPath.push([x1,y1]),newPath},exports.compressPath=function(path){if(path.length<3)return path;var lx,ly,ldx,ldy,sq,i,compressed=[],sx=path[0][0],sy=path[0][1],px=path[1][0],py=path[1][1],dx=px-sx,dy=py-sy;for(dx/=sq=Math.sqrt(dx*dx+dy*dy),dy/=sq,compressed.push([sx,sy]),i=2;i<path.length;i++)lx=px,ly=py,ldx=dx,ldy=dy,dx=(px=path[i][0])-lx,dy=(py=path[i][1])-ly,dy/=sq=Math.sqrt(dx*dx+dy*dy),(dx/=sq)===ldx&&dy===ldy||compressed.push([lx,ly]);return compressed.push([px,py]),compressed}},function(module,exports,__webpack_require__){var arraySample=__webpack_require__(41),baseSample=__webpack_require__(90),isArray=__webpack_require__(1);module.exports=function(collection){return(isArray(collection)?arraySample:baseSample)(collection)}},function(module,exports,__webpack_require__){var _Symbol=__webpack_require__(14),getRawTag=__webpack_require__(62),objectToString=__webpack_require__(63),symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},function(module,exports){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}module.exports=function(value){return null!=value&&"object"==_typeof(value)}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(13);module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}},function(module,exports){module.exports={manhattan:function(dx,dy){return dx+dy},euclidean:function(dx,dy){return Math.sqrt(dx*dx+dy*dy)},octile:function(dx,dy){var F=Math.SQRT2-1;return dx<dy?F*dx+dy:F*dy+dx},chebyshev:function(dx,dy){return Math.max(dx,dy)}}},function(module,exports,__webpack_require__){var baseRandom=__webpack_require__(42),isIterateeCall=__webpack_require__(47),toFinite=__webpack_require__(48),freeParseFloat=parseFloat,nativeMin=Math.min,nativeRandom=Math.random;module.exports=function(lower,upper,floating){if(floating&&"boolean"!=typeof floating&&isIterateeCall(lower,upper,floating)&&(upper=floating=void 0),void 0===floating&&("boolean"==typeof upper?(floating=upper,upper=void 0):"boolean"==typeof lower&&(floating=lower,lower=void 0)),void 0===lower&&void 0===upper?(lower=0,upper=1):(lower=toFinite(lower),void 0===upper?(upper=lower,lower=0):upper=toFinite(upper)),lower>upper){var temp=lower;lower=upper,upper=temp}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin(lower+rand*(upper-lower+freeParseFloat("1e-"+((rand+"").length-1))),upper)}return baseRandom(lower,upper)}},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var baseGetTag=__webpack_require__(8),isObjectLike=__webpack_require__(9);module.exports=function(value){return"symbol"==_typeof(value)||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},function(module,exports,__webpack_require__){var _Symbol=__webpack_require__(2).Symbol;module.exports=_Symbol},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(5)(Object,"create");module.exports=nativeCreate},function(module,exports,__webpack_require__){var listCacheClear=__webpack_require__(78),listCacheDelete=__webpack_require__(79),listCacheGet=__webpack_require__(80),listCacheHas=__webpack_require__(81),listCacheSet=__webpack_require__(82);function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},function(module,exports,__webpack_require__){var eq=__webpack_require__(18);module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},function(module,exports){module.exports=function(value,other){return value===other||value!=value&&other!=other}},function(module,exports,__webpack_require__){var isKeyable=__webpack_require__(84);module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},function(module,exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(93),baseKeys=__webpack_require__(99),isArrayLike=__webpack_require__(31);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}},function(module,exports){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=_typeof(value);return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(155)},function(module,exports,__webpack_require__){var Heap=__webpack_require__(22),Util=__webpack_require__(6),Heuristic=__webpack_require__(11);__webpack_require__(0);function JumpPointFinderBase(opt){opt=opt||{},this.heuristic=opt.heuristic||Heuristic.manhattan,this.trackJumpRecursion=opt.trackJumpRecursion||!1}JumpPointFinderBase.prototype.findPath=function(startX,startY,endX,endY,grid){var node,openList=this.openList=new Heap((function(nodeA,nodeB){return nodeA.f-nodeB.f})),startNode=this.startNode=grid.getNodeAt(startX,startY),endNode=this.endNode=grid.getNodeAt(endX,endY);for(this.grid=grid,startNode.g=0,startNode.f=0,openList.push(startNode),startNode.opened=!0;!openList.empty();){if((node=openList.pop()).closed=!0,node===endNode)return Util.expandPath(Util.backtrace(endNode));this._identifySuccessors(node)}return[]},JumpPointFinderBase.prototype._identifySuccessors=function(node){var neighbors,neighbor,jumpPoint,i,l,jx,jy,d,ng,jumpNode,grid=this.grid,heuristic=this.heuristic,openList=this.openList,endX=this.endNode.x,endY=this.endNode.y,x=node.x,y=node.y,abs=Math.abs;Math.max;for(i=0,l=(neighbors=this._findNeighbors(node)).length;i<l;++i)if(neighbor=neighbors[i],jumpPoint=this._jump(neighbor[0],neighbor[1],x,y)){if(jx=jumpPoint[0],jy=jumpPoint[1],(jumpNode=grid.getNodeAt(jx,jy)).closed)continue;d=Heuristic.octile(abs(jx-x),abs(jy-y)),ng=node.g+d,(!jumpNode.opened||ng<jumpNode.g)&&(jumpNode.g=ng,jumpNode.h=jumpNode.h||heuristic(abs(jx-endX),abs(jy-endY)),jumpNode.f=jumpNode.g+jumpNode.h,jumpNode.parent=node,jumpNode.opened?openList.updateItem(jumpNode):(openList.push(jumpNode),jumpNode.opened=!0))}},module.exports=JumpPointFinderBase},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(36);module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},function(module,exports,__webpack_require__){var isArray=__webpack_require__(1),isKey=__webpack_require__(26),stringToPath=__webpack_require__(64),toString=__webpack_require__(88);module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var isArray=__webpack_require__(1),isSymbol=__webpack_require__(13),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=_typeof(value);return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}},function(module,exports,__webpack_require__){var mapCacheClear=__webpack_require__(67),mapCacheDelete=__webpack_require__(83),mapCacheGet=__webpack_require__(85),mapCacheHas=__webpack_require__(86),mapCacheSet=__webpack_require__(87);function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},function(module,exports,__webpack_require__){var Map=__webpack_require__(5)(__webpack_require__(2),"Map");module.exports=Map},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports){module.exports=function(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}},function(module,exports,__webpack_require__){var isFunction=__webpack_require__(38),isLength=__webpack_require__(30);module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},function(module,exports){module.exports=function(x,y,walkable){this.x=x,this.y=y,this.walkable=void 0===walkable||walkable}},function(module,exports,__webpack_require__){var Heap=__webpack_require__(22),Util=__webpack_require__(6),Heuristic=__webpack_require__(11),DiagonalMovement=__webpack_require__(0);function AStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}AStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var node,neighbors,neighbor,i,l,x,y,ng,openList=new Heap((function(nodeA,nodeB){return nodeA.f-nodeB.f})),startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),heuristic=this.heuristic,diagonalMovement=this.diagonalMovement,weight=this.weight,abs=Math.abs,SQRT2=Math.SQRT2;for(startNode.g=0,startNode.f=0,openList.push(startNode),startNode.opened=!0;!openList.empty();){if((node=openList.pop()).closed=!0,node===endNode)return Util.backtrace(endNode);for(i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)(neighbor=neighbors[i]).closed||(x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-endX),abs(y-endY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?openList.updateItem(neighbor):(openList.push(neighbor),neighbor.opened=!0)))}return[]},module.exports=AStarFinder},function(module,exports,__webpack_require__){var Heap=__webpack_require__(22),Util=__webpack_require__(6),Heuristic=__webpack_require__(11),DiagonalMovement=__webpack_require__(0);function BiAStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}BiAStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var node,neighbors,neighbor,i,l,x,y,ng,cmp=function(nodeA,nodeB){return nodeA.f-nodeB.f},startOpenList=new Heap(cmp),endOpenList=new Heap(cmp),startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),heuristic=this.heuristic,diagonalMovement=this.diagonalMovement,weight=this.weight,abs=Math.abs,SQRT2=Math.SQRT2;for(startNode.g=0,startNode.f=0,startOpenList.push(startNode),startNode.opened=1,endNode.g=0,endNode.f=0,endOpenList.push(endNode),endNode.opened=2;!startOpenList.empty()&&!endOpenList.empty();){for((node=startOpenList.pop()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed){if(2===neighbor.opened)return Util.biBacktrace(node,neighbor);x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-endX),abs(y-endY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?startOpenList.updateItem(neighbor):(startOpenList.push(neighbor),neighbor.opened=1))}for((node=endOpenList.pop()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed){if(1===neighbor.opened)return Util.biBacktrace(neighbor,node);x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-startX),abs(y-startY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?endOpenList.updateItem(neighbor):(endOpenList.push(neighbor),neighbor.opened=2))}}return[]},module.exports=BiAStarFinder},function(module,exports,__webpack_require__){module.exports=__webpack_require__(154)},function(module,exports,__webpack_require__){var castPath=__webpack_require__(25),toKey=__webpack_require__(10);module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},function(module,exports,__webpack_require__){(function(global){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var freeGlobal="object"==(void 0===global?"undefined":_typeof(global))&&global&&global.Object===Object&&global;module.exports=freeGlobal}).call(this,__webpack_require__(61))},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(8),isObject=__webpack_require__(3);module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}},function(module,exports){var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},function(module,exports){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},function(module,exports,__webpack_require__){var baseRandom=__webpack_require__(42);module.exports=function(array){var length=array.length;return length?array[baseRandom(0,length-1)]:void 0}},function(module,exports){var nativeFloor=Math.floor,nativeRandom=Math.random;module.exports=function(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}},function(module,exports){module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},function(module,exports,__webpack_require__){var baseIsArguments=__webpack_require__(94),isObjectLike=__webpack_require__(9),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},function(module,exports,__webpack_require__){(function(module){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var root=__webpack_require__(2),stubFalse=__webpack_require__(95),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer}).call(this,__webpack_require__(29)(module))},function(module,exports,__webpack_require__){var baseIsTypedArray=__webpack_require__(96),baseUnary=__webpack_require__(97),nodeUtil=__webpack_require__(98),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var eq=__webpack_require__(18),isArrayLike=__webpack_require__(31),isIndex=__webpack_require__(21),isObject=__webpack_require__(3);module.exports=function(value,index,object){if(!isObject(object))return!1;var type=_typeof(index);return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}},function(module,exports,__webpack_require__){var toNumber=__webpack_require__(49);module.exports=function(value){return value?(value=toNumber(value))===1/0||value===-1/0?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0}},function(module,exports,__webpack_require__){var baseTrim=__webpack_require__(103),isObject=__webpack_require__(3),isSymbol=__webpack_require__(13),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},function(module,exports){module.exports=function(value){return value}},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(16),stackClear=__webpack_require__(114),stackDelete=__webpack_require__(115),stackGet=__webpack_require__(116),stackHas=__webpack_require__(117),stackSet=__webpack_require__(118);function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},function(module,exports,__webpack_require__){var baseIsEqualDeep=__webpack_require__(119),isObjectLike=__webpack_require__(9);module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(120),arraySome=__webpack_require__(51),cacheHas=__webpack_require__(123);module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(3);module.exports=function(value){return value==value&&!isObject(value)}},function(module,exports){module.exports=function(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}}},function(module,exports,__webpack_require__){var baseSet=__webpack_require__(107);module.exports=function(object,path,value){return null==object?object:baseSet(object,path,value)}},function(module,exports,__webpack_require__){var arraySome=__webpack_require__(51),baseIteratee=__webpack_require__(111),baseSome=__webpack_require__(148),isArray=__webpack_require__(1),isIterateeCall=__webpack_require__(47);module.exports=function(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=void 0),func(collection,baseIteratee(predicate,3))}},function(module,exports){module.exports=function(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}},function(module,exports,__webpack_require__){var debounce=__webpack_require__(169),isObject=__webpack_require__(3);module.exports=function(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}},function(module,exports){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var g;g=function(){return this}();try{g=g||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){var _Symbol=__webpack_require__(14),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},function(module,exports){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},function(module,exports,__webpack_require__){var memoizeCapped=__webpack_require__(65),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));module.exports=stringToPath},function(module,exports,__webpack_require__){var memoize=__webpack_require__(66);module.exports=function(func){var result=memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(27);function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},function(module,exports,__webpack_require__){var Hash=__webpack_require__(68),ListCache=__webpack_require__(16),Map=__webpack_require__(28);module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},function(module,exports,__webpack_require__){var hashClear=__webpack_require__(69),hashDelete=__webpack_require__(74),hashGet=__webpack_require__(75),hashHas=__webpack_require__(76),hashSet=__webpack_require__(77);function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(15);module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},function(module,exports,__webpack_require__){var isFunction=__webpack_require__(38),isMasked=__webpack_require__(71),isObject=__webpack_require__(3),toSource=__webpack_require__(39),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},function(module,exports,__webpack_require__){var uid,coreJsData=__webpack_require__(72),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},function(module,exports,__webpack_require__){var coreJsData=__webpack_require__(2)["__core-js_shared__"];module.exports=coreJsData},function(module,exports){module.exports=function(object,key){return null==object?void 0:object[key]}},function(module,exports){module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(15),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(15),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(15);module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this}},function(module,exports){module.exports=function(){this.__data__=[],this.size=0}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(17),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(17);module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(17);module.exports=function(key){return assocIndexOf(this.__data__,key)>-1}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(17);module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(19);module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},function(module,exports){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}module.exports=function(value){var type=_typeof(value);return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(19);module.exports=function(key){return getMapData(this,key).get(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(19);module.exports=function(key){return getMapData(this,key).has(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(19);module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},function(module,exports,__webpack_require__){var baseToString=__webpack_require__(89);module.exports=function(value){return null==value?"":baseToString(value)}},function(module,exports,__webpack_require__){var _Symbol=__webpack_require__(14),arrayMap=__webpack_require__(40),isArray=__webpack_require__(1),isSymbol=__webpack_require__(13),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}},function(module,exports,__webpack_require__){var arraySample=__webpack_require__(41),values=__webpack_require__(91);module.exports=function(collection){return arraySample(values(collection))}},function(module,exports,__webpack_require__){var baseValues=__webpack_require__(92),keys=__webpack_require__(20);module.exports=function(object){return null==object?[]:baseValues(object,keys(object))}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(40);module.exports=function(object,props){return arrayMap(props,(function(key){return object[key]}))}},function(module,exports,__webpack_require__){var baseTimes=__webpack_require__(43),isArguments=__webpack_require__(44),isArray=__webpack_require__(1),isBuffer=__webpack_require__(45),isIndex=__webpack_require__(21),isTypedArray=__webpack_require__(46),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(8),isObjectLike=__webpack_require__(9);module.exports=function(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}},function(module,exports){module.exports=function(){return!1}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(8),isLength=__webpack_require__(30),isObjectLike=__webpack_require__(9),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},function(module,exports){module.exports=function(func){return function(value){return func(value)}}},function(module,exports,__webpack_require__){(function(module){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var freeGlobal=__webpack_require__(37),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil}).call(this,__webpack_require__(29)(module))},function(module,exports,__webpack_require__){var isPrototype=__webpack_require__(100),nativeKeys=__webpack_require__(101),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},function(module,exports){var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},function(module,exports,__webpack_require__){var nativeKeys=__webpack_require__(102)(Object.keys,Object);module.exports=nativeKeys},function(module,exports){module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},function(module,exports,__webpack_require__){var trimmedEndIndex=__webpack_require__(104),reTrimStart=/^\s+/;module.exports=function(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},function(module,exports){var reWhitespace=/\s/;module.exports=function(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},function(module,exports,__webpack_require__){var identity=__webpack_require__(50);module.exports=function(value){return"function"==typeof value?value:identity}},function(module,exports,__webpack_require__){var toFinite=__webpack_require__(48);module.exports=function(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(108),castPath=__webpack_require__(25),isIndex=__webpack_require__(21),isObject=__webpack_require__(3),toKey=__webpack_require__(10);module.exports=function(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(109),eq=__webpack_require__(18),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(110);module.exports=function(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}},function(module,exports,__webpack_require__){var getNative=__webpack_require__(5),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var baseMatches=__webpack_require__(112),baseMatchesProperty=__webpack_require__(141),identity=__webpack_require__(50),isArray=__webpack_require__(1),property=__webpack_require__(145);module.exports=function(value){return"function"==typeof value?value:null==value?identity:"object"==_typeof(value)?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}},function(module,exports,__webpack_require__){var baseIsMatch=__webpack_require__(113),getMatchData=__webpack_require__(140),matchesStrictComparable=__webpack_require__(56);module.exports=function(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(52),baseIsEqual=__webpack_require__(53);module.exports=function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(16);module.exports=function(){this.__data__=new ListCache,this.size=0}},function(module,exports){module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},function(module,exports){module.exports=function(key){return this.__data__.get(key)}},function(module,exports){module.exports=function(key){return this.__data__.has(key)}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(16),Map=__webpack_require__(28),MapCache=__webpack_require__(27);module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(52),equalArrays=__webpack_require__(54),equalByTag=__webpack_require__(124),equalObjects=__webpack_require__(128),getTag=__webpack_require__(135),isArray=__webpack_require__(1),isBuffer=__webpack_require__(45),isTypedArray=__webpack_require__(46),objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?"[object Array]":getTag(object),othTag=othIsArr?"[object Array]":getTag(other),objIsObj=(objTag="[object Arguments]"==objTag?objectTag:objTag)==objectTag,othIsObj=(othTag="[object Arguments]"==othTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(27),setCacheAdd=__webpack_require__(121),setCacheHas=__webpack_require__(122);function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},function(module,exports){module.exports=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this}},function(module,exports){module.exports=function(value){return this.__data__.has(value)}},function(module,exports){module.exports=function(cache,key){return cache.has(key)}},function(module,exports,__webpack_require__){var _Symbol=__webpack_require__(14),Uint8Array=__webpack_require__(125),eq=__webpack_require__(18),equalArrays=__webpack_require__(54),mapToArray=__webpack_require__(126),setToArray=__webpack_require__(127),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},function(module,exports,__webpack_require__){var Uint8Array=__webpack_require__(2).Uint8Array;module.exports=Uint8Array},function(module,exports){module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}},function(module,exports){module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}},function(module,exports,__webpack_require__){var getAllKeys=__webpack_require__(129),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result}},function(module,exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(130),getSymbols=__webpack_require__(132),keys=__webpack_require__(20);module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(131),isArray=__webpack_require__(1);module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},function(module,exports){module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},function(module,exports,__webpack_require__){var arrayFilter=__webpack_require__(133),stubArray=__webpack_require__(134),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)})))}:stubArray;module.exports=getSymbols},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},function(module,exports){module.exports=function(){return[]}},function(module,exports,__webpack_require__){var DataView=__webpack_require__(136),Map=__webpack_require__(28),Promise=__webpack_require__(137),Set=__webpack_require__(138),WeakMap=__webpack_require__(139),baseGetTag=__webpack_require__(8),toSource=__webpack_require__(39),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},function(module,exports,__webpack_require__){var DataView=__webpack_require__(5)(__webpack_require__(2),"DataView");module.exports=DataView},function(module,exports,__webpack_require__){var Promise=__webpack_require__(5)(__webpack_require__(2),"Promise");module.exports=Promise},function(module,exports,__webpack_require__){var Set=__webpack_require__(5)(__webpack_require__(2),"Set");module.exports=Set},function(module,exports,__webpack_require__){var WeakMap=__webpack_require__(5)(__webpack_require__(2),"WeakMap");module.exports=WeakMap},function(module,exports,__webpack_require__){var isStrictComparable=__webpack_require__(55),keys=__webpack_require__(20);module.exports=function(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}},function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(53),get=__webpack_require__(24),hasIn=__webpack_require__(142),isKey=__webpack_require__(26),isStrictComparable=__webpack_require__(55),matchesStrictComparable=__webpack_require__(56),toKey=__webpack_require__(10);module.exports=function(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}},function(module,exports,__webpack_require__){var baseHasIn=__webpack_require__(143),hasPath=__webpack_require__(144);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHasIn)}},function(module,exports){module.exports=function(object,key){return null!=object&&key in Object(object)}},function(module,exports,__webpack_require__){var castPath=__webpack_require__(25),isArguments=__webpack_require__(44),isArray=__webpack_require__(1),isIndex=__webpack_require__(21),isLength=__webpack_require__(30),toKey=__webpack_require__(10);module.exports=function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}},function(module,exports,__webpack_require__){var baseProperty=__webpack_require__(146),basePropertyDeep=__webpack_require__(147),isKey=__webpack_require__(26),toKey=__webpack_require__(10);module.exports=function(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}},function(module,exports){module.exports=function(key){return function(object){return null==object?void 0:object[key]}}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(36);module.exports=function(path){return function(object){return baseGet(object,path)}}},function(module,exports,__webpack_require__){var baseEach=__webpack_require__(149);module.exports=function(collection,predicate){var result;return baseEach(collection,(function(value,index,collection){return!(result=predicate(value,index,collection))})),!!result}},function(module,exports,__webpack_require__){var baseForOwn=__webpack_require__(150),baseEach=__webpack_require__(153)(baseForOwn);module.exports=baseEach},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(151),keys=__webpack_require__(20);module.exports=function(object,iteratee){return object&&baseFor(object,iteratee,keys)}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(152)();module.exports=baseFor},function(module,exports){module.exports=function(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}},function(module,exports,__webpack_require__){var isArrayLike=__webpack_require__(31);module.exports=function(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}},function(module,exports,__webpack_require__){module.exports={Heap:__webpack_require__(22),Node:__webpack_require__(32),Grid:__webpack_require__(156),Util:__webpack_require__(6),DiagonalMovement:__webpack_require__(0),Heuristic:__webpack_require__(11),AStarFinder:__webpack_require__(33),BestFirstFinder:__webpack_require__(157),BreadthFirstFinder:__webpack_require__(158),DijkstraFinder:__webpack_require__(159),BiAStarFinder:__webpack_require__(34),BiBestFirstFinder:__webpack_require__(160),BiBreadthFirstFinder:__webpack_require__(161),BiDijkstraFinder:__webpack_require__(162),IDAStarFinder:__webpack_require__(163),JumpPointFinder:__webpack_require__(164)}},function(module,exports,__webpack_require__){(function(module){(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min,defaultCmp=function(x,y){return x<y?-1:x>y?1:0},insort=function(a,x,lo,hi,cmp){var mid;if(null==lo&&(lo=0),null==cmp&&(cmp=defaultCmp),lo<0)throw new Error("lo must be non-negative");for(null==hi&&(hi=a.length);lo<hi;)cmp(x,a[mid=floor((lo+hi)/2)])<0?hi=mid:lo=mid+1;return[].splice.apply(a,[lo,lo-lo].concat(x)),x},heappush=function(array,item,cmp){return null==cmp&&(cmp=defaultCmp),array.push(item),_siftdown(array,0,array.length-1,cmp)},heappop=function(array,cmp){var lastelt,returnitem;return null==cmp&&(cmp=defaultCmp),lastelt=array.pop(),array.length?(returnitem=array[0],array[0]=lastelt,_siftup(array,0,cmp)):returnitem=lastelt,returnitem},heapreplace=function(array,item,cmp){var returnitem;return null==cmp&&(cmp=defaultCmp),returnitem=array[0],array[0]=item,_siftup(array,0,cmp),returnitem},heappushpop=function(array,item,cmp){var _ref;return null==cmp&&(cmp=defaultCmp),array.length&&cmp(array[0],item)<0&&(item=(_ref=[array[0],item])[0],array[0]=_ref[1],_siftup(array,0,cmp)),item},heapify=function(array,cmp){var i,_i,_len,_ref1,_results,_results1;for(null==cmp&&(cmp=defaultCmp),_results=[],_i=0,_len=(_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse()).length;_i<_len;_i++)i=_ref1[_i],_results.push(_siftup(array,i,cmp));return _results},updateItem=function(array,item,cmp){var pos;if(null==cmp&&(cmp=defaultCmp),-1!==(pos=array.indexOf(item)))return _siftdown(array,0,pos,cmp),_siftup(array,pos,cmp)},nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(null==cmp&&(cmp=defaultCmp),!(result=array.slice(0,n)).length)return result;for(heapify(result,cmp),_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)elem=_ref[_i],heappushpop(result,elem,cmp);return result.sort(cmp).reverse()},nsmallest=function(array,n,cmp){var elem,los,result,_i,_j,_len,_ref,_ref1,_results;if(null==cmp&&(cmp=defaultCmp),10*n<=array.length){if(!(result=array.slice(0,n).sort(cmp)).length)return result;for(los=result[result.length-1],_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)cmp(elem=_ref[_i],los)<0&&(insort(result,elem,0,null,cmp),result.pop(),los=result[result.length-1]);return result}for(heapify(array,cmp),_results=[],_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results},_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;for(null==cmp&&(cmp=defaultCmp),newitem=array[pos];pos>startpos&&cmp(newitem,parent=array[parentpos=pos-1>>1])<0;)array[pos]=parent,pos=parentpos;return array[pos]=newitem},_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;for(null==cmp&&(cmp=defaultCmp),endpos=array.length,startpos=pos,newitem=array[pos],childpos=2*pos+1;childpos<endpos;)(rightpos=childpos+1)<endpos&&!(cmp(array[childpos],array[rightpos])<0)&&(childpos=rightpos),array[pos]=array[childpos],childpos=2*(pos=childpos)+1;return array[pos]=newitem,_siftdown(array,startpos,pos,cmp)},Heap=function(){function Heap(cmp){this.cmp=null!=cmp?cmp:defaultCmp,this.nodes=[]}return Heap.push=heappush,Heap.pop=heappop,Heap.replace=heapreplace,Heap.pushpop=heappushpop,Heap.heapify=heapify,Heap.updateItem=updateItem,Heap.nlargest=nlargest,Heap.nsmallest=nsmallest,Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)},Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)},Heap.prototype.peek=function(){return this.nodes[0]},Heap.prototype.contains=function(x){return-1!==this.nodes.indexOf(x)},Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)},Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)},Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)},Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)},Heap.prototype.clear=function(){return this.nodes=[]},Heap.prototype.empty=function(){return 0===this.nodes.length},Heap.prototype.size=function(){return this.nodes.length},Heap.prototype.clone=function(){var heap;return(heap=new Heap).nodes=this.nodes.slice(0),heap},Heap.prototype.toArray=function(){return this.nodes.slice(0)},Heap.prototype.insert=Heap.prototype.push,Heap.prototype.top=Heap.prototype.peek,Heap.prototype.front=Heap.prototype.peek,Heap.prototype.has=Heap.prototype.contains,Heap.prototype.copy=Heap.prototype.clone,Heap}(),(null!==module?module.exports:void 0)?module.exports=Heap:window.Heap=Heap}).call(this)}).call(this,__webpack_require__(29)(module))},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var Node=__webpack_require__(32),DiagonalMovement=__webpack_require__(0);function Grid(width_or_matrix,height,matrix){var width;"object"!==_typeof(width_or_matrix)?width=width_or_matrix:(height=width_or_matrix.length,width=width_or_matrix[0].length,matrix=width_or_matrix),this.width=width,this.height=height,this.nodes=this._buildNodes(width,height,matrix)}Grid.prototype._buildNodes=function(width,height,matrix){var i,j,nodes=new Array(height);for(i=0;i<height;++i)for(nodes[i]=new Array(width),j=0;j<width;++j)nodes[i][j]=new Node(j,i);if(void 0===matrix)return nodes;if(matrix.length!==height||matrix[0].length!==width)throw new Error("Matrix size does not fit");for(i=0;i<height;++i)for(j=0;j<width;++j)matrix[i][j]&&(nodes[i][j].walkable=!1);return nodes},Grid.prototype.getNodeAt=function(x,y){return this.nodes[y][x]},Grid.prototype.isWalkableAt=function(x,y){return this.isInside(x,y)&&this.nodes[y][x].walkable},Grid.prototype.isInside=function(x,y){return x>=0&&x<this.width&&y>=0&&y<this.height},Grid.prototype.setWalkableAt=function(x,y,walkable){this.nodes[y][x].walkable=walkable},Grid.prototype.getNeighbors=function(node,diagonalMovement){var x=node.x,y=node.y,neighbors=[],s0=!1,d0=!1,s1=!1,d1=!1,s2=!1,d2=!1,s3=!1,d3=!1,nodes=this.nodes;if(this.isWalkableAt(x,y-1)&&(neighbors.push(nodes[y-1][x]),s0=!0),this.isWalkableAt(x+1,y)&&(neighbors.push(nodes[y][x+1]),s1=!0),this.isWalkableAt(x,y+1)&&(neighbors.push(nodes[y+1][x]),s2=!0),this.isWalkableAt(x-1,y)&&(neighbors.push(nodes[y][x-1]),s3=!0),diagonalMovement===DiagonalMovement.Never)return neighbors;if(diagonalMovement===DiagonalMovement.OnlyWhenNoObstacles)d0=s3&&s0,d1=s0&&s1,d2=s1&&s2,d3=s2&&s3;else if(diagonalMovement===DiagonalMovement.IfAtMostOneObstacle)d0=s3||s0,d1=s0||s1,d2=s1||s2,d3=s2||s3;else{if(diagonalMovement!==DiagonalMovement.Always)throw new Error("Incorrect value of diagonalMovement");d0=!0,d1=!0,d2=!0,d3=!0}return d0&&this.isWalkableAt(x-1,y-1)&&neighbors.push(nodes[y-1][x-1]),d1&&this.isWalkableAt(x+1,y-1)&&neighbors.push(nodes[y-1][x+1]),d2&&this.isWalkableAt(x+1,y+1)&&neighbors.push(nodes[y+1][x+1]),d3&&this.isWalkableAt(x-1,y+1)&&neighbors.push(nodes[y+1][x-1]),neighbors},Grid.prototype.clone=function(){var i,j,width=this.width,height=this.height,thisNodes=this.nodes,newGrid=new Grid(width,height),newNodes=new Array(height);for(i=0;i<height;++i)for(newNodes[i]=new Array(width),j=0;j<width;++j)newNodes[i][j]=new Node(j,i,thisNodes[i][j].walkable);return newGrid.nodes=newNodes,newGrid},module.exports=Grid},function(module,exports,__webpack_require__){var AStarFinder=__webpack_require__(33);function BestFirstFinder(opt){AStarFinder.call(this,opt);var orig=this.heuristic;this.heuristic=function(dx,dy){return 1e6*orig(dx,dy)}}BestFirstFinder.prototype=new AStarFinder,BestFirstFinder.prototype.constructor=BestFirstFinder,module.exports=BestFirstFinder},function(module,exports,__webpack_require__){var Util=__webpack_require__(6),DiagonalMovement=__webpack_require__(0);function BreadthFirstFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never)}BreadthFirstFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var neighbors,neighbor,node,i,l,openList=[],diagonalMovement=this.diagonalMovement,startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY);for(openList.push(startNode),startNode.opened=!0;openList.length;){if((node=openList.shift()).closed=!0,node===endNode)return Util.backtrace(endNode);for(i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)(neighbor=neighbors[i]).closed||neighbor.opened||(openList.push(neighbor),neighbor.opened=!0,neighbor.parent=node)}return[]},module.exports=BreadthFirstFinder},function(module,exports,__webpack_require__){var AStarFinder=__webpack_require__(33);function DijkstraFinder(opt){AStarFinder.call(this,opt),this.heuristic=function(dx,dy){return 0}}DijkstraFinder.prototype=new AStarFinder,DijkstraFinder.prototype.constructor=DijkstraFinder,module.exports=DijkstraFinder},function(module,exports,__webpack_require__){var BiAStarFinder=__webpack_require__(34);function BiBestFirstFinder(opt){BiAStarFinder.call(this,opt);var orig=this.heuristic;this.heuristic=function(dx,dy){return 1e6*orig(dx,dy)}}BiBestFirstFinder.prototype=new BiAStarFinder,BiBestFirstFinder.prototype.constructor=BiBestFirstFinder,module.exports=BiBestFirstFinder},function(module,exports,__webpack_require__){var Util=__webpack_require__(6),DiagonalMovement=__webpack_require__(0);function BiBreadthFirstFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never)}BiBreadthFirstFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var neighbors,neighbor,node,i,l,startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),startOpenList=[],endOpenList=[],diagonalMovement=this.diagonalMovement;for(startOpenList.push(startNode),startNode.opened=!0,startNode.by=0,endOpenList.push(endNode),endNode.opened=!0,endNode.by=1;startOpenList.length&&endOpenList.length;){for((node=startOpenList.shift()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed)if(neighbor.opened){if(1===neighbor.by)return Util.biBacktrace(node,neighbor)}else startOpenList.push(neighbor),neighbor.parent=node,neighbor.opened=!0,neighbor.by=0;for((node=endOpenList.shift()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed)if(neighbor.opened){if(0===neighbor.by)return Util.biBacktrace(neighbor,node)}else endOpenList.push(neighbor),neighbor.parent=node,neighbor.opened=!0,neighbor.by=1}return[]},module.exports=BiBreadthFirstFinder},function(module,exports,__webpack_require__){var BiAStarFinder=__webpack_require__(34);function BiDijkstraFinder(opt){BiAStarFinder.call(this,opt),this.heuristic=function(dx,dy){return 0}}BiDijkstraFinder.prototype=new BiAStarFinder,BiDijkstraFinder.prototype.constructor=BiDijkstraFinder,module.exports=BiDijkstraFinder},function(module,exports,__webpack_require__){__webpack_require__(6);var Heuristic=__webpack_require__(11),Node=__webpack_require__(32),DiagonalMovement=__webpack_require__(0);function IDAStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.trackRecursion=opt.trackRecursion||!1,this.timeLimit=opt.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}IDAStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var j,route,t,startTime=(new Date).getTime(),h=function(a,b){return this.heuristic(Math.abs(b.x-a.x),Math.abs(b.y-a.y))}.bind(this),search=function(node,g,cutoff,route,depth){if(this.timeLimit>0&&(new Date).getTime()-startTime>1e3*this.timeLimit)return 1/0;var min,t,k,neighbour,f=g+h(node,end)*this.weight;if(f>cutoff)return f;if(node==end)return route[depth]=[node.x,node.y],node;var a,b,neighbours=grid.getNeighbors(node,this.diagonalMovement);for(k=0,min=1/0;neighbour=neighbours[k];++k){if(this.trackRecursion&&(neighbour.retainCount=neighbour.retainCount+1||1,!0!==neighbour.tested&&(neighbour.tested=!0)),(t=search(neighbour,g+(b=neighbour,(a=node).x===b.x||a.y===b.y?1:Math.SQRT2),cutoff,route,depth+1))instanceof Node)return route[depth]=[node.x,node.y],t;this.trackRecursion&&0==--neighbour.retainCount&&(neighbour.tested=!1),t<min&&(min=t)}return min}.bind(this),start=grid.getNodeAt(startX,startY),end=grid.getNodeAt(endX,endY),cutOff=h(start,end);for(j=0;;++j){if((t=search(start,0,cutOff,route=[],0))===1/0)return[];if(t instanceof Node)return route;cutOff=t}return[]},module.exports=IDAStarFinder},function(module,exports,__webpack_require__){var DiagonalMovement=__webpack_require__(0),JPFNeverMoveDiagonally=__webpack_require__(165),JPFAlwaysMoveDiagonally=__webpack_require__(166),JPFMoveDiagonallyIfNoObstacles=__webpack_require__(167),JPFMoveDiagonallyIfAtMostOneObstacle=__webpack_require__(168);module.exports=function(opt){return(opt=opt||{}).diagonalMovement===DiagonalMovement.Never?new JPFNeverMoveDiagonally(opt):opt.diagonalMovement===DiagonalMovement.Always?new JPFAlwaysMoveDiagonally(opt):opt.diagonalMovement===DiagonalMovement.OnlyWhenNoObstacles?new JPFMoveDiagonallyIfNoObstacles(opt):new JPFMoveDiagonallyIfAtMostOneObstacle(opt)}},function(module,exports,__webpack_require__){var JumpPointFinderBase=__webpack_require__(23),DiagonalMovement=__webpack_require__(0);function JPFNeverMoveDiagonally(opt){JumpPointFinderBase.call(this,opt)}JPFNeverMoveDiagonally.prototype=new JumpPointFinderBase,JPFNeverMoveDiagonally.prototype.constructor=JPFNeverMoveDiagonally,JPFNeverMoveDiagonally.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx){if(grid.isWalkableAt(x,y-1)&&!grid.isWalkableAt(x-dx,y-1)||grid.isWalkableAt(x,y+1)&&!grid.isWalkableAt(x-dx,y+1))return[x,y]}else{if(0===dy)throw new Error("Only horizontal and vertical movements are allowed");if(grid.isWalkableAt(x-1,y)&&!grid.isWalkableAt(x-1,y-dy)||grid.isWalkableAt(x+1,y)&&!grid.isWalkableAt(x+1,y-dy))return[x,y];if(this._jump(x+1,y,x,y)||this._jump(x-1,y,x,y))return[x,y]}return this._jump(x+dx,y+dy,x,y)},JPFNeverMoveDiagonally.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx?(grid.isWalkableAt(x,y-1)&&neighbors.push([x,y-1]),grid.isWalkableAt(x,y+1)&&neighbors.push([x,y+1]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y])):0!==dy&&(grid.isWalkableAt(x-1,y)&&neighbors.push([x-1,y]),grid.isWalkableAt(x+1,y)&&neighbors.push([x+1,y]),grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.Never)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFNeverMoveDiagonally},function(module,exports,__webpack_require__){var JumpPointFinderBase=__webpack_require__(23),DiagonalMovement=__webpack_require__(0);function JPFAlwaysMoveDiagonally(opt){JumpPointFinderBase.call(this,opt)}JPFAlwaysMoveDiagonally.prototype=new JumpPointFinderBase,JPFAlwaysMoveDiagonally.prototype.constructor=JPFAlwaysMoveDiagonally,JPFAlwaysMoveDiagonally.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(grid.isWalkableAt(x-dx,y+dy)&&!grid.isWalkableAt(x-dx,y)||grid.isWalkableAt(x+dx,y-dy)&&!grid.isWalkableAt(x,y-dy))return[x,y];if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x+dx,y+1)&&!grid.isWalkableAt(x,y+1)||grid.isWalkableAt(x+dx,y-1)&&!grid.isWalkableAt(x,y-1))return[x,y]}else if(grid.isWalkableAt(x+1,y+dy)&&!grid.isWalkableAt(x+1,y)||grid.isWalkableAt(x-1,y+dy)&&!grid.isWalkableAt(x-1,y))return[x,y];return this._jump(x+dx,y+dy,x,y)},JPFAlwaysMoveDiagonally.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x+dx,y+dy)&&neighbors.push([x+dx,y+dy]),grid.isWalkableAt(x-dx,y)||neighbors.push([x-dx,y+dy]),grid.isWalkableAt(x,y-dy)||neighbors.push([x+dx,y-dy])):0===dx?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+1,y)||neighbors.push([x+1,y+dy]),grid.isWalkableAt(x-1,y)||neighbors.push([x-1,y+dy])):(grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+1)||neighbors.push([x+dx,y+1]),grid.isWalkableAt(x,y-1)||neighbors.push([x+dx,y-1]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.Always)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFAlwaysMoveDiagonally},function(module,exports,__webpack_require__){var JumpPointFinderBase=__webpack_require__(23),DiagonalMovement=__webpack_require__(0);function JPFMoveDiagonallyIfNoObstacles(opt){JumpPointFinderBase.call(this,opt)}JPFMoveDiagonallyIfNoObstacles.prototype=new JumpPointFinderBase,JPFMoveDiagonallyIfNoObstacles.prototype.constructor=JPFMoveDiagonallyIfNoObstacles,JPFMoveDiagonallyIfNoObstacles.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x,y-1)&&!grid.isWalkableAt(x-dx,y-1)||grid.isWalkableAt(x,y+1)&&!grid.isWalkableAt(x-dx,y+1))return[x,y]}else if(0!==dy&&(grid.isWalkableAt(x-1,y)&&!grid.isWalkableAt(x-1,y-dy)||grid.isWalkableAt(x+1,y)&&!grid.isWalkableAt(x+1,y-dy)))return[x,y];return grid.isWalkableAt(x+dx,y)&&grid.isWalkableAt(x,y+dy)?this._jump(x+dx,y+dy,x,y):null},JPFMoveDiagonallyIfNoObstacles.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,isNextWalkable,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent){if(px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy)grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+dy)&&grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y+dy]);else if(0!==dx){isNextWalkable=grid.isWalkableAt(x+dx,y);var isTopWalkable=grid.isWalkableAt(x,y+1),isBottomWalkable=grid.isWalkableAt(x,y-1);isNextWalkable&&(neighbors.push([x+dx,y]),isTopWalkable&&neighbors.push([x+dx,y+1]),isBottomWalkable&&neighbors.push([x+dx,y-1])),isTopWalkable&&neighbors.push([x,y+1]),isBottomWalkable&&neighbors.push([x,y-1])}else if(0!==dy){isNextWalkable=grid.isWalkableAt(x,y+dy);var isRightWalkable=grid.isWalkableAt(x+1,y),isLeftWalkable=grid.isWalkableAt(x-1,y);isNextWalkable&&(neighbors.push([x,y+dy]),isRightWalkable&&neighbors.push([x+1,y+dy]),isLeftWalkable&&neighbors.push([x-1,y+dy])),isRightWalkable&&neighbors.push([x+1,y]),isLeftWalkable&&neighbors.push([x-1,y])}}else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.OnlyWhenNoObstacles)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFMoveDiagonallyIfNoObstacles},function(module,exports,__webpack_require__){var JumpPointFinderBase=__webpack_require__(23),DiagonalMovement=__webpack_require__(0);function JPFMoveDiagonallyIfAtMostOneObstacle(opt){JumpPointFinderBase.call(this,opt)}JPFMoveDiagonallyIfAtMostOneObstacle.prototype=new JumpPointFinderBase,JPFMoveDiagonallyIfAtMostOneObstacle.prototype.constructor=JPFMoveDiagonallyIfAtMostOneObstacle,JPFMoveDiagonallyIfAtMostOneObstacle.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(grid.isWalkableAt(x-dx,y+dy)&&!grid.isWalkableAt(x-dx,y)||grid.isWalkableAt(x+dx,y-dy)&&!grid.isWalkableAt(x,y-dy))return[x,y];if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x+dx,y+1)&&!grid.isWalkableAt(x,y+1)||grid.isWalkableAt(x+dx,y-1)&&!grid.isWalkableAt(x,y-1))return[x,y]}else if(grid.isWalkableAt(x+1,y+dy)&&!grid.isWalkableAt(x+1,y)||grid.isWalkableAt(x-1,y+dy)&&!grid.isWalkableAt(x-1,y))return[x,y];return grid.isWalkableAt(x+dx,y)||grid.isWalkableAt(x,y+dy)?this._jump(x+dx,y+dy,x,y):null},JPFMoveDiagonallyIfAtMostOneObstacle.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),(grid.isWalkableAt(x,y+dy)||grid.isWalkableAt(x+dx,y))&&neighbors.push([x+dx,y+dy]),!grid.isWalkableAt(x-dx,y)&&grid.isWalkableAt(x,y+dy)&&neighbors.push([x-dx,y+dy]),!grid.isWalkableAt(x,y-dy)&&grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y-dy])):0===dx?grid.isWalkableAt(x,y+dy)&&(neighbors.push([x,y+dy]),grid.isWalkableAt(x+1,y)||neighbors.push([x+1,y+dy]),grid.isWalkableAt(x-1,y)||neighbors.push([x-1,y+dy])):grid.isWalkableAt(x+dx,y)&&(neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+1)||neighbors.push([x+dx,y+1]),grid.isWalkableAt(x,y-1)||neighbors.push([x+dx,y-1]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.IfAtMostOneObstacle)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFMoveDiagonallyIfAtMostOneObstacle},function(module,exports,__webpack_require__){var isObject=__webpack_require__(3),now=__webpack_require__(170),toNumber=__webpack_require__(49),nativeMax=Math.max,nativeMin=Math.min;module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return leadingEdge(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}},function(module,exports,__webpack_require__){var root=__webpack_require__(2);module.exports=function(){return root.Date.now()}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"messageLog",(function(){return messageLog})),__webpack_require__.d(__webpack_exports__,"addLog",(function(){return addLog})),__webpack_require__.d(__webpack_exports__,"goToDungeonLevel",(function(){return src_goToDungeonLevel})),__webpack_require__.d(__webpack_exports__,"gameState",(function(){return gameState})),__webpack_require__.d(__webpack_exports__,"targetRange",(function(){return targetRange})),__webpack_require__.d(__webpack_exports__,"selectedInventoryIndex",(function(){return selectedInventoryIndex}));var lodash_get=__webpack_require__(24),get_default=__webpack_require__.n(lodash_get),sample=__webpack_require__(7),sample_default=__webpack_require__.n(sample),favicon=__webpack_require__.p+"7ccdb4fcc64ae7ca215ce76c927ec773.png";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CARDINAL=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}],DIAGONAL=[{x:1,y:-1},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1}],toCell=([].concat(CARDINAL,DIAGONAL),function(cellOrId){var cell=cellOrId;return"string"==typeof cell&&(cell=idToCell(cell)),cell}),toLocId=function(cellOrId){var locId=cellOrId;return"string"!=typeof locId&&(locId=cellToId(locId)),locId},insideCircle=function(center,tile,radius){var dx=center.x-tile.x,dy=center.y-tile.y;return dx*dx+dy*dy<=radius*radius},circle=function(center,radius){for(var top=center.y-radius,bottom=center.y+radius,left=center.x-radius,right=center.x+radius,locsIds=[],y=top;y<=bottom;y++)for(var x=left;x<=right;x++){var cx=Math.ceil(x),cy=Math.ceil(y);insideCircle(center,{x:cx,y:cy},radius)&&locsIds.push("".concat(cx,",").concat(cy))}return locsIds},rectangle=function(_ref,tileProps){var x=_ref.x,y=_ref.y,z=_ref.z,width=_ref.width,height=_ref.height,hasWalls=_ref.hasWalls,tiles={},x1=x,x2=x+width-1,y1=y,y2=y+height-1;if(hasWalls)for(var yi=y1+1;yi<=y2-1;yi++)for(var xi=x1+1;xi<=x2-1;xi++)tiles["".concat(xi,",").concat(yi,",").concat(z)]=_objectSpread({x:xi,y:yi,z:z},tileProps);else for(var _yi=y1;_yi<=y2;_yi++)for(var _xi=x1;_xi<=x2;_xi++)tiles["".concat(_xi,",").concat(_yi,",").concat(z)]=_objectSpread({x:_xi,y:_yi,z:z},tileProps);return{x1:x1,x2:x2,y1:y1,y2:y2,center:{x:Math.round((x1+x2)/2),y:Math.round((y1+y2)/2),z:z},hasWalls:hasWalls,tiles:tiles}},idToCell=function(id){var coords=id.split(",");return{x:parseInt(coords[0],10),y:parseInt(coords[1],10),z:parseInt(coords[2],10)}},cellToId=function(_ref2){var x=_ref2.x,y=_ref2.y,z=_ref2.z;return"".concat(x,",").concat(y,",").concat(z)};function canvas_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function canvas_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function canvas_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return canvas_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return canvas_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return canvas_arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function canvas_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var pixelRatio=window.devicePixelRatio||1,canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),canvas_grid={width:100,height:35,map:{width:79,height:29,x:21,y:3},messageLog:{width:79,height:3,x:21,y:0},playerHud:{width:20,height:6,x:0,y:0},playerEquipment:{width:20,height:13,x:0,y:7,head:{x:5,y:7},weapon:{x:1,y:11},chest:{x:5,y:11},shield:{x:9,y:11},legs:{x:5,y:15}},equipmentInfo:{width:20,height:7,x:0,y:20},infoBar:{width:79,height:3,x:21,y:32},inventory:{width:37,height:28,x:21,y:4},menu:{width:100,height:1,x:0,y:33}},calculatedFontSize=window.innerWidth/canvas_grid.width,cellWidth=calculatedFontSize*pixelRatio,cellHeight=1.2*calculatedFontSize*pixelRatio,fontSize=calculatedFontSize*pixelRatio;canvas.style.cssText="width: ".concat(calculatedFontSize*canvas_grid.width,"; height: ").concat(1.2*calculatedFontSize*canvas_grid.height),canvas.width=cellWidth*canvas_grid.width,canvas.height=cellHeight*canvas_grid.height,ctx.font="normal ".concat(fontSize,"px 'Fira Code'"),ctx.textAlign="center",ctx.textBaseline="middle";var clearCanvas=function(x,y,w,h){var posX=x*cellWidth,posY=y*cellHeight,width=cellWidth*w,height=cellHeight*h;ctx.clearRect(posX,posY,width,height)},drawBackground=function(_ref){var color=_ref.color,position=_ref.position;"transparent"!==color&&(ctx.fillStyle=color,ctx.fillRect(position.x*cellWidth,position.y*cellHeight,cellWidth,cellHeight))},drawChar=function(_ref2){var _char=_ref2.char,color=_ref2.color,position=_ref2.position;ctx.fillStyle=color,ctx.fillText(_char,position.x*cellWidth+cellWidth/2,position.y*cellHeight+cellHeight/2)},drawCell=function(entity){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_char2=options.char||entity.appearance.char,background=options.background||entity.appearance.background,color=options.color||entity.appearance.color,position=entity.position;drawBackground({color:background,position:position}),drawChar({char:_char2,color:color,position:position})},drawText=function(template){canvas_toConsumableArray(template.text).forEach((function(_char3,index){var options=function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?canvas_ownKeys(Object(source),!0).forEach((function(key){canvas_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):canvas_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},template),character={appearance:{char:_char3,background:options.background,color:options.color},position:{x:index+options.x,y:options.y}};delete options.x,delete options.y,drawCell(character,options)}))},pxToCell=function(ev){var bounds=canvas.getBoundingClientRect(),relativeX=ev.clientX-bounds.left,relativeY=ev.clientY-bounds.top;return[Math.trunc(relativeX/cellWidth*pixelRatio),Math.trunc(relativeY/cellHeight*pixelRatio)]},random=__webpack_require__(12),random_default=__webpack_require__.n(random),times=__webpack_require__(4),times_default=__webpack_require__.n(times),lodash_set=__webpack_require__(57),set_default=__webpack_require__.n(lodash_set);function cache_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return cache_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return cache_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cache_arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cache_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var cache={entitiesAtLocation:{},z:-1,floors:{}},cache_addCache=function(path,value){set_default()(cache,path,value)},cache_readCache=function(path){return get_default()(cache,path)},readCacheSet=function(name,key,value){return cache[name][key]&&value?cache[name][key].get(value):cache[name][key]},clearCache=function(){cache.entitiesAtLocation={},cache.z=1,cache.floors={}};function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||build_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function build_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=build_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function build_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return build_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?build_arrayLikeToArray(o,minLen):void 0}}function build_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function build_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function build_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?build_ownKeys(Object(source),!0).forEach((function(key){_defineProperty2(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):build_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty2(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function build_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var camelCase=function(input,options){if("string"!=typeof input&&!Array.isArray(input))throw new TypeError("Expected the input to be `string | string[]`");options=build_objectSpread(build_objectSpread({},{pascalCase:!1}),options);var x;return 0===(input=Array.isArray(input)?input.map((function(x){return x.trim()})).filter((function(x){return x.length})).join("-"):input.trim()).length?"":1===input.length?options.pascalCase?input.toLocaleUpperCase():input.toLocaleLowerCase():(input!==input.toLocaleLowerCase()&&(input=function(string){for(var isLastCharLower=!1,isLastCharUpper=!1,isLastLastCharUpper=!1,i=0;i<string.length;i++){var character=string[i];isLastCharLower&&/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C2\uA7C4-\uA7C7\uA7C9\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])/.test(character)?(string=string.slice(0,i)+"-"+string.slice(i),isLastCharLower=!1,isLastLastCharUpper=isLastCharUpper,isLastCharUpper=!0,i++):isLastCharUpper&&isLastLastCharUpper&&/(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C3\uA7C8\uA7CA\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD83A[\uDD22-\uDD43])/.test(character)?(string=string.slice(0,i-1)+"-"+string.slice(i-1),isLastLastCharUpper=isLastCharUpper,isLastCharUpper=!1,isLastCharLower=!0):(isLastCharLower=character.toLocaleLowerCase()===character&&character.toLocaleUpperCase()!==character,isLastLastCharUpper=isLastCharUpper,isLastCharUpper=character.toLocaleUpperCase()===character&&character.toLocaleLowerCase()!==character)}return string}(input)),input=input.replace(/^[_.\- ]+/,"").toLocaleLowerCase().replace(/[ \x2D\._]+((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F81\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1713\u1720-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4B\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DE7-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC82-\uDCB8\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])|$)/g,(function(_,p1){return p1.toLocaleUpperCase()})).replace(/[0-9]+((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F81\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1713\u1720-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4B\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DE7-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC82-\uDCB8\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])|$)/g,(function(m){return m.toLocaleUpperCase()})),x=input,options.pascalCase?x.charAt(0).toLocaleUpperCase()+x.slice(1):x)},camelcase=camelCase,_default=camelCase;camelcase.default=_default;var camelCache={},camelString=function(value){var result=camelCache[value];return result||(camelCache[value]=camelcase(value),camelCache[value])},ComponentRegistry=function(){function ComponentRegistry(){_classCallCheck(this,ComponentRegistry),build_defineProperty(this,"_cbit",0),build_defineProperty(this,"_map",{})}return _createClass(ComponentRegistry,[{key:"register",value:function(clazz){var key=camelString(clazz.name);clazz.prototype._ckey=key,clazz.prototype._cbit=BigInt(++this._cbit),this._map[key]=clazz}},{key:"get",value:function(key){return this._map[key]}}]),ComponentRegistry}(),isMergeableObject=function(value){return function(value){return!!value&&"object"===_typeof(value)}(value)&&!function(value){var stringValue=Object.prototype.toString.call(value);return"[object RegExp]"===stringValue||"[object Date]"===stringValue||function(value){return value.$$typeof===REACT_ELEMENT_TYPE}(value)}(value)};var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(value,options){return!1!==options.clone&&options.isMergeableObject(value)?deepmerge((val=value,Array.isArray(val)?[]:{}),value,options):value;var val}function defaultArrayMerge(target,source,options){return target.concat(source).map((function(element){return cloneUnlessOtherwiseSpecified(element,options)}))}function getKeys(target){return Object.keys(target).concat(function(target){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(target).filter((function(symbol){return target.propertyIsEnumerable(symbol)})):[]}(target))}function propertyIsOnObject(object,property){try{return property in object}catch(_){return!1}}function mergeObject(target,source,options){var destination={};return options.isMergeableObject(target)&&getKeys(target).forEach((function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options)})),getKeys(source).forEach((function(key){(function(target,key){return propertyIsOnObject(target,key)&&!(Object.hasOwnProperty.call(target,key)&&Object.propertyIsEnumerable.call(target,key))})(target,key)||(propertyIsOnObject(target,key)&&options.isMergeableObject(source[key])?destination[key]=function(key,options){if(!options.customMerge)return deepmerge;var customMerge=options.customMerge(key);return"function"==typeof customMerge?customMerge:deepmerge}(key,options)(target[key],source[key],options):destination[key]=cloneUnlessOtherwiseSpecified(source[key],options))})),destination}function deepmerge(target,source,options){(options=options||{}).arrayMerge=options.arrayMerge||defaultArrayMerge,options.isMergeableObject=options.isMergeableObject||isMergeableObject,options.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var sourceIsArray=Array.isArray(source);return sourceIsArray===Array.isArray(target)?sourceIsArray?options.arrayMerge(target,source,options):mergeObject(target,source,options):cloneUnlessOtherwiseSpecified(source,options)}deepmerge.all=function(array,options){if(!Array.isArray(array))throw new Error("first argument should be an array");return array.reduce((function(prev,next){return deepmerge(prev,next,options)}),{})};var cjs=deepmerge,PrefabComponent=function(){function PrefabComponent(clazz){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},overwrite=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,PrefabComponent),this.clazz=clazz,this.properties=properties,this.overwrite=overwrite}return _createClass(PrefabComponent,[{key:"applyToEntity",value:function(entity){var initialProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.clazz.allowMultiple&&entity.has(this.clazz)){if(!this.overwrite)return;var comp=entity[this.clazz.prototype._ckey];entity.remove(comp)}var props=cjs(this.properties,initialProps);entity.add(this.clazz,props)}}]),PrefabComponent}(),Prefab=function(){function Prefab(name){_classCallCheck(this,Prefab),build_defineProperty(this,"name",""),build_defineProperty(this,"inherit",[]),build_defineProperty(this,"components",[]),this.name=name}return _createClass(Prefab,[{key:"addComponent",value:function(prefabComponent){this.components.push(prefabComponent)}},{key:"applyToEntity",value:function(entity){var prefabProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.inherit.forEach((function(parent){parent.applyToEntity(entity,prefabProps)}));var arrComps={};return this.components.forEach((function(component){var clazz=component.clazz,ckey=clazz.prototype._ckey,initialCompProps={};if(clazz.allowMultiple)if(clazz.keyProperty){var key=component.properties[clazz.keyProperty];prefabProps[ckey]&&prefabProps[ckey][key]&&(initialCompProps=prefabProps[ckey][key])}else arrComps[ckey]||(arrComps[ckey]=0),prefabProps[ckey]&&prefabProps[ckey][arrComps[ckey]]&&(initialCompProps=prefabProps[ckey][arrComps[ckey]]),arrComps[ckey]++;else initialCompProps=prefabProps[ckey];component.applyToEntity(entity,initialCompProps)})),entity}}]),Prefab}(),PrefabRegistry=function(){function PrefabRegistry(engine){_classCallCheck(this,PrefabRegistry),build_defineProperty(this,"_prefabs",{}),build_defineProperty(this,"_engine",null),this._engine=engine}return _createClass(PrefabRegistry,[{key:"deserialize",value:function(data){var _this=this,registered=this.get(data.name);if(registered)return registered;var inherit,prefab=new Prefab(data.name);return inherit=Array.isArray(data.inherit)?data.inherit:"string"==typeof data.inherit?[data.inherit]:[],prefab.inherit=inherit.map((function(parent){var ref=_this.get(parent);return ref||(console.warn('Prefab "'.concat(data.name,'" cannot inherit from Prefab "').concat(parent,'" because is not registered yet! Prefabs must be registered in the right order.')),parent)})),(data.components||[]).forEach((function(componentData){if("string"==typeof componentData){var ckey=camelString(componentData),clazz=_this._engine._components.get(ckey);if(clazz)return void prefab.addComponent(new PrefabComponent(clazz))}if("object"===_typeof(componentData)){var _ckey=camelString(componentData.type),_clazz=_this._engine._components.get(_ckey);if(_clazz)return void prefab.addComponent(new PrefabComponent(_clazz,componentData.properties,componentData.overwrite))}console.warn('Unrecognized component reference "'.concat(componentData,'" in prefab "').concat(data.name,'". Ensure the component is registered before the prefab.'))})),prefab}},{key:"register",value:function(data){var prefab=this.deserialize(data);this._prefabs[prefab.name]=prefab}},{key:"get",value:function(name){return this._prefabs[name]}},{key:"create",value:function(world,name){var properties=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},prefab=this.get(name);if(prefab){var entity=world.createEntity();return entity._qeligible=!1,prefab.applyToEntity(entity,properties),entity._qeligible=!0,entity._candidacy(),entity}console.warn('Could not instantiate prefab "'.concat(name,'" since it is not registered'))}}]),PrefabRegistry}(),Component=function(){function Component(){var properties=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Component),Object.assign(this,this.constructor.properties,properties)}return _createClass(Component,[{key:"world",get:function(){return this.entity.world}},{key:"allowMultiple",get:function(){return this.constructor.allowMultiple}},{key:"keyProperty",get:function(){return this.constructor.keyProperty}},{key:"destroy",value:function(){this.entity.remove(this)}},{key:"_onDestroyed",value:function(){this.onDestroyed(),delete this.entity}},{key:"_onEvent",value:function(evt){this.onEvent(evt),"function"==typeof this[evt.handlerName]&&this[evt.handlerName](evt)}},{key:"_onAttached",value:function(entity){this.entity=entity,this.onAttached(entity)}},{key:"serialize",value:function(){var ob={};for(var key in this.constructor.properties)ob[key]=this[key];return ob}},{key:"onAttached",value:function(entity){}},{key:"onDestroyed",value:function(){}},{key:"onEvent",value:function(evt){}}]),Component}();build_defineProperty(Component,"allowMultiple",!1),build_defineProperty(Component,"keyProperty",null),build_defineProperty(Component,"properties",{});var EntityEvent=function(){function EntityEvent(name){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,EntityEvent),build_defineProperty(this,"data",{}),build_defineProperty(this,"prevented",!1),build_defineProperty(this,"handled",!1),this.name=name,this.data=data,this.handlerName=camelString("on ".concat(this.name))}return _createClass(EntityEvent,[{key:"is",value:function(name){return this.name===name}},{key:"handle",value:function(){this.handled=!0,this.prevented=!0}},{key:"prevent",value:function(){this.prevented=!0}}]),EntityEvent}(),ONE=1n,subtractBit=function(num,bit){return num&~(1n<<bit)},addBit=function(num,bit){return num|ONE<<bit},bitIntersection=function(n1,n2){return n1&n2},serializeComponent=function(component){return component.serialize()},serializeComponentKeyed=function(ob){var ser={};for(var k in ob)ser[k]=serializeComponent(ob[k]);return ser},Entity=function(){function Entity(world,id){_classCallCheck(this,Entity),build_defineProperty(this,"_cbits",0n),build_defineProperty(this,"_qeligible",!0),this.world=world,this.id=id,this.components={},this.isDestroyed=!1}return _createClass(Entity,[{key:"_candidacy",value:function(){this._qeligible&&this.world._candidate(this)}},{key:"add",value:function(clazz,properties){var component=new clazz(properties);component.keyProperty?function(entity,component){var key=component._ckey;entity.components[key]||(entity[key]={},entity.components[key]={}),entity[key][component[component.keyProperty]]=component,entity.components[key][component[component.keyProperty]]=component}(this,component):component.allowMultiple?function(entity,component){var key=component._ckey;entity.components[key]||(entity[key]=[],entity.components[key]=[]),entity[key].push(component),entity.components[key].push(component)}(this,component):function(entity,component){var key=component._ckey;entity[key]=component,entity.components[key]=component}(this,component),this._cbits=addBit(this._cbits,component._cbit),component._onAttached(this),this._candidacy()}},{key:"has",value:function(clazz){return num=this._cbits,bit=clazz.prototype._cbit,(num>>bit)%2n!==0n;var num,bit}},{key:"remove",value:function(component){component.keyProperty?function(entity,component){var key=component._ckey,keyProp=component[component.keyProperty];delete entity[key][keyProp],delete entity.components[key][keyProp],Object.keys(entity[key]).length<=0&&(delete entity[key],delete entity.components[key],entity._cbits=subtractBit(entity._cbits,component._cbit),entity._candidacy())}(this,component):component.allowMultiple?function(entity,component){var key=component._ckey,idx=entity[key].indexOf(component);entity[key].splice(idx,1),entity.components[key].splice(idx,1),entity[key].length<=0&&(delete entity[key],delete entity.components[key],entity._cbits=subtractBit(entity._cbits,component._cbit),entity._candidacy())}(this,component):function(entity,component){var key=component._ckey;delete entity[key],delete entity.components[key],entity._cbits=subtractBit(entity._cbits,component._cbit),entity._candidacy()}(this,component),component._onDestroyed()}},{key:"destroy",value:function(){for(var k in this.components){var v=this.components[k];if(v instanceof Component)this._cbits=subtractBit(this._cbits,v._cbit),v._onDestroyed();else if(v instanceof Array){var _step,_iterator=build_createForOfIteratorHelper(v);try{for(_iterator.s();!(_step=_iterator.n()).done;){var component=_step.value;this._cbits=subtractBit(this._cbits,component._cbit),component._onDestroyed()}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else for(var _i=0,_Object$values=Object.values(v);_i<_Object$values.length;_i++){var _component=_Object$values[_i];this._cbits=subtractBit(this._cbits,_component._cbit),_component._onDestroyed()}delete this[k],delete this.components[k]}this._candidacy(),this.world._destroyed(this.id),this.components={},this.isDestroyed=!0}},{key:"serialize",value:function(){var components={};for(var k in this.components){var v=this.components[k];components[k]=v instanceof Component?serializeComponent(v):v instanceof Array?v.map(serializeComponent):serializeComponentKeyed(v)}return build_objectSpread({id:this.id},components)}},{key:"fireEvent",value:function(name,data){var evt=new EntityEvent(name,data);for(var key in this.components){var v=this.components[key];if(v instanceof Component){if(v._onEvent(evt),evt.prevented)return evt}else if(v instanceof Array){for(var i=0;i<v.length;i++)if(v[i]._onEvent(evt),evt.prevented)return evt}else for(var _i2=0,_Object$values2=Object.values(v);_i2<_Object$values2.length;_i2++){if(_Object$values2[_i2]._onEvent(evt),evt.prevented)return evt}}return evt}}]),Entity}(),Query=function(){function Query(world,filters){_classCallCheck(this,Query),build_defineProperty(this,"_cache",[]),build_defineProperty(this,"_onAddListeners",[]),build_defineProperty(this,"_onRemoveListeners",[]),this._world=world;var any=filters.any||[],all=filters.all||[],none=filters.none||[];this._any=any.reduce((function(s,c){return addBit(s,c.prototype._cbit)}),0n),this._all=all.reduce((function(s,c){return addBit(s,c.prototype._cbit)}),0n),this._none=none.reduce((function(s,c){return addBit(s,c.prototype._cbit)}),0n),this.refresh()}return _createClass(Query,[{key:"onEntityAdded",value:function(fn){this._onAddListeners.push(fn)}},{key:"onEntityRemoved",value:function(fn){this._onRemoveListeners.push(fn)}},{key:"has",value:function(entity){return this.idx(entity)>=0}},{key:"idx",value:function(entity){return this._cache.indexOf(entity)}},{key:"matches",value:function(entity){var bits=entity._cbits,any=0n===this._any||bitIntersection(bits,this._any)>0,all=bitIntersection(bits,this._all)===this._all,none=0n===bitIntersection(bits,this._none);return any&&all&&none}},{key:"candidate",value:function(entity){var idx=this.idx(entity),isTracking=idx>=0;return!entity.isDestroyed&&this.matches(entity)?(isTracking||(this._cache.push(entity),this._onAddListeners.forEach((function(cb){return cb(entity)}))),!0):(isTracking&&(this._cache.splice(idx,1),this._onRemoveListeners.forEach((function(cb){return cb(entity)}))),!1)}},{key:"refresh",value:function(){var _this2=this;this._cache=[],this._world._entities.forEach((function(entity){_this2.candidate(entity)}))}},{key:"get",value:function(){return this._cache}}]),Query}(),World=function(){function World(engine){_classCallCheck(this,World),build_defineProperty(this,"_id",0),build_defineProperty(this,"_queries",[]),build_defineProperty(this,"_entities",new Map),this.engine=engine}return _createClass(World,[{key:"createId",value:function(){return++this._id+Math.random().toString(36).substr(2,9)}},{key:"getEntity",value:function(id){return this._entities.get(id)}},{key:"getEntities",value:function(){return this._entities.values()}},{key:"createEntity",value:function(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.createId(),entity=new Entity(this,id);return this._entities.set(id,entity),entity}},{key:"destroyEntity",value:function(id){var entity=this.getEntity(id);entity&&entity.destroy()}},{key:"destroyEntities",value:function(){this._entities.forEach((function(entity){entity.destroy()}))}},{key:"destroy",value:function(){this.destroyEntities(),this._id=0,this._queries=[],this._entities=new Map}},{key:"createQuery",value:function(filters){var query=new Query(this,filters);return this._queries.push(query),query}},{key:"createPrefab",value:function(name){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.engine._prefabs.create(this,name,properties)}},{key:"serialize",value:function(entities){var json=[];return(entities||this._entities).forEach((function(e){json.push(e.serialize())})),{entities:json}}},{key:"deserialize",value:function(data){var _step2,_iterator2=build_createForOfIteratorHelper(data.entities);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var entityData=_step2.value;this._createOrGetEntityById(entityData.id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _step3,_iterator3=build_createForOfIteratorHelper(data.entities);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _entityData=_step3.value;this._deserializeEntity(_entityData)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},{key:"_createOrGetEntityById",value:function(id){return this.getEntity(id)||this.createEntity(id)}},{key:"_deserializeEntity",value:function(data){var _this3=this,id=data.id,components=_objectWithoutProperties(data,["id"]),entity=this._createOrGetEntityById(id);entity._qeligible=!1,Object.entries(components).forEach((function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1],type=camelString(key),def=_this3.engine._components.get(type);def.allowMultiple?Object.values(value).forEach((function(d){entity.add(def,d)})):entity.add(def,value)})),entity._qeligible=!0,entity._candidacy()}},{key:"_candidate",value:function(entity){this._queries.forEach((function(q){return q.candidate(entity)}))}},{key:"_destroyed",value:function(id){return this._entities.delete(id)}}]),World}(),Engine=function(){function Engine(){_classCallCheck(this,Engine),build_defineProperty(this,"_components",new ComponentRegistry),build_defineProperty(this,"_prefabs",new PrefabRegistry(this))}return _createClass(Engine,[{key:"registerComponent",value:function(clazz){this._components.register(clazz)}},{key:"registerPrefab",value:function(data){this._prefabs.register(data)}},{key:"createWorld",value:function(){return new World(this)}},{key:"destroyWorld",value:function(world){world.destroy()}}]),Engine}();function Ai_typeof(obj){return(Ai_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Ai_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==Ai_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Ai=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Ai,_Component);var _super=_createSuper(Ai);function Ai(){return Ai_classCallCheck(this,Ai),_super.apply(this,arguments)}return Ai}(Component);function Animation_typeof(obj){return(Animation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Animation_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Animation_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Animation_setPrototypeOf(o,p){return(Animation_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Animation_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Animation_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Animation_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Animation_possibleConstructorReturn(this,result)}}function Animation_possibleConstructorReturn(self,call){return!call||"object"!==Animation_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Animation_getPrototypeOf(o){return(Animation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Animation_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Animate=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Animation_setPrototypeOf(subClass,superClass)}(Animate,_Component);var Constructor,protoProps,staticProps,_super=Animation_createSuper(Animate);function Animate(){return Animation_classCallCheck(this,Animate),_super.apply(this,arguments)}return Constructor=Animate,(protoProps=[{key:"onSetStartTime",value:function(evt){this.startTime=evt.data.time}}])&&Animation_defineProperties(Constructor.prototype,protoProps),staticProps&&Animation_defineProperties(Constructor,staticProps),Animate}(Component);function Layers_typeof(obj){return(Layers_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Layers_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Layers_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Layers_setPrototypeOf(subClass,superClass)}function Layers_setPrototypeOf(o,p){return(Layers_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Layers_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Layers_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Layers_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Layers_possibleConstructorReturn(this,result)}}function Layers_possibleConstructorReturn(self,call){return!call||"object"!==Layers_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Layers_getPrototypeOf(o){return(Layers_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}Animation_defineProperty(Animate,"allowMultiple",!0),Animation_defineProperty(Animate,"properties",{startTime:null,duration:250,char:"",color:""});var Layer100=function(_Component){Layers_inherits(Layer100,_Component);var _super=Layers_createSuper(Layer100);function Layer100(){return Layers_classCallCheck(this,Layer100),_super.apply(this,arguments)}return Layer100}(Component),Layer300=function(_Component2){Layers_inherits(Layer300,_Component2);var _super2=Layers_createSuper(Layer300);function Layer300(){return Layers_classCallCheck(this,Layer300),_super2.apply(this,arguments)}return Layer300}(Component),Layer400=function(_Component3){Layers_inherits(Layer400,_Component3);var _super3=Layers_createSuper(Layer400);function Layer400(){return Layers_classCallCheck(this,Layer400),_super3.apply(this,arguments)}return Layer400}(Component);function Status_typeof(obj){return(Status_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Status_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Status_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Status_setPrototypeOf(subClass,superClass)}function Status_setPrototypeOf(o,p){return(Status_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Status_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Status_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Status_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Status_possibleConstructorReturn(this,result)}}function Status_possibleConstructorReturn(self,call){return!call||"object"!==Status_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Status_getPrototypeOf(o){return(Status_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Dropped=function(_Component){Status_inherits(Dropped,_Component);var _super=Status_createSuper(Dropped);function Dropped(){return Status_classCallCheck(this,Dropped),_super.apply(this,arguments)}return Dropped}(Component),IsBlocking=function(_Component2){Status_inherits(IsBlocking,_Component2);var _super2=Status_createSuper(IsBlocking);function IsBlocking(){return Status_classCallCheck(this,IsBlocking),_super2.apply(this,arguments)}return IsBlocking}(Component),IsDead=function(_Component3){Status_inherits(IsDead,_Component3);var _super3=Status_createSuper(IsDead);function IsDead(){return Status_classCallCheck(this,IsDead),_super3.apply(this,arguments)}return IsDead}(Component),IsEquippable=function(_Component4){Status_inherits(IsEquippable,_Component4);var _super4=Status_createSuper(IsEquippable);function IsEquippable(){return Status_classCallCheck(this,IsEquippable),_super4.apply(this,arguments)}return IsEquippable}(Component),IsEquipped=function(_Component5){Status_inherits(IsEquipped,_Component5);var _super5=Status_createSuper(IsEquipped);function IsEquipped(){return Status_classCallCheck(this,IsEquipped),_super5.apply(this,arguments)}return IsEquipped}(Component),IsInFov=function(_Component6){Status_inherits(IsInFov,_Component6);var _super6=Status_createSuper(IsInFov);function IsInFov(){return Status_classCallCheck(this,IsInFov),_super6.apply(this,arguments)}return IsInFov}(Component),IsOpaque=function(_Component7){Status_inherits(IsOpaque,_Component7);var _super7=Status_createSuper(IsOpaque);function IsOpaque(){return Status_classCallCheck(this,IsOpaque),_super7.apply(this,arguments)}return IsOpaque}(Component),IsPickup=function(_Component8){Status_inherits(IsPickup,_Component8);var _super8=Status_createSuper(IsPickup);function IsPickup(){return Status_classCallCheck(this,IsPickup),_super8.apply(this,arguments)}return IsPickup}(Component),IsRevealed=function(_Component9){Status_inherits(IsRevealed,_Component9);var _super9=Status_createSuper(IsRevealed);function IsRevealed(){return Status_classCallCheck(this,IsRevealed),_super9.apply(this,arguments)}return IsRevealed}(Component),IsStairs=function(_Component10){Status_inherits(IsStairs,_Component10);var _super10=Status_createSuper(IsStairs);function IsStairs(){return Status_classCallCheck(this,IsStairs),_super10.apply(this,arguments)}return IsStairs}(Component);function Attributes_typeof(obj){return(Attributes_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Attributes_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Attributes_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Attributes_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Attributes_setPrototypeOf(subClass,superClass)}function Attributes_setPrototypeOf(o,p){return(Attributes_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Attributes_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Attributes_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Attributes_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Attributes_possibleConstructorReturn(this,result)}}function Attributes_possibleConstructorReturn(self,call){return!call||"object"!==Attributes_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Attributes_getPrototypeOf(o){return(Attributes_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Attributes_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Defense=function(_Component){Attributes_inherits(Defense,_Component);var _super=Attributes_createSuper(Defense);function Defense(){return Attributes_classCallCheck(this,Defense),_super.apply(this,arguments)}return Defense}(Component);Attributes_defineProperty(Defense,"properties",{base:1,current:1});var Attributes_Health=function(_Component2){Attributes_inherits(Health,_Component2);var Constructor,protoProps,staticProps,_super2=Attributes_createSuper(Health);function Health(){return Attributes_classCallCheck(this,Health),_super2.apply(this,arguments)}return Constructor=Health,(protoProps=[{key:"onTakeDamage",value:function(evt){this.current-=evt.data.amount,this.current<=0&&(this.entity.has(Ai)&&this.entity.remove(this.entity.ai),this.entity.has(IsBlocking)&&this.entity.remove(this.entity.isBlocking),this.entity.has(Layer400)&&this.entity.remove(this.entity.layer400),this.entity.add(IsDead),this.entity.add(Layer300),this.entity.appearance.char="%"),evt.handle()}}])&&Attributes_defineProperties(Constructor.prototype,protoProps),staticProps&&Attributes_defineProperties(Constructor,staticProps),Health}(Component);Attributes_defineProperty(Attributes_Health,"properties",{base:10,current:10});var Power=function(_Component3){Attributes_inherits(Power,_Component3);var _super3=Attributes_createSuper(Power);function Power(){return Attributes_classCallCheck(this,Power),_super3.apply(this,arguments)}return Power}(Component);function Effects_typeof(obj){return(Effects_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Effects_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Effects_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Effects_setPrototypeOf(subClass,superClass)}function Effects_setPrototypeOf(o,p){return(Effects_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Effects_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Effects_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Effects_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Effects_possibleConstructorReturn(this,result)}}function Effects_possibleConstructorReturn(self,call){return!call||"object"!==Effects_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Effects_getPrototypeOf(o){return(Effects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Effects_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Attributes_defineProperty(Power,"properties",{base:5,current:5});var effectProps={component:"",delta:"",animate:{char:"",color:""},events:[],addComponents:[],duration:0},ActiveEffects=function(_Component){Effects_inherits(ActiveEffects,_Component);var _super=Effects_createSuper(ActiveEffects);function ActiveEffects(){return Effects_classCallCheck(this,ActiveEffects),_super.apply(this,arguments)}return ActiveEffects}(Component);Effects_defineProperty(ActiveEffects,"allowMultiple",!0),Effects_defineProperty(ActiveEffects,"properties",effectProps);var Effects=function(_Component2){Effects_inherits(Effects,_Component2);var _super2=Effects_createSuper(Effects);function Effects(){return Effects_classCallCheck(this,Effects),_super2.apply(this,arguments)}return Effects}(Component);function Equipment_typeof(obj){return(Equipment_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Equipment_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Equipment_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Equipment_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Equipment_setPrototypeOf(subClass,superClass)}function Equipment_setPrototypeOf(o,p){return(Equipment_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Equipment_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Equipment_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Equipment_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Equipment_possibleConstructorReturn(this,result)}}function Equipment_possibleConstructorReturn(self,call){return!call||"object"!==Equipment_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Equipment_getPrototypeOf(o){return(Equipment_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Equipment_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Effects_defineProperty(Effects,"allowMultiple",!0),Effects_defineProperty(Effects,"properties",effectProps);var Slot=function(_Component){Equipment_inherits(Slot,_Component);var _super=Equipment_createSuper(Slot);function Slot(){return Equipment_classCallCheck(this,Slot),_super.apply(this,arguments)}return Slot}(Component);Equipment_defineProperty(Slot,"properties",{name:""});var EquipmentEffect=function(_Component2){Equipment_inherits(EquipmentEffect,_Component2);var _super2=Equipment_createSuper(EquipmentEffect);function EquipmentEffect(){return Equipment_classCallCheck(this,EquipmentEffect),_super2.apply(this,arguments)}return EquipmentEffect}(Component);Equipment_defineProperty(EquipmentEffect,"allowMultiple",!0),Equipment_defineProperty(EquipmentEffect,"properties",{component:"",delta:""});var EquipmentSlot=function(_Component3){Equipment_inherits(EquipmentSlot,_Component3);var Constructor,protoProps,staticProps,_super3=Equipment_createSuper(EquipmentSlot);function EquipmentSlot(){return Equipment_classCallCheck(this,EquipmentSlot),_super3.apply(this,arguments)}return Constructor=EquipmentSlot,(protoProps=[{key:"item",get:function(){return this.world.getEntity(this.itemId)},set:function(entity){return this.itemId=entity.id}},{key:"onEquip",value:function(evt){var _this=this;evt.data.equipmentEffect&&(evt.data.equipmentEffect.forEach((function(effect){"health"===effect.component&&(_this.entity[effect.component].base+=effect.delta),_this.entity[effect.component].current+=effect.delta})),evt.handle())}},{key:"onUnequip",value:function(evt){var _this2=this;evt.data.equipmentEffect&&(evt.data.equipmentEffect.forEach((function(effect){"health"===effect.component&&(_this2.entity[effect.component].base-=effect.delta),_this2.entity[effect.component].current-=effect.delta})),evt.handle())}}])&&Equipment_defineProperties(Constructor.prototype,protoProps),staticProps&&Equipment_defineProperties(Constructor,staticProps),EquipmentSlot}(Component);function ecs_refs_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return ecs_refs_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ecs_refs_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ecs_refs_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}Equipment_defineProperty(EquipmentSlot,"allowMultiple",!0),Equipment_defineProperty(EquipmentSlot,"keyProperty","name"),Equipment_defineProperty(EquipmentSlot,"properties",{name:"",itemId:EquipmentSlot.itemId});function Position_typeof(obj){return(Position_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Position_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Position_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Position_setPrototypeOf(o,p){return(Position_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Position_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Position_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Position_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Position_possibleConstructorReturn(this,result)}}function Position_possibleConstructorReturn(self,call){return!call||"object"!==Position_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Position_getPrototypeOf(o){return(Position_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Position_Position=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Position_setPrototypeOf(subClass,superClass)}(Position,_Component);var Constructor,protoProps,staticProps,_super=Position_createSuper(Position);function Position(){return Position_classCallCheck(this,Position),_super.apply(this,arguments)}return Constructor=Position,(protoProps=[{key:"onAttached",value:function(){var name,key,value,locId="".concat(this.entity.position.x,",").concat(this.entity.position.y,",").concat(this.entity.position.z);name="entitiesAtLocation",key=locId,value=this.entity.id,cache[name][key]||(cache[name][key]=new Set),cache[name][key].add(value)}},{key:"onDestroyed",value:function(){var name,key,value,locId="".concat(this.x,",").concat(this.y,",").concat(this.z);name="entitiesAtLocation",key=locId,value=this.entity.id,cache[name][key]&&cache[name][key].has(value)&&cache[name][key].delete(value)}}])&&Position_defineProperties(Constructor.prototype,protoProps),staticProps&&Position_defineProperties(Constructor,staticProps),Position}(Component);function Inventory_typeof(obj){return(Inventory_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Inventory_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Inventory_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Inventory_setPrototypeOf(o,p){return(Inventory_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Inventory_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Inventory_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Inventory_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Inventory_possibleConstructorReturn(this,result)}}function Inventory_possibleConstructorReturn(self,call){return!call||"object"!==Inventory_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Inventory_getPrototypeOf(o){return(Inventory_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}value={x:0,y:0,z:-1},(key="properties")in(obj=Position_Position)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value;var Inventory_Inventory=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Inventory_setPrototypeOf(subClass,superClass)}(Inventory,_Component);var Constructor,protoProps,staticProps,_super=Inventory_createSuper(Inventory);function Inventory(){return Inventory_classCallCheck(this,Inventory),_super.apply(this,arguments)}return Constructor=Inventory,(protoProps=[{key:"inventoryItems",get:function(){return function(entity,idArrayProp){var _step,newIds=[],entities=[],_iterator=ecs_refs_createForOfIteratorHelper(entity[idArrayProp]);try{for(_iterator.s();!(_step=_iterator.n()).done;){var id=_step.value,targetEntity=entity.world.getEntity(id);targetEntity?(newIds.push(id),entities.push(targetEntity)):entity[idProp]=void 0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return entity[idArrayProp]=newIds,entities}(this,"inventoryItemIds")}},{key:"onPickUp",value:function(evt){this.inventoryItemIds.push(evt.data.id),evt.data.position&&(evt.data.remove(evt.data.position),evt.data.remove(evt.data.isPickup))}},{key:"onDrop",value:function(evt){this.inventoryItemIds=this.inventoryItemIds.filter((function(itemId){return itemId!==evt.data.id})),console.log(evt),evt.data.add(Position_Position,{x:this.entity.position.x,y:this.entity.position.y,z:this.entity.position.z}),evt.data.add(IsPickup)}},{key:"onConsume",value:function(evt){this.inventoryItemIds=this.inventoryItemIds.filter((function(itemId){return itemId!==evt.data.id})),evt.data.destroy()}}])&&Inventory_defineProperties(Constructor.prototype,protoProps),staticProps&&Inventory_defineProperties(Constructor,staticProps),Inventory}(Component);function Misc_typeof(obj){return(Misc_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Misc_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Misc_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Misc_setPrototypeOf(subClass,superClass)}function Misc_setPrototypeOf(o,p){return(Misc_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Misc_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Misc_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Misc_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Misc_possibleConstructorReturn(this,result)}}function Misc_possibleConstructorReturn(self,call){return!call||"object"!==Misc_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Misc_getPrototypeOf(o){return(Misc_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Misc_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}!function(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(Inventory_Inventory,"properties",{inventoryItemIds:[]});var Description=function(_Component){Misc_inherits(Description,_Component);var _super=Misc_createSuper(Description);function Description(){return Misc_classCallCheck(this,Description),_super.apply(this,arguments)}return Description}(Component);Misc_defineProperty(Description,"properties",{name:"No Name"});var Appearance=function(_Component2){Misc_inherits(Appearance,_Component2);var _super2=Misc_createSuper(Appearance);function Appearance(){return Misc_classCallCheck(this,Appearance),_super2.apply(this,arguments)}return Appearance}(Component);function Move_typeof(obj){return(Move_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Move_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Move_setPrototypeOf(o,p){return(Move_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Move_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Move_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Move_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Move_possibleConstructorReturn(this,result)}}function Move_possibleConstructorReturn(self,call){return!call||"object"!==Move_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Move_getPrototypeOf(o){return(Move_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}Misc_defineProperty(Appearance,"properties",{color:"#ff0077",char:"?",background:"#000"});var Move=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Move_setPrototypeOf(subClass,superClass)}(Move,_Component);var _super=Move_createSuper(Move);function Move(){return Move_classCallCheck(this,Move),_super.apply(this,arguments)}return Move}(Component);function StatusEffects_typeof(obj){return(StatusEffects_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function StatusEffects_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function StatusEffects_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&StatusEffects_setPrototypeOf(subClass,superClass)}function StatusEffects_setPrototypeOf(o,p){return(StatusEffects_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function StatusEffects_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=StatusEffects_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=StatusEffects_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return StatusEffects_possibleConstructorReturn(this,result)}}function StatusEffects_possibleConstructorReturn(self,call){return!call||"object"!==StatusEffects_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function StatusEffects_getPrototypeOf(o){return(StatusEffects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}!function(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(Move,"properties",{x:0,y:0,z:0,relative:!0});var Frozen=function(_Component){StatusEffects_inherits(Frozen,_Component);var _super=StatusEffects_createSuper(Frozen);function Frozen(){return StatusEffects_classCallCheck(this,Frozen),_super.apply(this,arguments)}return Frozen}(Component),Paralyzed=function(_Component2){StatusEffects_inherits(Paralyzed,_Component2);var _super2=StatusEffects_createSuper(Paralyzed);function Paralyzed(){return StatusEffects_classCallCheck(this,Paralyzed),_super2.apply(this,arguments)}return Paralyzed}(Component),Poisoned=function(_Component3){StatusEffects_inherits(Poisoned,_Component3);var _super3=StatusEffects_createSuper(Poisoned);function Poisoned(){return StatusEffects_classCallCheck(this,Poisoned),_super3.apply(this,arguments)}return Poisoned}(Component);function Targeting_typeof(obj){return(Targeting_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function Targeting_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Targeting_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Targeting_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Targeting_setPrototypeOf(subClass,superClass)}function Targeting_setPrototypeOf(o,p){return(Targeting_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function Targeting_createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=Targeting_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Targeting_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Targeting_possibleConstructorReturn(this,result)}}function Targeting_possibleConstructorReturn(self,call){return!call||"object"!==Targeting_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Targeting_getPrototypeOf(o){return(Targeting_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function Targeting_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var RequiresTarget=function(_Component){Targeting_inherits(RequiresTarget,_Component);var _super=Targeting_createSuper(RequiresTarget);function RequiresTarget(){return Targeting_classCallCheck(this,RequiresTarget),_super.apply(this,arguments)}return RequiresTarget}(Component);Targeting_defineProperty(RequiresTarget,"properties",{acquired:"RANDOM",aoeRange:0});var Target=function(_Component2){Targeting_inherits(Target,_Component2);var _super2=Targeting_createSuper(Target);function Target(){return Targeting_classCallCheck(this,Target),_super2.apply(this,arguments)}return Target}(Component);Targeting_defineProperty(Target,"allowMultiple",!0),Targeting_defineProperty(Target,"properties",{locId:""});var Targeting_TargetingItem=function(_Component3){Targeting_inherits(TargetingItem,_Component3);var Constructor,protoProps,staticProps,_super3=Targeting_createSuper(TargetingItem);function TargetingItem(){return Targeting_classCallCheck(this,TargetingItem),_super3.apply(this,arguments)}return Constructor=TargetingItem,(protoProps=[{key:"item",get:function(){return function(entity,idProp){var id=entity[idProp];id&&(entity.world.getEntity(id)||(entity[idProp]=void 0))}(this,"itemId")},set:function(value){!function(entity,idProp,value){var id=value;value instanceof String||(id=value.id),entity[idProp]=id}(this,"itemId",value)}}])&&Targeting_defineProperties(Constructor.prototype,protoProps),staticProps&&Targeting_defineProperties(Constructor,staticProps),TargetingItem}(Component);Targeting_defineProperty(Targeting_TargetingItem,"properties",{itemId:0});var ecs=new Engine;ecs.registerComponent(ActiveEffects),ecs.registerComponent(Animate),ecs.registerComponent(Ai),ecs.registerComponent(Appearance),ecs.registerComponent(Description),ecs.registerComponent(Defense),ecs.registerComponent(Dropped),ecs.registerComponent(Effects),ecs.registerComponent(EquipmentSlot),ecs.registerComponent(EquipmentEffect),ecs.registerComponent(Attributes_Health),ecs.registerComponent(Inventory_Inventory),ecs.registerComponent(IsBlocking),ecs.registerComponent(IsDead),ecs.registerComponent(IsEquippable),ecs.registerComponent(IsEquipped),ecs.registerComponent(IsInFov),ecs.registerComponent(IsOpaque),ecs.registerComponent(IsPickup),ecs.registerComponent(IsRevealed),ecs.registerComponent(IsStairs),ecs.registerComponent(Layer100),ecs.registerComponent(Layer300),ecs.registerComponent(Layer400),ecs.registerComponent(Move),ecs.registerComponent(RequiresTarget),ecs.registerComponent(Paralyzed),ecs.registerComponent(Position_Position),ecs.registerComponent(Power),ecs.registerComponent(Slot),ecs.registerComponent(Target),ecs.registerComponent(Targeting_TargetingItem),ecs.registerPrefab({name:"Tile",components:[{type:"Appearance"},{type:"Description"},{type:"Layer100"}]}),ecs.registerPrefab({name:"Being",components:[{type:"Appearance"},{type:"Defense"},{type:"Description"},{type:"Health"},{type:"IsBlocking"},{type:"Layer400"},{type:"Power"}]}),ecs.registerPrefab({name:"Item",components:[{type:"Appearance"},{type:"Description"},{type:"Layer300"},{type:"IsPickup"}]}),ecs.registerPrefab({name:"Gear",inherit:["Item"],components:[{type:"IsEquippable"}]}),ecs.registerPrefab({name:"Floor",inherit:["Tile"],components:[{type:"Appearance",properties:{char:"",color:"#333"}},{type:"Description",properties:{name:"floor"}}]}),ecs.registerPrefab({name:"StairsDown",inherit:["Tile"],components:[{type:"IsStairs"},{type:"Appearance",properties:{char:">",color:"#AAA"}},{type:"Description",properties:{name:"set of stairs leading down"}}]}),ecs.registerPrefab({name:"StairsUp",inherit:["Tile"],components:[{type:"IsStairs"},{type:"Appearance",properties:{char:"<",color:"#AAA"}},{type:"Description",properties:{name:"set of stairs leading up"}}]}),ecs.registerPrefab({name:"Wall",inherit:["Tile"],components:[{type:"IsBlocking"},{type:"IsOpaque"},{type:"Appearance",properties:{char:"",color:"#AAA"}},{type:"Description",properties:{name:"wall"}}]}),ecs.registerPrefab({name:"HealthPotion",inherit:["Item"],components:[{type:"Appearance",properties:{char:"!",color:"#DAA520"}},{type:"Description",properties:{name:"health potion"}},{type:"Effects",properties:{component:"health",delta:5,animate:{color:"#ff0000",char:""}}}]}),ecs.registerPrefab({name:"ScrollFireball",inherit:["Item"],components:[{type:"Appearance",properties:{char:"",color:"#DAA520"}},{type:"Description",properties:{name:"scroll of fireball"}},{type:"Effects",properties:{animate:{color:"#FFA200",char:"^"},events:[{name:"take-damage",args:{amount:25}}]}},{type:"RequiresTarget",properties:{acquired:"MANUAL",aoeRange:3}}]}),ecs.registerPrefab({name:"ScrollLightning",inherit:["Item"],components:[{type:"Appearance",properties:{char:"",color:"#DAA520"}},{type:"Description",properties:{name:"scroll of lightning"}},{type:"Effects",properties:{animate:{color:"#F7FF00"},events:[{name:"take-damage",args:{amount:25}}]}},{type:"RequiresTarget",properties:{acquired:"RANDOM"}}]}),ecs.registerPrefab({name:"ScrollParalyze",inherit:["Item"],components:[{type:"Appearance",properties:{char:"",color:"#DAA520"}},{type:"Description",properties:{name:"scroll of paralyze"}},{type:"Effects",properties:{animate:{color:"#FFB0B0"},addComponents:[{name:"Paralyzed",properties:{}}],duration:10}},{type:"RequiresTarget",properties:{acquired:"MANUAL"}}]}),ecs.registerPrefab({name:"Armor",inherit:["Gear"],components:[{type:"Appearance",properties:{char:"",color:"#ff99ff"}},{type:"Description",properties:{name:"armor piece"}}]}),ecs.registerPrefab({name:"Boots",inherit:["Armor"],components:[{type:"Description",properties:{name:"boots"}},{type:"Slot",properties:{name:"legs"}}]}),ecs.registerPrefab({name:"Chest",inherit:["Armor"],components:[{type:"Description",properties:{name:"chest piece"}},{type:"Slot",properties:{name:"chest"}}]}),ecs.registerPrefab({name:"Helmet",inherit:["Armor"],components:[{type:"Description",properties:{name:"helmet"}},{type:"Slot",properties:{name:"head"}}]}),ecs.registerPrefab({name:"Shield",inherit:["Armor"],components:[{type:"Description",properties:{name:"shield"}},{type:"Slot",properties:{name:"shield"}}]}),ecs.registerPrefab({name:"Weapon",inherit:["Gear"],components:[{type:"Appearance",properties:{char:"",color:"#0066ff"}},{type:"Description",properties:{name:"weapon"}},{type:"Slot",properties:{name:"weapon"}},{type:"EquipmentEffect",properties:{component:"power",delta:1}}]}),ecs.registerPrefab({name:"Goblin",inherit:["Being"],components:[{type:"Ai"},{type:"Appearance",properties:{char:"g",color:"green"}},{type:"Description",properties:{name:"goblin"}},{type:"Power",properties:{base:2,current:2}},{type:"Health",properties:{base:7,current:7}}]}),ecs.registerPrefab({name:"GoblinWarrior",inherit:["Being"],components:[{type:"Ai"},{type:"Appearance",properties:{char:"w",color:"green"}},{type:"Description",properties:{name:"goblin warrior"}},{type:"Defense",properties:{base:2,current:2}},{type:"Power",properties:{base:4,current:4}}]}),ecs.registerPrefab({name:"Player",inherit:["Being"],components:[{type:"Appearance",properties:{char:"@",color:"#FFF"}},{type:"Description",properties:{name:"You"}},{type:"Inventory"}]});var state_ecs=ecs.createWorld(),WEAPON_PREFIXES={glinting:{component:"power",delta:1},polished:{component:"power",delta:3},tempered:{component:"power",delta:5}},ARMOR_PREFIXES={healthy:{component:"health",delta:1},stalwart:{component:"health",delta:2},virile:{component:"health",delta:3}},ARMOR_SUFFIXES={laquered:{component:"defense",delta:1},fortified:{component:"defense",delta:2},plated:{component:"defense",delta:3}};function misc_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return misc_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return misc_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function misc_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getHighestMatch=function(array,needle){var highest_match,_step,_iterator=misc_createForOfIteratorHelper(array);try{for(_iterator.s();!(_step=_iterator.n()).done;){var floor=_step.value;if(floor>needle)break;highest_match=floor}}catch(err){_iterator.e(err)}finally{_iterator.f()}return highest_match},DUNGEON_LAYOUT={1:{maxRoomCount:6,width:Math.round(.6*canvas_grid.map.width),height:Math.round(.6*canvas_grid.map.height)},5:{maxRoomCount:12,width:Math.round(.8*canvas_grid.map.width),height:Math.round(.8*canvas_grid.map.height)},9:{maxRoomCount:18,width:canvas_grid.map.width,height:canvas_grid.map.height},14:{maxRoomCount:24,width:canvas_grid.map.width,height:canvas_grid.map.height},19:{maxRoomCount:30,width:canvas_grid.map.width,height:canvas_grid.map.height}},MAX_ITEMS_BY_FLOOR={1:2,5:3,9:5,14:7,19:10},ITEM_WEIGHT={0:[{name:"HealthPotion",weight:50},{name:"Weapon",weight:30},{name:"Shield",weight:20},{name:"Boots",weight:20},{name:"Helmet",weight:20},{name:"Chest",weight:20}],2:[{name:"ScrollParalyze",weight:10}],4:[{name:"ScrollLightning",weight:25}],6:[{name:"ScrollFireball",weight:25}]},MAX_MONSTERS_BY_FLOOR={1:3,5:6,9:9,14:12,19:15},MONSTER_WEIGHT={0:[{name:"Goblin",weight:80}],3:[{name:"GoblinWarrior",weight:15}],5:[{name:"GoblinWarrior",weight:30}],7:[{name:"GoblinWarrior",weight:60}]};function dungeon_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function dungeon_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?dungeon_ownKeys(Object(source),!0).forEach((function(key){dungeon_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):dungeon_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function dungeon_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function digHorizontalPassage(x1,x2,y,z){for(var tiles={},start=Math.min(x1,x2),end=Math.max(x1,x2)+1,x=start;x<end;)tiles["".concat(x,",").concat(y,",").concat(z)]={x:x,y:y,z:z,sprite:"FLOOR"},x++;return tiles}function digVerticalPassage(y1,y2,x,z){for(var tiles={},start=Math.min(y1,y2),end=Math.max(y1,y2)+1,y=start;y<end;)tiles["".concat(x,",").concat(y,",").concat(z)]={x:x,y:y,z:z,sprite:"FLOOR"},y++;return tiles}var dungeon_createDungeon=function(_ref){var x=_ref.x,y=_ref.y,z=_ref.z,width=_ref.width,height=_ref.height,_ref$minRoomSize=_ref.minRoomSize,minRoomSize=void 0===_ref$minRoomSize?6:_ref$minRoomSize,_ref$maxRoomSize=_ref.maxRoomSize,maxRoomSize=void 0===_ref$maxRoomSize?12:_ref$maxRoomSize,_ref$maxRoomCount=_ref.maxRoomCount,maxRoomCount=void 0===_ref$maxRoomCount?30:_ref$maxRoomCount,dungeon=rectangle({x:x,y:y,z:z,width:width,height:height},{sprite:"WALL"}),rooms=[],roomTiles={};times_default()(maxRoomCount,(function(){var rw=random_default()(minRoomSize,maxRoomSize),rh=random_default()(minRoomSize,maxRoomSize),rx=random_default()(x,width+x-rw),ry=random_default()(y,height+y-rh),candidate=rectangle({x:rx,y:ry,z:z,width:rw,height:rh,hasWalls:!0},{sprite:"FLOOR"});rooms.some((function(room){return rect2=candidate,(rect1=room).x1<=rect2.x2&&rect1.x2>=rect2.x1&&rect1.y1<=rect2.y2&&rect1.y2>=rect2.y1;var rect1,rect2}))||(rooms.push(candidate),roomTiles=dungeon_objectSpread(dungeon_objectSpread({},roomTiles),candidate.tiles))}));for(var passageTiles,prevRoom=null,_i=0,_rooms=rooms;_i<_rooms.length;_i++){var room=_rooms[_i];if(prevRoom){var prev=prevRoom.center,curr=room.center;passageTiles=dungeon_objectSpread(dungeon_objectSpread(dungeon_objectSpread({},passageTiles),digHorizontalPassage(prev.x,curr.x,curr.y,z)),digVerticalPassage(prev.y,curr.y,prev.x,z))}prevRoom=room}return dungeon.rooms=rooms,dungeon.tiles=dungeon_objectSpread(dungeon_objectSpread(dungeon_objectSpread({},dungeon.tiles),roomTiles),passageTiles),Object.keys(dungeon.tiles).forEach((function(key){var tile=dungeon.tiles[key];"WALL"===tile.sprite&&state_ecs.createPrefab("Wall").add(Position_Position,dungeon_objectSpread(dungeon_objectSpread({},dungeon.tiles[key]),{},{z:z})),"FLOOR"===tile.sprite&&state_ecs.createPrefab("Floor").add(Position_Position,dungeon_objectSpread(dungeon_objectSpread({},dungeon.tiles[key]),{},{z:z}))})),dungeon},dungeon_getOpenTiles=function(dungeon){var openTiles=Object.values(dungeon.tiles).filter((function(x){return"FLOOR"===x.sprite}));return sample_default()(openTiles)},dungeon_createDungeonLevel=function(){var stairsUp,stairsDown,_ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref2$createStairsUp=_ref2.createStairsUp,createStairsUp=void 0===_ref2$createStairsUp||_ref2$createStairsUp,_ref2$createStairsDow=_ref2.createStairsDown,createStairsDown=void 0===_ref2$createStairsDow||_ref2$createStairsDow,currentLevel=Math.abs(cache_readCache("z")),dimensions=DUNGEON_LAYOUT[getHighestMatch(Object.keys(DUNGEON_LAYOUT),currentLevel)],dungeon=dungeon_createDungeon({x:canvas_grid.map.x,y:canvas_grid.map.y,z:cache_readCache("z"),width:dimensions.width,height:dimensions.height,maxRoomCount:dimensions.maxRoomCount});return dungeon_generateEntities(currentLevel,MAX_ITEMS_BY_FLOOR,ITEM_WEIGHT,dungeon),dungeon_generateAffixes(),dungeon_generateEntities(currentLevel,MAX_MONSTERS_BY_FLOOR,MONSTER_WEIGHT,dungeon),createStairsUp&&times_default()(1,(function(){(stairsUp=state_ecs.createPrefab("StairsUp")).add(Position_Position,dungeon_getOpenTiles(dungeon))})),createStairsDown&&times_default()(1,(function(){(stairsDown=state_ecs.createPrefab("StairsDown")).add(Position_Position,dungeon_getOpenTiles(dungeon))})),{dungeon:dungeon,stairsUp:stairsUp,stairsDown:stairsDown}},dungeon_generateEntities=function(level,maxEntitiesByFloor,entityWeight,dungeon){var amount=maxEntitiesByFloor[getHighestMatch(Object.keys(maxEntitiesByFloor),level)];dungeon_getEntitiesAtRandom(entityWeight,amount,level,dungeon)},dungeon_getEntitiesAtRandom=function(weightedChances,amountOfEntities,currentLevel,dungeon){var entityWeightedChances=function(weightedChances,level){var entityWeightedChances={};for(var floor in weightedChances){if(floor>level)break;weightedChances[floor].forEach((function(entity){entityWeightedChances[entity.name]=entity.weight}))}return entityWeightedChances}(weightedChances,currentLevel);times_default()(Math.floor(Math.random()*amountOfEntities+1),(function(){var prefab=function(data){var total=0;for(var _key in data)total+=data[_key];var key,random=Math.random()*total,part=0;for(key in data)if(random<(part+=data[key]))return key;return key}(entityWeightedChances);state_ecs.createPrefab(prefab).add(Position_Position,dungeon_getOpenTiles(dungeon))}))},dungeon_generateAffixes=function(){state_ecs.createQuery({all:[IsEquippable,IsPickup],none:[Dropped]}).get().forEach((function(item){"weapon"!==item.slot.name?(dungeon_addAffix(item,ARMOR_SUFFIXES),dungeon_addAffix(item,ARMOR_PREFIXES)):dungeon_addAffix(item,WEAPON_PREFIXES)}))},dungeon_addAffix=function(item,affixes){times_default()(getWeightedNumber(!1),(function(){var affix=Object.keys(affixes)[getWeightedNumber()];item.add(EquipmentEffect,affixes[affix]),item.description.name="".concat(affix," ").concat(item.description.name)}))},getWeightedNumber=function(){var isAffix=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],rng=Math.floor(20*Math.random()+1);return isAffix?rng<=10?0:rng<=16?1:2:rng<=13?0:1},some=__webpack_require__(58),some_default=__webpack_require__.n(some),pathfinding=__webpack_require__(35),pathfinding_default=__webpack_require__.n(pathfinding);function pathfinding_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return pathfinding_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return pathfinding_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pathfinding_arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pathfinding_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var baseMatrix=[];times_default()(canvas_grid.height,(function(){return baseMatrix.push(new Array(canvas_grid.width).fill(0))}));var aiEntities=state_ecs.createQuery({all:[Ai,Description]}),ai_moveToTarget=function(entity,target){var path=function(start,goal){var matrix=JSON.parse(JSON.stringify(baseMatrix));Object.keys(cache_readCache("entitiesAtLocation")).forEach((function(locId){var cell=toCell(locId);cell.z===cache_readCache("z")&&some_default()(pathfinding_toConsumableArray(readCacheSet("entitiesAtLocation",locId)),(function(eId){return state_ecs.getEntity(eId).isBlocking}))&&(matrix[cell.y][cell.x]=1)})),matrix[start.y][start.x]=0,matrix[goal.y][goal.x]=0;var grid=new pathfinding_default.a.Grid(matrix);return new pathfinding_default.a.AStarFinder({allowDiagonal:!1,dontCrossCorners:!0}).findPath(start.x,start.y,goal.x,goal.y,grid)}(entity.position,target.position);if(path.length){var newLoc=path[1];entity.add(Move,{x:newLoc[0],y:newLoc[1],z:cache_readCache("z"),relative:!1})}},last=__webpack_require__(59),last_default=__webpack_require__.n(last),animatingEntities=state_ecs.createQuery({all:[Animate]}),animation_animation=function(){"GAME"===gameState&&animatingEntities.get().forEach((function(entity){var hex,result,animate=last_default()(entity.animate),_hexToRgb=(hex=animate.color,(result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex))?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:{}),_hexToRgb$r=_hexToRgb.r,r=void 0===_hexToRgb$r?255:_hexToRgb$r,_hexToRgb$g=_hexToRgb.g,g=void 0===_hexToRgb$g?255:_hexToRgb$g,_hexToRgb$b=_hexToRgb.b,b=void 0===_hexToRgb$b?255:_hexToRgb$b,time=new Date;animate.startTime||entity.fireEvent("set-start-time",{time:time});var frameTime=time-animate.startTime;if(frameTime>animate.duration)return entity.remove(animate);var framePercent=frameTime/animate.duration;clearCanvas(entity.position.x,entity.position.y,1,1),drawCell(entity),drawCell({appearance:{char:animate.char||entity.appearance.char,color:"rgba(".concat(r,", ").concat(g,", ").concat(b,", ").concat(1-framePercent,")"),background:"transparent"},position:entity.position})}))};function effects_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function effects_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var classes={Frozen:Frozen,Paralyzed:Paralyzed,Poisoned:Poisoned},activeEffectsEntities=state_ecs.createQuery({all:[ActiveEffects]}),effects_effects=function(){activeEffectsEntities.get().forEach((function(entity){entity.activeEffects.forEach((function(c){entity[c.component]&&(entity[c.component].current+=c.delta,entity[c.component].current>entity[c.component].max&&(entity[c.component].current=entity[c.component].max)),c.events.length&&c.events.forEach((function(event){return entity.fireEvent(event.name,event.args)})),c.addComponents.length&&c.addComponents.forEach((function(component){entity.has(classes[component.name])||entity.add(classes[component.name],component.properties)})),entity.add(Animate,function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?effects_ownKeys(Object(source),!0).forEach((function(key){effects_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):effects_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},c.animate)),c.duration?c.duration-=1:(c.destroy(),c.addComponents.length&&c.addComponents.forEach((function(component){var string;entity.has(classes[component.name])&&entity.remove(entity[(string=component.name,string[0].toLowerCase()+string.slice(1))])})))}))}))},equip_unequipItem=function(entity,player){entity.remove(entity.isEquipped),player.fireEvent("unequip",entity),player.equipmentSlot[entity.slot.name].destroy(),addLog("You unequip ".concat(entity.description.name))};function fov_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return fov_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||fov_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fov_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return fov_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fov_arrayLikeToArray(o,minLen):void 0}}function fov_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var octantTransforms=[{xx:1,xy:0,yx:0,yy:1},{xx:1,xy:0,yx:0,yy:-1},{xx:-1,xy:0,yx:0,yy:1},{xx:-1,xy:0,yx:0,yy:-1},{xx:0,xy:1,yx:1,yy:0},{xx:0,xy:1,yx:-1,yy:0},{xx:0,xy:-1,yx:1,yy:0},{xx:0,xy:-1,yx:-1,yy:0}];function createFOV(opaqueEntities,width,height,originX,originY,originZ,radius){var visible=new Set,blockingLocations=new Set;opaqueEntities.get().forEach((function(x){x.position.z===originZ&&blockingLocations.add("".concat(x.position.x,",").concat(x.position.y,",").concat(x.position.z))}));var isOpaque=function(x,y){var locId="".concat(x,",").concat(y,",").concat(originZ);return!!blockingLocations.has(locId)},reveal=function(x,y){return visible.add("".concat(x,",").concat(y,",").concat(originZ))};function castShadows(originX,originY,row,start,end,transform,radius){var newStart=0;if(!(start<end))for(var blocked=!1,_distance=row;_distance<radius&&!blocked;_distance++)for(var deltaY=-_distance,deltaX=-_distance;deltaX<=0;deltaX++){var currentX=originX+deltaX*transform.xx+deltaY*transform.xy,currentY=originY+deltaX*transform.yx+deltaY*transform.yy,leftSlope=(deltaX-.5)/(deltaY+.5),rightSlope=(deltaX+.5)/(deltaY-.5);if(currentX>=0&&currentY>=0&&currentX<width&&currentY<height&&!(start<rightSlope)){if(end>leftSlope)break;if(Math.sqrt(deltaX*deltaX+deltaY*deltaY)<=radius&&reveal(currentX,currentY),blocked){if(isOpaque(currentX,currentY)){newStart=rightSlope;continue}blocked=!1,start=newStart}else isOpaque(currentX,currentY)&&_distance<radius&&(blocked=!0,castShadows(originX,originY,_distance+1,start,leftSlope,transform,radius),newStart=rightSlope)}}}reveal(originX,originY);var _step,_iterator=function(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=fov_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(octantTransforms);try{for(_iterator.s();!(_step=_iterator.n()).done;){var octant=_step.value;castShadows(originX,originY,1,1,0,octant,radius)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{fov:visible,distance:fov_toConsumableArray(visible).reduce((function(acc,val){var cell1,cell2,x,y,cell=idToCell(val);return acc[val]=(cell1={x:originX,y:originY},cell2={x:cell.x,y:cell.y},x=Math.pow(cell2.x-cell1.x,2),y=Math.pow(cell2.y-cell1.y,2),Math.floor(Math.sqrt(x+y))),acc}),{})}}var inFovEntities=state_ecs.createQuery({all:[IsInFov]}),fov_opaqueEntities=state_ecs.createQuery({all:[IsOpaque]}),fov_fov=function(origin){var width=canvas_grid.width,height=canvas_grid.height,originX=origin.position.x,originY=origin.position.y,FOV=createFOV(fov_opaqueEntities,width,height,originX,originY,cache_readCache("z"),10);inFovEntities.get().forEach((function(x){return x.remove(x.isInFov)})),FOV.fov.forEach((function(locId){var entitiesAtLoc=readCacheSet("entitiesAtLocation",locId);entitiesAtLoc&&entitiesAtLoc.forEach((function(eId){var entity=state_ecs.getEntity(eId);entity.add(IsInFov),entity.has(IsRevealed)||entity.add(IsRevealed)}))}))};function movement_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return movement_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return movement_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function movement_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var movableEntities=state_ecs.createQuery({all:[Move]}),movement_movement=function(){movableEntities.get().forEach((function(entity){if(!entity.has(Paralyzed)){var mx=entity.move.x,my=entity.move.y,mz=entity.move.z;entity.move.relative&&(mx=entity.position.x+entity.move.x,my=entity.position.y+entity.move.y),mx=Math.min(canvas_grid.map.width+canvas_grid.map.x-1,Math.max(0,mx)),my=Math.min(canvas_grid.map.height+canvas_grid.map.y-1,Math.max(0,my));var _step,blockers=[],_iterator=movement_createForOfIteratorHelper(readCacheSet("entitiesAtLocation","".concat(mx,",").concat(my,",").concat(mz)));try{for(_iterator.s();!(_step=_iterator.n()).done;){var eId=_step.value;state_ecs.getEntity(eId).isBlocking&&blockers.push(eId)}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(blockers.length)return blockers.forEach((function(eId){var target=state_ecs.getEntity(eId);target.has(Attributes_Health)&&target.has(Defense)?function(entity,target){var damage=entity.power.current-target.defense.current;if(damage>0?target.fireEvent("take-damage",{amount:damage}):damage=0,target.health.current<=0)return addLog("".concat(entity.description.name," kicked a ").concat(target.description.name," for ").concat(damage," damage and killed ").concat(target.description.name,"!"));addLog("".concat(entity.description.name," kicked ").concat(target.description.name," for ").concat(damage," damage!"))}(entity,target):addLog("".concat(entity.description.name," bump into a ").concat(target.description.name))})),void entity.remove(entity.move);entity.remove(entity.position),entity.add(Position_Position,{x:mx,y:my,z:mz}),entity.remove(entity.move)}}))},throttle=__webpack_require__(60),throttle_default=__webpack_require__.n(throttle),Sword='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#color"><g transform="scale(-1 -1) translate(-512, -512)"><path d="M24.68 24.68c-3.535 3.537-5.85 9.779-5.85 16.264 0 4.39 1.123 8.6 2.905 12.003l23.41-7.803 7.802-23.409c-3.403-1.782-7.612-2.904-12.003-2.904-6.485 0-12.727 2.314-16.263 5.85zm17.133 40.545L84.49 105.82c2.94-4.483 5.96-8.317 9.486-11.843 3.526-3.525 7.36-6.546 11.843-9.486L65.226 41.814l-5.854 17.558zm64.892 41.48c-3.067 3.067-5.818 6.763-8.872 11.806l77.446 73.667c2.645-3.307 5.214-6.216 7.948-8.95 2.735-2.735 5.644-5.304 8.951-7.949l-73.667-77.446c-5.043 3.054-8.739 5.805-11.806 8.872zm88.941 88.94c-9.114 9.115-17.08 22.447-35.67 50.598l11.092 11.092c34.16-51.62 34.647-52.106 86.267-86.267l-11.092-11.092c-28.15 18.59-41.483 26.556-50.597 35.67zm24.042 24.043c-3.998 3.997-7.577 8.54-11.858 14.661l242.865 237.584 42.474 21.236-21.236-42.474L234.349 207.83c-6.12 4.281-10.664 7.86-14.661 11.858z"/></g></svg>',equipment_Helmet='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#color"><g><path d="M240.028 26v221.481L257.065 256l17.037-8.519V26h-34.074zM222.99 60.074c-80.22 0-136.297 56.077-136.297 136.296h119.26l17.037 17.037V60.074zm66.018 0v153.333l17.037-17.037h119.26c0-80.219-56.077-136.296-136.297-136.296zM69.657 213.407v34.074h50.047l-33.01-34.074H69.657zm41.528 0l34.074 34.074h34.074l-34.074-34.074h-34.074zm58.565 0l34.074 34.074h19.167v-8.518l-25.556-25.556H169.75zm144.815 0l-25.556 25.556v8.518h19.167l34.074-34.074h-27.685zm52.176 0l-34.074 34.074h34.074l34.074-34.074H366.74zm58.565 0l-33.01 34.074h50.047v-34.074h-17.037zM86.694 264.52v34.074l120.325 60.694 5.68-36.497-100.449-41.234-8.519-17.037H86.694zm321.575 0l-8.519 17.037-100.448 41.234 5.68 36.497 120.324-60.694v-34.074h-17.037zm-168.241 2.13L222.99 366.74l34.074 17.037 34.074-17.037-17.037-100.093-17.037 8.519-17.037-8.519zM78.176 314.564l-46.852 41.528v59.63l61.76-93.704-14.908-7.454zm355.648 0l-14.907 7.454 61.759 93.703v-59.63l-46.852-41.527zm-324.768 15.972L40.907 432.759l64.954 44.722 58.565-119.259-55.37-27.685zm293.888 0l-55.37 27.685 58.565 119.26 64.954-44.723-68.149-102.222zm-222.546 35.139L120.768 486h89.445l12.778-51.111h25.555v-36.204l-68.148-33.01zm151.204 0l-68.148 33.01v36.203h25.555L301.787 486h89.444l-59.63-120.324z"/></g></svg>',Legs='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#color"><g><path d="M128 22.781c-11.101 10.941-19.822 27.6-26.076 41.203 6.044 20.063 11.083 40.869 27.539 54.926 18.862-14.015 27.05-33.752 35.187-56.351C154.631 51.155 144.412 34.368 128 22.78zm256 0c-16.412 11.587-26.631 28.374-36.65 39.778 8.137 22.599 16.325 42.336 35.187 56.351 16.456-14.057 21.495-34.863 27.54-54.926C403.821 50.381 395.1 33.722 384 22.781zM222.23 46.104c-11.546 2.749-24.948 7.229-37.04 12.68-8.622 28.9-21.924 55.363-45.965 74.734l16.55 177.107-19.933-8.438-14.61-167.787c-16.163-16.006-28.001-43.023-38.39-71.285-3.545-2.304-7.083-4.15-10.621-5.424 6.237 82.926 25.341 186.732 47.006 274.592 2.544-1.159 5.746-2.4 8.724-3.459 29.464 7.318 56.995 29.357 81.848 53.067C192 272 256 160 222.23 46.104zm67.54 0C256 160 320 272 302.2 381.89c24.853-23.71 52.384-45.75 81.848-53.067 2.978 1.06 6.18 2.3 8.724 3.46 21.665-87.86 40.77-191.667 47.006-274.593-3.538 1.274-7.076 3.12-10.62 5.424-10.39 28.262-22.228 55.28-38.391 71.285l-14.61 167.787-19.933 8.438 16.55-177.107c-24.04-19.37-37.343-45.834-45.964-74.735-12.093-5.45-25.495-9.93-37.041-12.68zM129.004 347.83c-13.31 5.672-27.915 18.355-33.014 34.666 23.725 4.679 52.808 18.407 75.524 40.389l3.947 26.867 33.467-12.074-1.33-29.082c-19.75-28.701-51.073-52.92-78.594-60.766zm253.992 0c-27.52 7.846-58.843 32.065-78.594 60.766l-1.33 29.082 33.467 12.074 3.947-26.867c22.716-21.982 51.8-35.71 75.524-40.389-5.099-16.311-19.704-28.994-33.014-34.666zM90.69 399.703l-52.257 39.272c-10.312 15.251-12.923 32.609-8.657 47.158 52.559 9.293 88.252-3.287 129.043-25.838l-4.275-29.084c-14.703-15.135-33.665-26.354-63.854-31.508zm330.622 0c-30.189 5.154-49.151 16.373-63.854 31.508l-4.275 29.084c40.791 22.55 76.484 35.131 129.043 25.838 4.266-14.55 1.655-31.907-8.657-47.158l-52.257-39.272z"/></g></svg>',equipment_Chest='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#color"><g><path d="M162 35.75l-94.49 27.1c-12.05 6.3-23.47 23.9-31.01 46.35-6.07 18.2-9.62 38.9-10.93 58.3L136.7 112zm188 .1L375.4 112l111 55.6c-1.3-19.3-4.9-40.2-10.9-58.3-5.7-17.05-13.6-31.35-22.5-40.05-2.7-2.8-5.5-4.9-8.4-6.4zm-172.9 11.5l-25.7 77.45-92.9 46.4 14.08 53.5 88.82 44.4 94.6-15.9 94.6 15.9 88.8-44.4 14.1-53.5-92.8-46.4-25.8-77.35h-10.5l-59.3 73.95-.1 61.1h-18.1l.1-61-59.3-74.15zM78.65 247.7l22.05 83.9 146.2-43.8v-14.7l-88.4 14.7zm354.75 0l-80 40.1-88.4-14.7v14.7l146.3 43.8zm-186.5 58.7l-31.6 9.6-35.1 70.2 66.7-33.3zm18.1 0v46.5l66.9 33.4-35.2-70.3zM191.7 323l-86.4 26 25.3 96.3zm128.6.1l61.1 122.1 25.3-96.2zm-55.3 50l.1 43.2 100.7 37.8-20.4-40.8zm-18.1 0l-80.2 40.1-20.5 40.9L247 416.3zm.1 62.4l-81.6 30.6 81.6 10.2zm18.1 0v40.7l81.7-10.2z"/></g></svg>',equipment_Shield='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#color"><g><path d="M129.656 21.188L37.936 79.78c3.54 26.805 8.915 53.547 16.127 80.126L240.72 39.594l-19.282-12.5c-31.28-.885-62.204-2.842-91.782-5.907zm253.47.625c-40.51 3.975-83.496 5.938-126.47 5.843l204.625 132.72c7.108-25.89 12.487-51.92 16.095-78.032l-94.25-60.53zM257.937 50.75L59.468 178.656c8.025 26.32 17.865 52.456 29.532 78.313l243.25-158-74.313-48.22zm91.468 59.344l-74.562 48.437 151.28 98.782c11.714-25.803 21.592-51.91 29.688-78.187l-106.406-69.03zm-91.687 59.562L97 274.062c12.202 25.17 26.14 50.064 41.844 74.563l196.094-128.53-77.22-50.44zM352 231.22l-77.53 50.843 101.405 67.187c15.822-24.6 29.895-49.584 42.22-74.875L352 231.22zm-94.53 61.968l-108.345 71.03c13.564 20.062 28.326 39.847 44.28 59.313l132.032-85.28-67.968-45.063zm84.967 56.312L274.5 393.406l47.03 30.375c15.845-19.342 30.513-38.993 44.033-58.936L342.438 349.5zm-84.968 54.875L205.5 437.97c16.233 18.933 33.614 37.54 52.156 55.78 18.385-18.152 35.637-36.678 51.78-55.53l-52.092-33.626.125-.22z"/></g></svg>';function render_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return render_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||render_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function render_slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||render_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function render_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return render_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?render_arrayLikeToArray(o,minLen):void 0}}function render_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var layer100Entities=state_ecs.createQuery({all:[Position_Position,Appearance,Layer100],any:[IsInFov,IsRevealed]}),layer300Entities=state_ecs.createQuery({all:[Position_Position,Appearance,Layer300],any:[IsInFov,IsRevealed]}),layer400Entities=state_ecs.createQuery({all:[Position_Position,Appearance,Layer400,IsInFov]}),render_renderMap=function(player){clearCanvas(canvas_grid.map.x-1,canvas_grid.map.y,canvas_grid.map.width+1,canvas_grid.map.height),layer100Entities.get().forEach((function(entity){entity.position.z===cache_readCache("z")&&(entity.isInFov?drawCell(entity):drawCell(entity,{color:"#333"}))})),layer300Entities.get().forEach((function(entity){entity.position.z===cache_readCache("z")&&(entity.isInFov?drawCell(entity):drawCell(entity,{color:"#333"}))})),layer400Entities.get().forEach((function(entity){entity.position.z===cache_readCache("z")&&(entity.isInFov?drawCell(entity):drawCell(entity,{color:"#100"}))}))},render_renderPlayerHud=function(player){clearCanvas(canvas_grid.playerHud.x,canvas_grid.playerHud.y,canvas_grid.playerHud.width+1,canvas_grid.playerHud.height),drawText({text:"".concat(player.appearance.char," ").concat(player.description.name),background:"".concat(player.appearance.background),color:"".concat(player.appearance.color),x:canvas_grid.playerHud.x,y:canvas_grid.playerHud.y});var goodHealth=player.health.current>player.health.base/2;drawText({text:"".concat(player.health.current,"/").concat(player.health.base," HP"),background:"black",color:"".concat(goodHealth?"green":"red"),x:canvas_grid.playerHud.x,y:canvas_grid.playerHud.y+1}),drawText({text:"Depth: ".concat(Math.abs(cache_readCache("z"))),background:"black",color:"#666",x:canvas_grid.playerHud.x,y:canvas_grid.playerHud.y+2}),drawText({text:"Power: ".concat(player.power.current),background:"black",color:"#DDD",x:canvas_grid.playerHud.x,y:canvas_grid.playerHud.y+4}),drawText({text:"Defense: ".concat(player.defense.current),background:"black",color:"#DDD",x:canvas_grid.playerHud.x,y:canvas_grid.playerHud.y+5})},render_renderPlayerEquipment=function(player){clearCanvas(canvas_grid.playerEquipment.x,canvas_grid.playerEquipment.y,canvas_grid.playerEquipment.width+1,canvas_grid.playerEquipment.height),[{head:equipment_Helmet},{weapon:Sword},{chest:equipment_Chest},{shield:equipment_Shield},{legs:Legs}].forEach((function(slot){var _player$equipmentSlot,_Object$entries$=render_slicedToArray(Object.entries(slot)[0],2),name=_Object$entries$[0],image=_Object$entries$[1];!function(_ref3){var x=_ref3.x,y=_ref3.y,width=_ref3.width,height=_ref3.height,image=_ref3.image,_ref3$color=_ref3.color,color=void 0===_ref3$color?"#FFFFFF":_ref3$color,img=new Image,coloredImage=image.replace(/#color/g,color);img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(coloredImage),img.onload=function(){ctx.drawImage(img,x*cellWidth+cellWidth/2,y*cellHeight+cellHeight/2,width*cellWidth+cellWidth/2,height*cellHeight)}}({x:canvas_grid.playerEquipment[name].x,y:canvas_grid.playerEquipment[name].y,width:3,height:3,image:image,color:null!==(_player$equipmentSlot=player.equipmentSlot)&&void 0!==_player$equipmentSlot&&_player$equipmentSlot[name]?"#FFFFFF":"#111111"})}))},render_clearEquipmentInfo=function(){clearCanvas(canvas_grid.equipmentInfo.x,canvas_grid.equipmentInfo.y,canvas_grid.equipmentInfo.width+1,canvas_grid.equipmentInfo.height)},render_hoverEquipment=function(x,y){[{head:equipment_Helmet},{weapon:Sword},{chest:equipment_Chest},{shield:equipment_Shield},{legs:Legs}].forEach((function(slot){var name=render_slicedToArray(Object.entries(slot)[0],1)[0];if(x>=canvas_grid.playerEquipment[name].x&&x<=canvas_grid.playerEquipment[name].x+3&&y>=canvas_grid.playerEquipment[name].y&&y<=canvas_grid.playerEquipment[name].y+3){var _player$equipmentSlot2,_player$equipmentSlot3,player=state_ecs.createQuery({all:[Inventory_Inventory]}).get()[0];if(null!==(_player$equipmentSlot2=player.equipmentSlot)&&void 0!==_player$equipmentSlot2&&_player$equipmentSlot2[name])!function(item){render_clearEquipmentInfo(),drawText({text:"".concat(item.appearance.char," ").concat(item.description.name),background:"".concat(item.appearance.background),color:"#DDD",x:canvas_grid.equipmentInfo.x,y:canvas_grid.equipmentInfo.y}),item.has(EquipmentEffect)&&item.equipmentEffect.forEach((function(effect,index){drawText({text:"".concat(effect.component,": +").concat(effect.delta),background:"black",color:"#DDD",x:canvas_grid.equipmentInfo.x,y:canvas_grid.equipmentInfo.y+index+1})}))}(state_ecs.getEntity(null===(_player$equipmentSlot3=player.equipmentSlot)||void 0===_player$equipmentSlot3?void 0:_player$equipmentSlot3[name].itemId))}}))},render_renderMessageLog=function(){clearCanvas(canvas_grid.messageLog.x,canvas_grid.messageLog.y,canvas_grid.messageLog.width+1,canvas_grid.messageLog.height),drawText({text:messageLog[2],background:"#000",color:"#666",x:canvas_grid.messageLog.x,y:canvas_grid.messageLog.y}),drawText({text:messageLog[1],background:"#000",color:"#aaa",x:canvas_grid.messageLog.x,y:canvas_grid.messageLog.y+1}),drawText({text:messageLog[0],background:"#000",color:"#fff",x:canvas_grid.messageLog.x,y:canvas_grid.messageLog.y+2})},render_clearInfoBar=function(){drawText({text:" ".repeat(canvas_grid.infoBar.width),x:canvas_grid.infoBar.x,y:canvas_grid.infoBar.y,background:"black"})},render_renderInventory=function(player){var x,y,width,height,color,rect;x=0,y=0,width=canvas_grid.width,height=canvas_grid.height,color="rgba(0,0,0,0.65)",rect=rectangle({x:x,y:y,width:width,height:height}),Object.values(rect.tiles).forEach((function(position){drawBackground({color:color,position:position})})),drawText({text:"INVENTORY",background:"black",color:"white",x:canvas_grid.inventory.x,y:canvas_grid.inventory.y}),drawText({text:"(c)Consume (d)Drop (e)Equip",background:"black",color:"#666",x:canvas_grid.inventory.x,y:canvas_grid.inventory.y+1}),player.inventory.inventoryItems.length?player.inventory.inventoryItems.forEach((function(item,index){drawText({text:"".concat(index===selectedInventoryIndex?"*":" ").concat(item.description.name).concat(item.isEquipped?"[e]":""),background:"black",color:"white",x:canvas_grid.inventory.x,y:canvas_grid.inventory.y+3+index})})):drawText({text:"-empty-",background:"black",color:"#666",x:canvas_grid.inventory.x,y:canvas_grid.inventory.y+3})},render_renderTargeting=function(mPos){var x=mPos.x,y=mPos.y,z=mPos.z,locId=toLocId({x:x,y:y,z:z}),entitiesAtLoc=render_toConsumableArray(readCacheSet("entitiesAtLocation",locId)||[]);if(render_clearInfoBar(),entitiesAtLoc&&entitiesAtLoc.some((function(eId){return state_ecs.getEntity(eId).isRevealed}))){if(targetRange>1)return void function(x,y,radius){circle({x:x,y:y},radius).forEach((function(cell){var x=parseInt(cell.split(",")[0]),y=parseInt(cell.split(",")[1]);drawCell({appearance:{char:"",background:"rgba(74, 0, 218, 0.5)"},position:{x:x,y:y}})}))}(x,y,targetRange);drawCell({appearance:{char:"",background:"rgba(74, 232, 218, 0.5)"},position:{x:x,y:y,z:z}})}},render_render=function(player){render_renderMap(),render_renderPlayerHud(player),render_renderPlayerEquipment(player),render_renderMessageLog(),drawText({text:"(n)New (s)Save (l)Load | (i)Inventory (g)Pickup (arrow keys)Move/Attack (mouse)Look/Target",background:"#000",color:"#666",x:canvas_grid.menu.x,y:canvas_grid.menu.y}),"INVENTORY"===gameState&&render_renderInventory(player)};function targeting_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function targeting_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}document.querySelector("canvas").onmousemove=throttle_default()((function(e){if("GAME"===gameState){var _pxToCell2=render_slicedToArray(pxToCell(e),2),x=_pxToCell2[0],y=_pxToCell2[1];x>=canvas_grid.playerEquipment.x&&y>=canvas_grid.playerEquipment.y&&x<=canvas_grid.playerEquipment.x+canvas_grid.playerEquipment.width&&y<=canvas_grid.playerEquipment.y+canvas_grid.playerEquipment.height&&(render_clearEquipmentInfo(),render_hoverEquipment(x,y)),render_renderMap(),function(mPos){render_clearInfoBar();var x=mPos.x,y=mPos.y,z=mPos.z,locId=toLocId({x:x,y:y,z:z}),entitiesAtLoc=render_toConsumableArray(readCacheSet("entitiesAtLocation",locId)||[]);render_clearInfoBar(),entitiesAtLoc&&(entitiesAtLoc.some((function(eId){return state_ecs.getEntity(eId).isRevealed}))&&drawCell({appearance:{char:"",background:"rgba(255,255,255, 0.5)"},position:{x:x,y:y,z:z}}),entitiesAtLoc.filter((function(eId){var entity=state_ecs.getEntity(eId);return layer100Entities.matches(entity)||layer300Entities.matches(entity)||layer400Entities.matches(entity)})).forEach((function(eId){var entity=state_ecs.getEntity(eId);render_clearInfoBar();var isPlural="s"===render_toConsumableArray(entity.description.name)[render_toConsumableArray(entity.description.name).length-1],entityText="".concat(isPlural?"":"a ").concat(entity.description.name,"(").concat(entity.appearance.char,")");entity.isInFov?drawText({text:"You see ".concat(entityText," here."),x:canvas_grid.infoBar.x,y:canvas_grid.infoBar.y,color:"white",background:"black"}):drawText({text:"You remember seeing ".concat(entityText," here."),x:canvas_grid.infoBar.x,y:canvas_grid.infoBar.y,color:"white",background:"black"})})))}({x:x,y:y,z:cache_readCache("z")})}if("TARGETING"===gameState){var _pxToCell4=render_slicedToArray(pxToCell(e),2),_x=_pxToCell4[0],_y=_pxToCell4[1];render_renderMap(),render_renderTargeting({x:_x,y:_y,z:cache_readCache("z")})}}),100);var targetingEntities=state_ecs.createQuery({all:[Target,Targeting_TargetingItem]}),targeting_targeting=function(player){targetingEntities.get().forEach((function(entity){var item=state_ecs.getEntity(entity.targetingItem.itemId);item&&item.has(Effects)&&(entity.target.forEach((function(t,idx){readCacheSet("entitiesAtLocation",t.locId).forEach((function(eId){var target=state_ecs.getEntity(eId);target.isInFov&&item.effects.forEach((function(x){target.add(ActiveEffects,function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?targeting_ownKeys(Object(source),!0).forEach((function(key){targeting_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):targeting_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},x.serialize()))}))})),entity.remove(entity.target[idx])})),entity.remove(entity.targetingItem),addLog("You use a ".concat(item.description.name)),player.fireEvent("consume",item))}))};function src_slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||src_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function src_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function src_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function src_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return src_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||src_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function src_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=src_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function src_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return src_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?src_arrayLikeToArray(o,minLen):void 0}}function src_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}if(!document.getElementById("favicon")){var src_favicon=document.createElement("link");src_favicon.id="favicon",src_favicon.rel="icon",src_favicon.href=favicon,document.head.appendChild(src_favicon)}var messageLog=["","Welcome to Gobs 'O Goblins!",""],addLog=function(text){messageLog.unshift(text)},src_loadGame=function(){var data=JSON.parse(localStorage.getItem("gameSaveData"));if(data){var _step,_iterator=src_createForOfIteratorHelper(state_ecs.getEntities());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.destroy()}}catch(err){_iterator.e(err)}finally{_iterator.f()}clearCache(),state_ecs.deserialize(data.world),function(data){cache.entitiesAtLocation=Object.keys(data.entitiesAtLocation).reduce((function(acc,val){return acc[val]=new Set(data.entitiesAtLocation[val]),acc}),{}),cache.z=data.z,cache.floors=data.floors}(data.cache),src_player=state_ecs.getEntity(data.playerId),userInput=null,playerTurn=!0,gameState="GAME",selectedInventoryIndex=0,messageLog=data.messageLog,addLog("Game loaded")}else addLog("Failed to load - no saved games found")},enemiesInFOV=state_ecs.createQuery({all:[IsInFov,Ai]}),src_goToDungeonLevel=function(level){var goingUp=cache_readCache("z")<level,floor=cache_readCache("floors")[level];state_ecs.createQuery({all:[IsDead]}).get().forEach((function(deadEntity){return deadEntity.destroy()})),cache_addCache("z",level),src_player.remove(src_player.position);var newPosition=goingUp?null==floor?void 0:floor.stairsDown:null==floor?void 0:floor.stairsUp;if(!floor){var _createDungeonLevel=dungeon_createDungeonLevel(),stairsDown=_createDungeonLevel.stairsDown,stairsUp=_createDungeonLevel.stairsUp;cache_addCache("floors.".concat(level),{stairsDown:toLocId(stairsDown.position),stairsUp:toLocId(stairsUp.position)}),newPosition=goingUp?stairsDown.position:stairsUp.position}src_player.add(Position_Position,toCell(newPosition)),fov_fov(src_player),render_render(src_player)},src_initGame=function(){var _createDungeonLevel2=dungeon_createDungeonLevel({createStairsUp:!1}),dungeon=_createDungeonLevel2.dungeon,stairsDown=_createDungeonLevel2.stairsDown,stairsUp=_createDungeonLevel2.stairsUp;src_player=state_ecs.createPrefab("Player",{health:{base:20,current:20}}),cache_addCache("floors.".concat(-1),{stairsDown:toLocId(stairsDown.position)});var playerSpawn=stairsUp?stairsUp.position:dungeon_getOpenTiles(dungeon);src_player.add(Position_Position,playerSpawn),fov_fov(src_player),render_render(src_player)},src_player={},userInput=null,playerTurn=!0,gameState="GAME",targetRange=1,selectedInventoryIndex=0;src_initGame(),document.addEventListener("keydown",(function(ev){"Shift"!==ev.key&&(userInput=ev.key)}));var src_processUserInput=function(){var gameSaveData;if("l"===userInput&&src_loadGame(),"n"===userInput&&function(){var _step2,_iterator2=src_createForOfIteratorHelper(state_ecs.getEntities());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){_step2.value.destroy()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}clearCache(),userInput=null,playerTurn=!0,gameState="GAME",selectedInventoryIndex=0,messageLog=["","Welcome to Gobs 'O Goblins!",""],src_initGame()}(),"s"===userInput&&(gameSaveData={world:state_ecs.serialize(),cache:{entitiesAtLocation:Object.keys(cache.entitiesAtLocation).reduce((function(acc,val){return acc[val]=cache_toConsumableArray(cache.entitiesAtLocation[val]),acc}),{}),z:cache.z,floors:cache.floors},playerId:src_player.id,messageLog:messageLog},localStorage.setItem("gameSaveData",JSON.stringify(gameSaveData)),addLog("Game saved")),"GAME"===gameState){if(">"===userInput){if(toLocId(src_player.position)!==cache_readCache("floors.".concat(cache_readCache("z"),".stairsDown")))return addLog("There are no stairs here to descend"),void(userInput=null);addLog("You descend deeper into the dungeon"),src_goToDungeonLevel(cache_readCache("z")-1)}if("<"===userInput){if(toLocId(src_player.position)!==cache_readCache("floors.".concat(cache_readCache("z"),".stairsUp")))return addLog("There are no stairs here to climb"),void(userInput=null);addLog("You climb from the depths of the dungeon"),src_goToDungeonLevel(cache_readCache("z")+1)}if("ArrowUp"===userInput&&src_player.add(Move,{x:0,y:-1,z:cache_readCache("z")}),"ArrowRight"===userInput&&src_player.add(Move,{x:1,y:0,z:cache_readCache("z")}),"ArrowDown"===userInput&&src_player.add(Move,{x:0,y:1,z:cache_readCache("z")}),"ArrowLeft"===userInput&&src_player.add(Move,{x:-1,y:0,z:cache_readCache("z")}),"g"===userInput){var pickupFound=!1;readCacheSet("entitiesAtLocation",toLocId(src_player.position)).forEach((function(eId){var entity=state_ecs.getEntity(eId);entity.isPickup&&(pickupFound=!0,src_player.fireEvent("pick-up",entity),addLog("You pick up a ".concat(entity.description.name)),entity.has(Dropped)&&entity.remove(entity.dropped))})),pickupFound||addLog("There is nothing to pick up here")}"i"===userInput&&(gameState="INVENTORY"),"z"===userInput&&(gameState="TARGETING"),userInput=null}if("TARGETING"===gameState&&("z"!==userInput&&"Escape"!==userInput||(src_player.remove(src_player.targetingItem),gameState="GAME"),userInput=null),"INVENTORY"===gameState){if("i"!==userInput&&"Escape"!==userInput||(gameState="GAME"),"ArrowUp"===userInput&&(selectedInventoryIndex-=1)<0&&(selectedInventoryIndex=0),"ArrowDown"===userInput&&(selectedInventoryIndex+=1)>src_player.inventory.inventoryItems.length-1&&(selectedInventoryIndex=src_player.inventory.inventoryItems.length-1),"c"===userInput){var entity=src_player.inventory.inventoryItems[selectedInventoryIndex];if(entity)if(entity.requiresTarget){if(targetRange=entity.requiresTarget.aoeRange||1,"RANDOM"===entity.requiresTarget.acquired){var target=sample_default()(src_toConsumableArray(enemiesInFOV.get()));target?(src_player.add(Targeting_TargetingItem,{itemId:entity.id}),src_player.add(Target,{locId:toLocId(target.position)}),targeting_targeting(src_player)):(addLog("The scroll disintegrates uselessly in your hand"),src_player.fireEvent("consume",entity))}else if("MANUAL"===entity.requiresTarget.acquired)return src_player.add(Targeting_TargetingItem,{itemId:entity.id}),void(gameState="TARGETING")}else entity.has(Effects)?(entity.effects.forEach((function(x){return src_player.add(ActiveEffects,function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?src_ownKeys(Object(source),!0).forEach((function(key){src_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):src_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},x.serialize()))})),addLog("You consume a ".concat(entity.description.name)),src_player.fireEvent("consume",entity)):addLog("You can't consume ".concat(entity.description.name));selectedInventoryIndex=0,gameState="GAME"}if("d"===userInput&&src_player.inventory.inventoryItems.length){var _entity=src_player.inventory.inventoryItems[selectedInventoryIndex];addLog("You drop a ".concat(_entity.description.name)),_entity.add(Dropped),src_player.fireEvent("drop",_entity),_entity.has(IsEquipped)&&equip_unequipItem(_entity,src_player)}if("e"===userInput){var _entity2=src_player.inventory.inventoryItems[selectedInventoryIndex];_entity2&&(_entity2.isEquippable&&(_entity2.has(IsEquipped)?equip_unequipItem(_entity2,src_player):function(entity,player){var _player$equipmentSlot;if(null!==(_player$equipmentSlot=player.equipmentSlot)&&void 0!==_player$equipmentSlot&&_player$equipmentSlot[entity.slot.name]){var _player$equipmentSlot2,previousEquipped=state_ecs.getEntity(null===(_player$equipmentSlot2=player.equipmentSlot)||void 0===_player$equipmentSlot2?void 0:_player$equipmentSlot2[entity.slot.name].itemId);previousEquipped.remove(previousEquipped.isEquipped),player.fireEvent("unequip",previousEquipped),player.remove(player.equipmentSlot[previousEquipped.slot.name]),addLog("You unequip ".concat(previousEquipped.description.name))}player.add(EquipmentSlot,{name:entity.slot.name,itemId:entity.id}),entity.add(IsEquipped),player.fireEvent("equip",entity),addLog("You equip ".concat(entity.description.name))}(_entity2,src_player)),selectedInventoryIndex=0,gameState="GAME")}userInput=null}},src_update=function(){if(animation_animation(),src_player.isDead)return"GAMEOVER"!==gameState&&(addLog("You are dead."),render_render(src_player)),gameState="GAMEOVER",void src_processUserInput();var player;playerTurn&&userInput&&"TARGETING"===gameState&&(src_processUserInput(),effects_effects(),render_render(src_player),playerTurn=!0),playerTurn&&userInput&&"INVENTORY"===gameState&&(src_processUserInput(),effects_effects(),render_render(src_player),playerTurn=!0),playerTurn&&userInput&&"GAME"===gameState&&(src_processUserInput(),effects_effects(),movement_movement(),fov_fov(src_player),render_render(src_player),playerTurn=!1),playerTurn||(player=src_player,aiEntities.get().forEach((function(entity){entity.has(IsInFov)&&ai_moveToTarget(entity,player)})),effects_effects(),movement_movement(),fov_fov(src_player),render_render(src_player),playerTurn=!0)};requestAnimationFrame((function gameLoop(){src_update(),requestAnimationFrame(gameLoop)})),document.querySelector("#canvas").onclick=function(e){var _pxToCell2=src_slicedToArray(pxToCell(e),2),x=_pxToCell2[0],y=_pxToCell2[1],locId=toLocId({x:x,y:y,z:cache_readCache("z")});readCacheSet("entitiesAtLocation",locId)&&readCacheSet("entitiesAtLocation",locId).forEach((function(eId){state_ecs.getEntity(eId);if("TARGETING"===gameState){var _entity3=src_player.inventory.inventoryItems[selectedInventoryIndex];if(_entity3.requiresTarget.aoeRange)circle({x:x,y:y},_entity3.requiresTarget.aoeRange).map((function(locId){return"".concat(locId,",").concat(cache_readCache("z"))})).forEach((function(locId){return src_player.add(Target,{locId:locId})}));else src_player.add(Target,{locId:locId});gameState="GAME",targeting_targeting(src_player),effects_effects(),render_render(src_player)}}))}}]);
//# sourceMappingURL=main.baaa28a6d6b89406cbe3.js.map