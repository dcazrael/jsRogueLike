{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/pathfinding/src/core/DiagonalMovement.js","webpack:///./node_modules/lodash/isArray.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./node_modules/lodash/times.js","webpack:///./node_modules/lodash/_getNative.js","webpack:///./node_modules/pathfinding/src/core/Util.js","webpack:///./node_modules/lodash/sample.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/_toKey.js","webpack:///./node_modules/pathfinding/src/core/Heuristic.js","webpack:///./node_modules/lodash/random.js","webpack:///./node_modules/lodash/isSymbol.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/lodash/_nativeCreate.js","webpack:///./node_modules/lodash/_ListCache.js","webpack:///./node_modules/lodash/_assocIndexOf.js","webpack:///./node_modules/lodash/eq.js","webpack:///./node_modules/lodash/_getMapData.js","webpack:///./node_modules/lodash/keys.js","webpack:///./node_modules/lodash/_isIndex.js","webpack:///./node_modules/heap/index.js","webpack:///./node_modules/pathfinding/src/finders/JumpPointFinderBase.js","webpack:///./node_modules/lodash/get.js","webpack:///./node_modules/lodash/_castPath.js","webpack:///./node_modules/lodash/_isKey.js","webpack:///./node_modules/lodash/_MapCache.js","webpack:///./node_modules/lodash/_Map.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/lodash/isLength.js","webpack:///./node_modules/lodash/isArrayLike.js","webpack:///./node_modules/pathfinding/src/core/Node.js","webpack:///./node_modules/pathfinding/src/finders/AStarFinder.js","webpack:///./node_modules/pathfinding/src/finders/BiAStarFinder.js","webpack:///./node_modules/pathfinding/index.js","webpack:///./node_modules/lodash/_baseGet.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/lodash/isFunction.js","webpack:///./node_modules/lodash/_toSource.js","webpack:///./node_modules/lodash/_arrayMap.js","webpack:///./node_modules/lodash/_arraySample.js","webpack:///./node_modules/lodash/_baseRandom.js","webpack:///./node_modules/lodash/_baseTimes.js","webpack:///./node_modules/lodash/isArguments.js","webpack:///./node_modules/lodash/isBuffer.js","webpack:///./node_modules/lodash/isTypedArray.js","webpack:///./node_modules/lodash/_isIterateeCall.js","webpack:///./node_modules/lodash/toFinite.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/lodash/identity.js","webpack:///./node_modules/lodash/_arraySome.js","webpack:///./node_modules/lodash/_Stack.js","webpack:///./node_modules/lodash/_baseIsEqual.js","webpack:///./node_modules/lodash/_equalArrays.js","webpack:///./node_modules/lodash/_isStrictComparable.js","webpack:///./node_modules/lodash/_matchesStrictComparable.js","webpack:///./node_modules/lodash/set.js","webpack:///./node_modules/lodash/some.js","webpack:///./node_modules/lodash/last.js","webpack:///./node_modules/lodash/throttle.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/_stringToPath.js","webpack:///./node_modules/lodash/_memoizeCapped.js","webpack:///./node_modules/lodash/memoize.js","webpack:///./node_modules/lodash/_mapCacheClear.js","webpack:///./node_modules/lodash/_Hash.js","webpack:///./node_modules/lodash/_hashClear.js","webpack:///./node_modules/lodash/_baseIsNative.js","webpack:///./node_modules/lodash/_isMasked.js","webpack:///./node_modules/lodash/_coreJsData.js","webpack:///./node_modules/lodash/_getValue.js","webpack:///./node_modules/lodash/_hashDelete.js","webpack:///./node_modules/lodash/_hashGet.js","webpack:///./node_modules/lodash/_hashHas.js","webpack:///./node_modules/lodash/_hashSet.js","webpack:///./node_modules/lodash/_listCacheClear.js","webpack:///./node_modules/lodash/_listCacheDelete.js","webpack:///./node_modules/lodash/_listCacheGet.js","webpack:///./node_modules/lodash/_listCacheHas.js","webpack:///./node_modules/lodash/_listCacheSet.js","webpack:///./node_modules/lodash/_mapCacheDelete.js","webpack:///./node_modules/lodash/_isKeyable.js","webpack:///./node_modules/lodash/_mapCacheGet.js","webpack:///./node_modules/lodash/_mapCacheHas.js","webpack:///./node_modules/lodash/_mapCacheSet.js","webpack:///./node_modules/lodash/toString.js","webpack:///./node_modules/lodash/_baseToString.js","webpack:///./node_modules/lodash/_baseSample.js","webpack:///./node_modules/lodash/values.js","webpack:///./node_modules/lodash/_baseValues.js","webpack:///./node_modules/lodash/_arrayLikeKeys.js","webpack:///./node_modules/lodash/_baseIsArguments.js","webpack:///./node_modules/lodash/stubFalse.js","webpack:///./node_modules/lodash/_baseIsTypedArray.js","webpack:///./node_modules/lodash/_baseUnary.js","webpack:///./node_modules/lodash/_nodeUtil.js","webpack:///./node_modules/lodash/_baseKeys.js","webpack:///./node_modules/lodash/_isPrototype.js","webpack:///./node_modules/lodash/_nativeKeys.js","webpack:///./node_modules/lodash/_overArg.js","webpack:///./node_modules/lodash/_baseTrim.js","webpack:///./node_modules/lodash/_trimmedEndIndex.js","webpack:///./node_modules/lodash/_castFunction.js","webpack:///./node_modules/lodash/toInteger.js","webpack:///./node_modules/lodash/_baseSet.js","webpack:///./node_modules/lodash/_assignValue.js","webpack:///./node_modules/lodash/_baseAssignValue.js","webpack:///./node_modules/lodash/_defineProperty.js","webpack:///./node_modules/lodash/_baseIteratee.js","webpack:///./node_modules/lodash/_baseMatches.js","webpack:///./node_modules/lodash/_baseIsMatch.js","webpack:///./node_modules/lodash/_stackClear.js","webpack:///./node_modules/lodash/_stackDelete.js","webpack:///./node_modules/lodash/_stackGet.js","webpack:///./node_modules/lodash/_stackHas.js","webpack:///./node_modules/lodash/_stackSet.js","webpack:///./node_modules/lodash/_baseIsEqualDeep.js","webpack:///./node_modules/lodash/_SetCache.js","webpack:///./node_modules/lodash/_setCacheAdd.js","webpack:///./node_modules/lodash/_setCacheHas.js","webpack:///./node_modules/lodash/_cacheHas.js","webpack:///./node_modules/lodash/_equalByTag.js","webpack:///./node_modules/lodash/_Uint8Array.js","webpack:///./node_modules/lodash/_mapToArray.js","webpack:///./node_modules/lodash/_setToArray.js","webpack:///./node_modules/lodash/_equalObjects.js","webpack:///./node_modules/lodash/_getAllKeys.js","webpack:///./node_modules/lodash/_baseGetAllKeys.js","webpack:///./node_modules/lodash/_arrayPush.js","webpack:///./node_modules/lodash/_getSymbols.js","webpack:///./node_modules/lodash/_arrayFilter.js","webpack:///./node_modules/lodash/stubArray.js","webpack:///./node_modules/lodash/_getTag.js","webpack:///./node_modules/lodash/_DataView.js","webpack:///./node_modules/lodash/_Promise.js","webpack:///./node_modules/lodash/_Set.js","webpack:///./node_modules/lodash/_WeakMap.js","webpack:///./node_modules/lodash/_getMatchData.js","webpack:///./node_modules/lodash/_baseMatchesProperty.js","webpack:///./node_modules/lodash/hasIn.js","webpack:///./node_modules/lodash/_baseHasIn.js","webpack:///./node_modules/lodash/_hasPath.js","webpack:///./node_modules/lodash/property.js","webpack:///./node_modules/lodash/_baseProperty.js","webpack:///./node_modules/lodash/_basePropertyDeep.js","webpack:///./node_modules/lodash/_baseSome.js","webpack:///./node_modules/lodash/_baseEach.js","webpack:///./node_modules/lodash/_baseForOwn.js","webpack:///./node_modules/lodash/_baseFor.js","webpack:///./node_modules/lodash/_createBaseFor.js","webpack:///./node_modules/lodash/_createBaseEach.js","webpack:///./node_modules/pathfinding/src/PathFinding.js","webpack:///./node_modules/heap/lib/heap.js","webpack:///./node_modules/pathfinding/src/core/Grid.js","webpack:///./node_modules/pathfinding/src/finders/BestFirstFinder.js","webpack:///./node_modules/pathfinding/src/finders/BreadthFirstFinder.js","webpack:///./node_modules/pathfinding/src/finders/DijkstraFinder.js","webpack:///./node_modules/pathfinding/src/finders/BiBestFirstFinder.js","webpack:///./node_modules/pathfinding/src/finders/BiBreadthFirstFinder.js","webpack:///./node_modules/pathfinding/src/finders/BiDijkstraFinder.js","webpack:///./node_modules/pathfinding/src/finders/IDAStarFinder.js","webpack:///./node_modules/pathfinding/src/finders/JumpPointFinder.js","webpack:///./node_modules/pathfinding/src/finders/JPFNeverMoveDiagonally.js","webpack:///./node_modules/pathfinding/src/finders/JPFAlwaysMoveDiagonally.js","webpack:///./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfNoObstacles.js","webpack:///./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfAtMostOneObstacle.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/now.js","webpack:///./src/images/favicon.png","webpack:///./src/lib/grid.js","webpack:///./src/lib/canvas.js","webpack:///./src/state/cache.js","webpack:///../node_modules/camelcase/index.js","webpack:///../src/util/string-util.js","webpack:///../src/ComponentRegistry.js","webpack:///../node_modules/deepmerge/dist/cjs.js","webpack:///../src/PrefabComponent.js","webpack:///../src/Prefab.js","webpack:///../src/PrefabRegistry.js","webpack:///../src/Component.js","webpack:///../src/EntityEvent.js","webpack:///../src/util/bit-util.js","webpack:///../src/Entity.js","webpack:///../src/Query.js","webpack:///../src/World.js","webpack:///../src/Engine.js","webpack:///./src/state/components/Ai.js","webpack:///./src/state/components/Animation.js","webpack:///./src/state/components/Layers.js","webpack:///./src/state/components/Status.js","webpack:///./src/state/components/Attributes.js","webpack:///./src/state/components/Effects.js","webpack:///./src/state/components/Equipment.js","webpack:///./src/state/components/Position.js","webpack:///./src/state/components/Inventory.js","webpack:///./src/utils/ecs-refs.js","webpack:///./src/state/components/Misc.js","webpack:///./src/state/components/Move.js","webpack:///./src/state/components/StatusEffects.js","webpack:///./src/state/components/Targeting.js","webpack:///./src/state/prefabs.js","webpack:///./src/state/ecs.js","webpack:///./src/systems/affix.js","webpack:///./src/utils/misc.js","webpack:///./src/lib/dungeon_layout.js","webpack:///./src/lib/level_entities.js","webpack:///./src/lib/dungeon.js","webpack:///./src/lib/pathfinding.js","webpack:///./src/systems/ai.js","webpack:///./src/systems/animation.js","webpack:///./src/systems/effects.js","webpack:///./src/systems/equip.js","webpack:///./src/lib/fov.js","webpack:///./src/systems/fov.js","webpack:///./src/systems/movement.js","webpack:///./src/lib/equipment.js","webpack:///./src/systems/render.js","webpack:///./src/systems/targeting.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Always","Never","IfAtMostOneObstacle","OnlyWhenNoObstacles","isArray","Array","freeGlobal","require","freeSelf","self","root","Function","type","baseTimes","castFunction","toInteger","nativeMin","Math","min","iteratee","index","length","result","baseIsNative","getValue","undefined","backtrace","node","path","x","y","parent","push","reverse","interpolate","x0","y0","x1","y1","sx","sy","dx","dy","err","e2","abs","line","biBacktrace","nodeA","nodeB","pathA","pathB","concat","pathLength","a","b","sum","sqrt","expandPath","coord0","coord1","interpolated","interpolatedLen","j","expanded","len","smoothenPath","grid","newPath","coord","testCoord","blocked","isWalkableAt","lastValidCoord","compressPath","lx","ly","ldx","ldy","sq","compressed","px","py","arraySample","baseSample","collection","getRawTag","objectToString","symToStringTag","isSymbol","manhattan","euclidean","octile","F","SQRT2","chebyshev","max","baseRandom","isIterateeCall","toFinite","freeParseFloat","parseFloat","nativeRandom","random","lower","upper","floating","temp","rand","baseGetTag","isObjectLike","nativeCreate","getNative","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","ListCache","entries","this","clear","entry","set","has","eq","array","other","isKeyable","map","data","__data__","arrayLikeKeys","baseKeys","isArrayLike","reIsUint","test","Heap","Util","Heuristic","JumpPointFinderBase","opt","heuristic","trackJumpRecursion","findPath","startX","startY","endX","endY","openList","f","startNode","getNodeAt","endNode","g","opened","empty","pop","closed","_identifySuccessors","neighbors","neighbor","jumpPoint","jx","jy","ng","jumpNode","_findNeighbors","_jump","h","updateItem","baseGet","defaultValue","isKey","stringToPath","toString","reIsDeepProp","reIsPlainProp","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","MapCache","Map","webpackPolyfill","deprecate","paths","children","isFunction","isLength","walkable","DiagonalMovement","AStarFinder","allowDiagonal","dontCrossCorners","weight","diagonalMovement","getNeighbors","BiAStarFinder","cmp","startOpenList","endOpenList","castPath","toKey","global","isObject","tag","funcToString","func","e","nativeFloor","floor","baseIsArguments","objectProto","propertyIsEnumerable","isArguments","arguments","stubFalse","freeExports","nodeType","freeModule","Buffer","isBuffer","baseIsTypedArray","baseUnary","nodeUtil","nodeIsTypedArray","isTypedArray","isIndex","toNumber","baseTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","valueOf","isBinary","slice","predicate","stackClear","stackDelete","stackGet","stackHas","stackSet","Stack","size","baseIsEqualDeep","baseIsEqual","bitmask","customizer","stack","SetCache","arraySome","cacheHas","equalFunc","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","srcValue","baseSet","baseIteratee","baseSome","guard","debounce","wait","options","leading","trailing","TypeError","window","nativeObjectToString","isOwn","unmasked","memoizeCapped","rePropName","reEscapeChar","string","charCodeAt","replace","match","number","quote","subString","memoize","cache","resolver","memoized","args","apply","Cache","Hash","hashClear","hashDelete","hashGet","hashHas","hashSet","isMasked","toSource","reIsHostCtor","funcProto","reIsNative","RegExp","uid","coreJsData","maskSrcKey","exec","keys","IE_PROTO","assocIndexOf","splice","getMapData","baseToString","arrayMap","symbolProto","symbolToString","values","baseValues","props","inherited","isArr","isArg","isBuff","isType","skipIndexes","String","typedArrayTags","freeProcess","process","types","binding","isPrototype","nativeKeys","Ctor","constructor","overArg","transform","arg","trimmedEndIndex","reTrimStart","reWhitespace","charAt","identity","remainder","assignValue","lastIndex","nested","newValue","objValue","baseAssignValue","baseMatches","baseMatchesProperty","baseIsMatch","getMatchData","matchesStrictComparable","source","matchData","noCustomizer","COMPARE_PARTIAL_FLAG","pairs","LARGE_ARRAY_SIZE","equalArrays","equalByTag","equalObjects","getTag","objectTag","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","setCacheAdd","setCacheHas","add","Uint8Array","mapToArray","setToArray","symbolValueOf","byteLength","byteOffset","buffer","message","convert","stacked","forEach","getAllKeys","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","baseGetAllKeys","getSymbols","arrayPush","keysFunc","symbolsFunc","offset","arrayFilter","stubArray","nativeGetSymbols","getOwnPropertySymbols","symbol","resIndex","DataView","Promise","Set","WeakMap","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ArrayBuffer","resolve","ctorString","isStrictComparable","hasIn","baseHasIn","hasPath","hasFunc","baseProperty","basePropertyDeep","baseEach","baseForOwn","createBaseEach","baseFor","createBaseFor","fromRight","iterable","eachFunc","defaultCmp","heapify","heappop","heappush","heappushpop","heapreplace","insort","nlargest","nsmallest","_siftdown","_siftup","lo","hi","mid","Error","item","lastelt","returnitem","_ref","_i","_len","_ref1","_results","_results1","_j","pos","indexOf","elem","sort","los","startpos","newitem","parentpos","childpos","endpos","rightpos","nodes","pushpop","peek","contains","clone","heap","toArray","insert","top","front","copy","Node","Grid","width_or_matrix","height","matrix","width","_buildNodes","isInside","setWalkableAt","s0","d0","s1","d1","s2","d2","s3","d3","thisNodes","newGrid","newNodes","BestFirstFinder","orig","BreadthFirstFinder","shift","DijkstraFinder","BiBestFirstFinder","BiBreadthFirstFinder","by","BiDijkstraFinder","IDAStarFinder","trackRecursion","timeLimit","Infinity","route","startTime","Date","getTime","search","cutoff","depth","k","neighbour","end","neighbours","retainCount","tested","start","cutOff","JPFNeverMoveDiagonally","JPFAlwaysMoveDiagonally","JPFMoveDiagonallyIfNoObstacles","JPFMoveDiagonallyIfAtMostOneObstacle","neighborNodes","neighborNode","isNextWalkable","isTopWalkable","isBottomWalkable","isRightWalkable","isLeftWalkable","now","nativeMax","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","maxing","invokeFunc","time","thisArg","leadingEdge","setTimeout","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","clearTimeout","cancel","flush","CARDINAL","DIAGONAL","toCell","cellOrId","cell","idToCell","toLocId","locId","cellToId","insideCircle","center","tile","radius","circle","bottom","left","right","locsIds","cx","ceil","cy","rectangle","tileProps","z","hasWalls","tiles","x2","y2","yi","xi","round","id","coords","split","pixelRatio","devicePixelRatio","canvas","document","querySelector","ctx","getContext","messageLog","playerHud","playerEquipment","head","weapon","chest","shield","legs","equipmentInfo","infoBar","inventory","menu","calculatedFontSize","innerWidth","cellWidth","cellHeight","fontSize","style","cssText","font","textAlign","textBaseline","clearCanvas","w","posX","posY","clearRect","drawBackground","color","position","fillStyle","fillRect","drawChar","char","fillText","drawCell","entity","appearance","background","drawText","template","text","character","pxToCell","ev","bounds","getBoundingClientRect","relativeX","clientX","relativeY","clientY","trunc","entitiesAtLocation","floors","addCache","readCache","readCacheSet","clearCache","camelCase","input","pascalCase","isLastCharLower","isLastCharUpper","isLastLastCharUpper","preserveCamelCase","p1","camelCache","camelString","camelcaseSlow","register","clazz","BigInt","_map","isMergeableObject","isNonNullObject","stringValue","isReactElement","isSpecial","REACT_ELEMENT_TYPE","cloneUnlessOtherwiseSpecified","deepmerge","val","defaultArrayMerge","target","element","getKeys","getEnumerableOwnPropertySymbols","propertyIsOnObject","mergeObject","destination","propertyIsUnsafe","customMerge","getMergeFunction","sourceIsArray","prev","next","properties","overwrite","applyToEntity","initialProps","comp","merge","addComponent","prefabProps","arrComps","component","ckey","initialCompProps","deserialize","registered","prefab","Prefab","inherit","ref","console","comps","componentData","PrefabComponent","_prefabs","world","destroy","_onDestroyed","_onEvent","evt","_onAttached","serialize","ob","onAttached","onDestroyed","onEvent","Component","is","handle","prevent","ONE","subtractBit","num","bit","addBit","bitIntersection","n1","n2","serializeComponent","serializeComponentKeyed","ser","_candidacy","attachComponentKeyed","attachComponentArray","attachComponent","remove","keyProp","removeComponentKeyed","idx","removeComponentArray","removeComponent","v","components","arr","fireEvent","EntityEvent","any","filters","all","none","onEntityAdded","onEntityRemoved","_cache","matches","bits","_any","candidate","isTracking","cb","refresh","createId","getEntity","_entities","getEntities","createEntity","Entity","destroyEntity","destroyEntities","createQuery","query","Query","createPrefab","engine","json","entities","list","entityData","_createOrGetEntityById","_deserializeEntity","def","_candidate","q","_destroyed","PrefabRegistry","registerComponent","registerPrefab","createWorld","World","destroyWorld","Ai","Animate","duration","Layer100","Layer300","Layer400","Dropped","IsBlocking","IsDead","IsEquippable","IsEquipped","IsInFov","IsOpaque","IsPickup","IsRevealed","IsStairs","Defense","base","current","Health","amount","ai","isBlocking","layer400","Power","effectProps","delta","animate","events","addComponents","ActiveEffects","Effects","Slot","EquipmentEffect","EquipmentSlot","itemId","equipmentEffect","effect","Position","Inventory","idArrayProp","newIds","targetEntity","idProp","getEntityArrayRef","inventoryItemIds","isPickup","filter","log","Description","Appearance","Move","relative","Frozen","Paralyzed","Poisoned","RequiresTarget","acquired","aoeRange","Target","TargetingItem","getEntityRef","setEntityRef","ecs","Engine","WEAPON_PREFIXES","glinting","polished","tempered","ARMOR_PREFIXES","healthy","stalwart","virile","ARMOR_SUFFIXES","laquered","fortified","plated","getHighestMatch","needle","highest_match","DUNGEON_LAYOUT","1","maxRoomCount","5","9","14","19","MAX_ITEMS_BY_FLOOR","ITEM_WEIGHT","0","2","4","6","MAX_MONSTERS_BY_FLOOR","MONSTER_WEIGHT","3","7","digHorizontalPassage","sprite","digVerticalPassage","createDungeon","minRoomSize","maxRoomSize","dungeon","rooms","roomTiles","times","rw","rh","rx","ry","some","room","rect2","rect1","passageTiles","prevRoom","curr","getOpenTiles","openTiles","sample","createDungeonLevel","stairsUp","stairsDown","createStairsUp","createStairsDown","currentLevel","dimensions","generateEntities","generateAffixes","level","maxEntitiesByFloor","entityWeight","getEntitiesAtRandom","weightedChances","amountOfEntities","entityWeightedChances","getEntityChancesForLevel","total","part","getWeightedValue","slot","addAffix","affixes","getWeightedNumber","affix","description","isAffix","rng","baseMatrix","fill","aiEntities","moveToTarget","goal","JSON","parse","stringify","eId","PF","aStar","newLoc","animatingEntities","animation","gameState","hex","last","frameTime","framePercent","classes","activeEffectsEntities","effects","activeEffects","event","toLowerCase","unequipItem","player","isEquipped","equipmentSlot","addLog","octantTransforms","xx","xy","yx","yy","createFOV","opaqueEntities","originX","originY","originZ","visible","blockingLocations","isOpaque","reveal","castShadows","row","newStart","distance","deltaY","deltaX","currentX","currentY","leftSlope","rightSlope","octant","fov","reduce","acc","cell1","cell2","pow","inFovEntities","origin","FOV","isInFov","entitiesAtLoc","movableEntities","movement","mx","move","my","mz","blockers","damage","power","defense","health","attack","Sword","Helmet","Legs","Chest","Shield","layer100Entities","layer300Entities","layer400Entities","renderMap","renderPlayerHud","goodHealth","renderPlayerEquipment","image","img","Image","coloredImage","src","encodeURIComponent","onload","drawImage","clearEquipmentInfo","hoverEquipment","renderEquipmentInfo","renderMessageLog","clearInfoBar","repeat","renderInventory","rect","inventoryItems","selectedInventoryIndex","renderTargeting","mPos","isRevealed","targetRange","drawCircle","render","onmousemove","throttle","isPlural","entityText","renderInfoBar","targetingEntities","targeting","targetingItem","getElementById","favicon","createElement","rel","href","Favicon","appendChild","unshift","loadGame","localStorage","getItem","deserializeCache","playerId","userInput","playerTurn","enemiesInFOV","goToDungeonLevel","goingUp","deadEntity","newPosition","initGame","playerSpawn","addEventListener","processUserInput","gameSaveData","newGame","setItem","pickupFound","dropped","requiresTarget","isEquippable","previousEquipped","equipItem","update","isDead","requestAnimationFrame","gameLoop","onclick"],"mappings":"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","file":"main.baaa28a6d6b89406cbe3.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 171);\n","var DiagonalMovement = {\r\n    Always: 1,\r\n    Never: 2,\r\n    IfAtMostOneObstacle: 3,\r\n    OnlyWhenNoObstacles: 4\r\n};\r\n\r\nmodule.exports = DiagonalMovement;","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var baseTimes = require('./_baseTimes'),\n    castFunction = require('./_castFunction'),\n    toInteger = require('./toInteger');\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used as references for the maximum length and index of an array. */\nvar MAX_ARRAY_LENGTH = 4294967295;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Invokes the iteratee `n` times, returning an array of the results of\n * each invocation. The iteratee is invoked with one argument; (index).\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n * @example\n *\n * _.times(3, String);\n * // => ['0', '1', '2']\n *\n *  _.times(4, _.constant(0));\n * // => [0, 0, 0, 0]\n */\nfunction times(n, iteratee) {\n  n = toInteger(n);\n  if (n < 1 || n > MAX_SAFE_INTEGER) {\n    return [];\n  }\n  var index = MAX_ARRAY_LENGTH,\n      length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n  iteratee = castFunction(iteratee);\n  n -= MAX_ARRAY_LENGTH;\n\n  var result = baseTimes(length, iteratee);\n  while (++index < n) {\n    iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = times;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","/**\r\n * Backtrace according to the parent records and return the path.\r\n * (including both start and end nodes)\r\n * @param {Node} node End node\r\n * @return {Array<Array<number>>} the path\r\n */\r\nfunction backtrace(node) {\r\n    var path = [[node.x, node.y]];\r\n    while (node.parent) {\r\n        node = node.parent;\r\n        path.push([node.x, node.y]);\r\n    }\r\n    return path.reverse();\r\n}\r\nexports.backtrace = backtrace;\r\n\r\n/**\r\n * Backtrace from start and end node, and return the path.\r\n * (including both start and end nodes)\r\n * @param {Node}\r\n * @param {Node}\r\n */\r\nfunction biBacktrace(nodeA, nodeB) {\r\n    var pathA = backtrace(nodeA),\r\n        pathB = backtrace(nodeB);\r\n    return pathA.concat(pathB.reverse());\r\n}\r\nexports.biBacktrace = biBacktrace;\r\n\r\n/**\r\n * Compute the length of the path.\r\n * @param {Array<Array<number>>} path The path\r\n * @return {number} The length of the path\r\n */\r\nfunction pathLength(path) {\r\n    var i, sum = 0, a, b, dx, dy;\r\n    for (i = 1; i < path.length; ++i) {\r\n        a = path[i - 1];\r\n        b = path[i];\r\n        dx = a[0] - b[0];\r\n        dy = a[1] - b[1];\r\n        sum += Math.sqrt(dx * dx + dy * dy);\r\n    }\r\n    return sum;\r\n}\r\nexports.pathLength = pathLength;\r\n\r\n\r\n/**\r\n * Given the start and end coordinates, return all the coordinates lying\r\n * on the line formed by these coordinates, based on Bresenham's algorithm.\r\n * http://en.wikipedia.org/wiki/Bresenham's_line_algorithm#Simplification\r\n * @param {number} x0 Start x coordinate\r\n * @param {number} y0 Start y coordinate\r\n * @param {number} x1 End x coordinate\r\n * @param {number} y1 End y coordinate\r\n * @return {Array<Array<number>>} The coordinates on the line\r\n */\r\nfunction interpolate(x0, y0, x1, y1) {\r\n    var abs = Math.abs,\r\n        line = [],\r\n        sx, sy, dx, dy, err, e2;\r\n\r\n    dx = abs(x1 - x0);\r\n    dy = abs(y1 - y0);\r\n\r\n    sx = (x0 < x1) ? 1 : -1;\r\n    sy = (y0 < y1) ? 1 : -1;\r\n\r\n    err = dx - dy;\r\n\r\n    while (true) {\r\n        line.push([x0, y0]);\r\n\r\n        if (x0 === x1 && y0 === y1) {\r\n            break;\r\n        }\r\n        \r\n        e2 = 2 * err;\r\n        if (e2 > -dy) {\r\n            err = err - dy;\r\n            x0 = x0 + sx;\r\n        }\r\n        if (e2 < dx) {\r\n            err = err + dx;\r\n            y0 = y0 + sy;\r\n        }\r\n    }\r\n\r\n    return line;\r\n}\r\nexports.interpolate = interpolate;\r\n\r\n\r\n/**\r\n * Given a compressed path, return a new path that has all the segments\r\n * in it interpolated.\r\n * @param {Array<Array<number>>} path The path\r\n * @return {Array<Array<number>>} expanded path\r\n */\r\nfunction expandPath(path) {\r\n    var expanded = [],\r\n        len = path.length,\r\n        coord0, coord1,\r\n        interpolated,\r\n        interpolatedLen,\r\n        i, j;\r\n\r\n    if (len < 2) {\r\n        return expanded;\r\n    }\r\n\r\n    for (i = 0; i < len - 1; ++i) {\r\n        coord0 = path[i];\r\n        coord1 = path[i + 1];\r\n\r\n        interpolated = interpolate(coord0[0], coord0[1], coord1[0], coord1[1]);\r\n        interpolatedLen = interpolated.length;\r\n        for (j = 0; j < interpolatedLen - 1; ++j) {\r\n            expanded.push(interpolated[j]);\r\n        }\r\n    }\r\n    expanded.push(path[len - 1]);\r\n\r\n    return expanded;\r\n}\r\nexports.expandPath = expandPath;\r\n\r\n\r\n/**\r\n * Smoothen the give path.\r\n * The original path will not be modified; a new path will be returned.\r\n * @param {PF.Grid} grid\r\n * @param {Array<Array<number>>} path The path\r\n */\r\nfunction smoothenPath(grid, path) {\r\n    var len = path.length,\r\n        x0 = path[0][0],        // path start x\r\n        y0 = path[0][1],        // path start y\r\n        x1 = path[len - 1][0],  // path end x\r\n        y1 = path[len - 1][1],  // path end y\r\n        sx, sy,                 // current start coordinate\r\n        ex, ey,                 // current end coordinate\r\n        newPath,\r\n        i, j, coord, line, testCoord, blocked;\r\n\r\n    sx = x0;\r\n    sy = y0;\r\n    newPath = [[sx, sy]];\r\n\r\n    for (i = 2; i < len; ++i) {\r\n        coord = path[i];\r\n        ex = coord[0];\r\n        ey = coord[1];\r\n        line = interpolate(sx, sy, ex, ey);\r\n\r\n        blocked = false;\r\n        for (j = 1; j < line.length; ++j) {\r\n            testCoord = line[j];\r\n\r\n            if (!grid.isWalkableAt(testCoord[0], testCoord[1])) {\r\n                blocked = true;\r\n                break;\r\n            }\r\n        }\r\n        if (blocked) {\r\n            lastValidCoord = path[i - 1];\r\n            newPath.push(lastValidCoord);\r\n            sx = lastValidCoord[0];\r\n            sy = lastValidCoord[1];\r\n        }\r\n    }\r\n    newPath.push([x1, y1]);\r\n\r\n    return newPath;\r\n}\r\nexports.smoothenPath = smoothenPath;\r\n\r\n\r\n/**\r\n * Compress a path, remove redundant nodes without altering the shape\r\n * The original path is not modified\r\n * @param {Array<Array<number>>} path The path\r\n * @return {Array<Array<number>>} The compressed path\r\n */\r\nfunction compressPath(path) {\r\n\r\n    // nothing to compress\r\n    if(path.length < 3) {\r\n        return path;\r\n    }\r\n\r\n    var compressed = [],\r\n        sx = path[0][0], // start x\r\n        sy = path[0][1], // start y\r\n        px = path[1][0], // second point x\r\n        py = path[1][1], // second point y\r\n        dx = px - sx, // direction between the two points\r\n        dy = py - sy, // direction between the two points\r\n        lx, ly,\r\n        ldx, ldy,\r\n        sq, i;\r\n\r\n    // normalize the direction\r\n    sq = Math.sqrt(dx*dx + dy*dy);\r\n    dx /= sq;\r\n    dy /= sq;\r\n\r\n    // start the new path\r\n    compressed.push([sx,sy]);\r\n\r\n    for(i = 2; i < path.length; i++) {\r\n\r\n        // store the last point\r\n        lx = px;\r\n        ly = py;\r\n\r\n        // store the last direction\r\n        ldx = dx;\r\n        ldy = dy;\r\n\r\n        // next point\r\n        px = path[i][0];\r\n        py = path[i][1];\r\n\r\n        // next direction\r\n        dx = px - lx;\r\n        dy = py - ly;\r\n\r\n        // normalize\r\n        sq = Math.sqrt(dx*dx + dy*dy);\r\n        dx /= sq;\r\n        dy /= sq;\r\n\r\n        // if the direction has changed, store the point\r\n        if ( dx !== ldx || dy !== ldy ) {\r\n            compressed.push([lx,ly]);\r\n        }\r\n    }\r\n\r\n    // store the last point\r\n    compressed.push([px,py]);\r\n\r\n    return compressed;\r\n}\r\nexports.compressPath = compressPath;\r\n","var arraySample = require('./_arraySample'),\n    baseSample = require('./_baseSample'),\n    isArray = require('./isArray');\n\n/**\n * Gets a random element from `collection`.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to sample.\n * @returns {*} Returns the random element.\n * @example\n *\n * _.sample([1, 2, 3, 4]);\n * // => 2\n */\nfunction sample(collection) {\n  var func = isArray(collection) ? arraySample : baseSample;\n  return func(collection);\n}\n\nmodule.exports = sample;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/**\r\n * @namespace PF.Heuristic\r\n * @description A collection of heuristic functions.\r\n */\r\nmodule.exports = {\r\n\r\n  /**\r\n   * Manhattan distance.\r\n   * @param {number} dx - Difference in x.\r\n   * @param {number} dy - Difference in y.\r\n   * @return {number} dx + dy\r\n   */\r\n  manhattan: function(dx, dy) {\r\n      return dx + dy;\r\n  },\r\n\r\n  /**\r\n   * Euclidean distance.\r\n   * @param {number} dx - Difference in x.\r\n   * @param {number} dy - Difference in y.\r\n   * @return {number} sqrt(dx * dx + dy * dy)\r\n   */\r\n  euclidean: function(dx, dy) {\r\n      return Math.sqrt(dx * dx + dy * dy);\r\n  },\r\n\r\n  /**\r\n   * Octile distance.\r\n   * @param {number} dx - Difference in x.\r\n   * @param {number} dy - Difference in y.\r\n   * @return {number} sqrt(dx * dx + dy * dy) for grids\r\n   */\r\n  octile: function(dx, dy) {\r\n      var F = Math.SQRT2 - 1;\r\n      return (dx < dy) ? F * dx + dy : F * dy + dx;\r\n  },\r\n\r\n  /**\r\n   * Chebyshev distance.\r\n   * @param {number} dx - Difference in x.\r\n   * @param {number} dy - Difference in y.\r\n   * @return {number} max(dx, dy)\r\n   */\r\n  chebyshev: function(dx, dy) {\r\n      return Math.max(dx, dy);\r\n  }\r\n\r\n};\r\n","var baseRandom = require('./_baseRandom'),\n    isIterateeCall = require('./_isIterateeCall'),\n    toFinite = require('./toFinite');\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseFloat = parseFloat;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min,\n    nativeRandom = Math.random;\n\n/**\n * Produces a random number between the inclusive `lower` and `upper` bounds.\n * If only one argument is provided a number between `0` and the given number\n * is returned. If `floating` is `true`, or either `lower` or `upper` are\n * floats, a floating-point number is returned instead of an integer.\n *\n * **Note:** JavaScript follows the IEEE-754 standard for resolving\n * floating-point values which can produce unexpected results.\n *\n * @static\n * @memberOf _\n * @since 0.7.0\n * @category Number\n * @param {number} [lower=0] The lower bound.\n * @param {number} [upper=1] The upper bound.\n * @param {boolean} [floating] Specify returning a floating-point number.\n * @returns {number} Returns the random number.\n * @example\n *\n * _.random(0, 5);\n * // => an integer between 0 and 5\n *\n * _.random(5);\n * // => also an integer between 0 and 5\n *\n * _.random(5, true);\n * // => a floating-point number between 0 and 5\n *\n * _.random(1.2, 5.2);\n * // => a floating-point number between 1.2 and 5.2\n */\nfunction random(lower, upper, floating) {\n  if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n    upper = floating = undefined;\n  }\n  if (floating === undefined) {\n    if (typeof upper == 'boolean') {\n      floating = upper;\n      upper = undefined;\n    }\n    else if (typeof lower == 'boolean') {\n      floating = lower;\n      lower = undefined;\n    }\n  }\n  if (lower === undefined && upper === undefined) {\n    lower = 0;\n    upper = 1;\n  }\n  else {\n    lower = toFinite(lower);\n    if (upper === undefined) {\n      upper = lower;\n      lower = 0;\n    } else {\n      upper = toFinite(upper);\n    }\n  }\n  if (lower > upper) {\n    var temp = lower;\n    lower = upper;\n    upper = temp;\n  }\n  if (floating || lower % 1 || upper % 1) {\n    var rand = nativeRandom();\n    return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n  }\n  return baseRandom(lower, upper);\n}\n\nmodule.exports = random;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","module.exports = require('./lib/heap');\n","/**\r\n * @author imor / https://github.com/imor\r\n */\r\nvar Heap       = require('heap');\r\nvar Util       = require('../core/Util');\r\nvar Heuristic  = require('../core/Heuristic');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Base class for the Jump Point Search algorithm\r\n * @param {object} opt\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n */\r\nfunction JumpPointFinderBase(opt) {\r\n    opt = opt || {};\r\n    this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    this.trackJumpRecursion = opt.trackJumpRecursion || false;\r\n}\r\n\r\n/**\r\n * Find and return the path.\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nJumpPointFinderBase.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    var openList = this.openList = new Heap(function(nodeA, nodeB) {\r\n            return nodeA.f - nodeB.f;\r\n        }),\r\n        startNode = this.startNode = grid.getNodeAt(startX, startY),\r\n        endNode = this.endNode = grid.getNodeAt(endX, endY), node;\r\n\r\n    this.grid = grid;\r\n\r\n\r\n    // set the `g` and `f` value of the start node to be 0\r\n    startNode.g = 0;\r\n    startNode.f = 0;\r\n\r\n    // push the start node into the open list\r\n    openList.push(startNode);\r\n    startNode.opened = true;\r\n\r\n    // while the open list is not empty\r\n    while (!openList.empty()) {\r\n        // pop the position of node which has the minimum `f` value.\r\n        node = openList.pop();\r\n        node.closed = true;\r\n\r\n        if (node === endNode) {\r\n            return Util.expandPath(Util.backtrace(endNode));\r\n        }\r\n\r\n        this._identifySuccessors(node);\r\n    }\r\n\r\n    // fail to find the path\r\n    return [];\r\n};\r\n\r\n/**\r\n * Identify successors for the given node. Runs a jump point search in the\r\n * direction of each available neighbor, adding any points found to the open\r\n * list.\r\n * @protected\r\n */\r\nJumpPointFinderBase.prototype._identifySuccessors = function(node) {\r\n    var grid = this.grid,\r\n        heuristic = this.heuristic,\r\n        openList = this.openList,\r\n        endX = this.endNode.x,\r\n        endY = this.endNode.y,\r\n        neighbors, neighbor,\r\n        jumpPoint, i, l,\r\n        x = node.x, y = node.y,\r\n        jx, jy, dx, dy, d, ng, jumpNode,\r\n        abs = Math.abs, max = Math.max;\r\n\r\n    neighbors = this._findNeighbors(node);\r\n    for(i = 0, l = neighbors.length; i < l; ++i) {\r\n        neighbor = neighbors[i];\r\n        jumpPoint = this._jump(neighbor[0], neighbor[1], x, y);\r\n        if (jumpPoint) {\r\n\r\n            jx = jumpPoint[0];\r\n            jy = jumpPoint[1];\r\n            jumpNode = grid.getNodeAt(jx, jy);\r\n\r\n            if (jumpNode.closed) {\r\n                continue;\r\n            }\r\n\r\n            // include distance, as parent may not be immediately adjacent:\r\n            d = Heuristic.octile(abs(jx - x), abs(jy - y));\r\n            ng = node.g + d; // next `g` value\r\n\r\n            if (!jumpNode.opened || ng < jumpNode.g) {\r\n                jumpNode.g = ng;\r\n                jumpNode.h = jumpNode.h || heuristic(abs(jx - endX), abs(jy - endY));\r\n                jumpNode.f = jumpNode.g + jumpNode.h;\r\n                jumpNode.parent = node;\r\n\r\n                if (!jumpNode.opened) {\r\n                    openList.push(jumpNode);\r\n                    jumpNode.opened = true;\r\n                } else {\r\n                    openList.updateItem(jumpNode);\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = JumpPointFinderBase;\r\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/**\r\n * A node in grid. \r\n * This class holds some basic information about a node and custom \r\n * attributes may be added, depending on the algorithms' needs.\r\n * @constructor\r\n * @param {number} x - The x coordinate of the node on the grid.\r\n * @param {number} y - The y coordinate of the node on the grid.\r\n * @param {boolean} [walkable] - Whether this node is walkable.\r\n */\r\nfunction Node(x, y, walkable) {\r\n    /**\r\n     * The x coordinate of the node on the grid.\r\n     * @type number\r\n     */\r\n    this.x = x;\r\n    /**\r\n     * The y coordinate of the node on the grid.\r\n     * @type number\r\n     */\r\n    this.y = y;\r\n    /**\r\n     * Whether this node can be walked through.\r\n     * @type boolean\r\n     */\r\n    this.walkable = (walkable === undefined ? true : walkable);\r\n}\r\n\r\nmodule.exports = Node;\r\n","var Heap       = require('heap');\r\nvar Util       = require('../core/Util');\r\nvar Heuristic  = require('../core/Heuristic');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * A* path-finder. Based upon https://github.com/bgrins/javascript-astar\r\n * @constructor\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching \r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n * @param {number} opt.weight Weight to apply to the heuristic to allow for\r\n *     suboptimal paths, in order to speed up the search.\r\n */\r\nfunction AStarFinder(opt) {\r\n    opt = opt || {};\r\n    this.allowDiagonal = opt.allowDiagonal;\r\n    this.dontCrossCorners = opt.dontCrossCorners;\r\n    this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    this.weight = opt.weight || 1;\r\n    this.diagonalMovement = opt.diagonalMovement;\r\n\r\n    if (!this.diagonalMovement) {\r\n        if (!this.allowDiagonal) {\r\n            this.diagonalMovement = DiagonalMovement.Never;\r\n        } else {\r\n            if (this.dontCrossCorners) {\r\n                this.diagonalMovement = DiagonalMovement.OnlyWhenNoObstacles;\r\n            } else {\r\n                this.diagonalMovement = DiagonalMovement.IfAtMostOneObstacle;\r\n            }\r\n        }\r\n    }\r\n\r\n    // When diagonal movement is allowed the manhattan heuristic is not\r\n    //admissible. It should be octile instead\r\n    if (this.diagonalMovement === DiagonalMovement.Never) {\r\n        this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    } else {\r\n        this.heuristic = opt.heuristic || Heuristic.octile;\r\n    }\r\n}\r\n\r\n/**\r\n * Find and return the the path.\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nAStarFinder.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    var openList = new Heap(function(nodeA, nodeB) {\r\n            return nodeA.f - nodeB.f;\r\n        }),\r\n        startNode = grid.getNodeAt(startX, startY),\r\n        endNode = grid.getNodeAt(endX, endY),\r\n        heuristic = this.heuristic,\r\n        diagonalMovement = this.diagonalMovement,\r\n        weight = this.weight,\r\n        abs = Math.abs, SQRT2 = Math.SQRT2,\r\n        node, neighbors, neighbor, i, l, x, y, ng;\r\n\r\n    // set the `g` and `f` value of the start node to be 0\r\n    startNode.g = 0;\r\n    startNode.f = 0;\r\n\r\n    // push the start node into the open list\r\n    openList.push(startNode);\r\n    startNode.opened = true;\r\n\r\n    // while the open list is not empty\r\n    while (!openList.empty()) {\r\n        // pop the position of node which has the minimum `f` value.\r\n        node = openList.pop();\r\n        node.closed = true;\r\n\r\n        // if reached the end position, construct the path and return it\r\n        if (node === endNode) {\r\n            return Util.backtrace(endNode);\r\n        }\r\n\r\n        // get neigbours of the current node\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            if (neighbor.closed) {\r\n                continue;\r\n            }\r\n\r\n            x = neighbor.x;\r\n            y = neighbor.y;\r\n\r\n            // get the distance between current node and the neighbor\r\n            // and calculate the next g score\r\n            ng = node.g + ((x - node.x === 0 || y - node.y === 0) ? 1 : SQRT2);\r\n\r\n            // check if the neighbor has not been inspected yet, or\r\n            // can be reached with smaller cost from the current node\r\n            if (!neighbor.opened || ng < neighbor.g) {\r\n                neighbor.g = ng;\r\n                neighbor.h = neighbor.h || weight * heuristic(abs(x - endX), abs(y - endY));\r\n                neighbor.f = neighbor.g + neighbor.h;\r\n                neighbor.parent = node;\r\n\r\n                if (!neighbor.opened) {\r\n                    openList.push(neighbor);\r\n                    neighbor.opened = true;\r\n                } else {\r\n                    // the neighbor can be reached with smaller cost.\r\n                    // Since its f value has been updated, we have to\r\n                    // update its position in the open list\r\n                    openList.updateItem(neighbor);\r\n                }\r\n            }\r\n        } // end for each neighbor\r\n    } // end while not open list empty\r\n\r\n    // fail to find the path\r\n    return [];\r\n};\r\n\r\nmodule.exports = AStarFinder;\r\n","var Heap       = require('heap');\r\nvar Util       = require('../core/Util');\r\nvar Heuristic  = require('../core/Heuristic');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * A* path-finder.\r\n * based upon https://github.com/bgrins/javascript-astar\r\n * @constructor\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n * @param {number} opt.weight Weight to apply to the heuristic to allow for\r\n *     suboptimal paths, in order to speed up the search.\r\n */\r\nfunction BiAStarFinder(opt) {\r\n    opt = opt || {};\r\n    this.allowDiagonal = opt.allowDiagonal;\r\n    this.dontCrossCorners = opt.dontCrossCorners;\r\n    this.diagonalMovement = opt.diagonalMovement;\r\n    this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    this.weight = opt.weight || 1;\r\n\r\n    if (!this.diagonalMovement) {\r\n        if (!this.allowDiagonal) {\r\n            this.diagonalMovement = DiagonalMovement.Never;\r\n        } else {\r\n            if (this.dontCrossCorners) {\r\n                this.diagonalMovement = DiagonalMovement.OnlyWhenNoObstacles;\r\n            } else {\r\n                this.diagonalMovement = DiagonalMovement.IfAtMostOneObstacle;\r\n            }\r\n        }\r\n    }\r\n\r\n    //When diagonal movement is allowed the manhattan heuristic is not admissible\r\n    //It should be octile instead\r\n    if (this.diagonalMovement === DiagonalMovement.Never) {\r\n        this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    } else {\r\n        this.heuristic = opt.heuristic || Heuristic.octile;\r\n    }\r\n}\r\n\r\n/**\r\n * Find and return the the path.\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nBiAStarFinder.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    var cmp = function(nodeA, nodeB) {\r\n            return nodeA.f - nodeB.f;\r\n        },\r\n        startOpenList = new Heap(cmp),\r\n        endOpenList = new Heap(cmp),\r\n        startNode = grid.getNodeAt(startX, startY),\r\n        endNode = grid.getNodeAt(endX, endY),\r\n        heuristic = this.heuristic,\r\n        diagonalMovement = this.diagonalMovement,\r\n        weight = this.weight,\r\n        abs = Math.abs, SQRT2 = Math.SQRT2,\r\n        node, neighbors, neighbor, i, l, x, y, ng,\r\n        BY_START = 1, BY_END = 2;\r\n\r\n    // set the `g` and `f` value of the start node to be 0\r\n    // and push it into the start open list\r\n    startNode.g = 0;\r\n    startNode.f = 0;\r\n    startOpenList.push(startNode);\r\n    startNode.opened = BY_START;\r\n\r\n    // set the `g` and `f` value of the end node to be 0\r\n    // and push it into the open open list\r\n    endNode.g = 0;\r\n    endNode.f = 0;\r\n    endOpenList.push(endNode);\r\n    endNode.opened = BY_END;\r\n\r\n    // while both the open lists are not empty\r\n    while (!startOpenList.empty() && !endOpenList.empty()) {\r\n\r\n        // pop the position of start node which has the minimum `f` value.\r\n        node = startOpenList.pop();\r\n        node.closed = true;\r\n\r\n        // get neigbours of the current node\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            if (neighbor.closed) {\r\n                continue;\r\n            }\r\n            if (neighbor.opened === BY_END) {\r\n                return Util.biBacktrace(node, neighbor);\r\n            }\r\n\r\n            x = neighbor.x;\r\n            y = neighbor.y;\r\n\r\n            // get the distance between current node and the neighbor\r\n            // and calculate the next g score\r\n            ng = node.g + ((x - node.x === 0 || y - node.y === 0) ? 1 : SQRT2);\r\n\r\n            // check if the neighbor has not been inspected yet, or\r\n            // can be reached with smaller cost from the current node\r\n            if (!neighbor.opened || ng < neighbor.g) {\r\n                neighbor.g = ng;\r\n                neighbor.h = neighbor.h ||\r\n                    weight * heuristic(abs(x - endX), abs(y - endY));\r\n                neighbor.f = neighbor.g + neighbor.h;\r\n                neighbor.parent = node;\r\n\r\n                if (!neighbor.opened) {\r\n                    startOpenList.push(neighbor);\r\n                    neighbor.opened = BY_START;\r\n                } else {\r\n                    // the neighbor can be reached with smaller cost.\r\n                    // Since its f value has been updated, we have to\r\n                    // update its position in the open list\r\n                    startOpenList.updateItem(neighbor);\r\n                }\r\n            }\r\n        } // end for each neighbor\r\n\r\n\r\n        // pop the position of end node which has the minimum `f` value.\r\n        node = endOpenList.pop();\r\n        node.closed = true;\r\n\r\n        // get neigbours of the current node\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            if (neighbor.closed) {\r\n                continue;\r\n            }\r\n            if (neighbor.opened === BY_START) {\r\n                return Util.biBacktrace(neighbor, node);\r\n            }\r\n\r\n            x = neighbor.x;\r\n            y = neighbor.y;\r\n\r\n            // get the distance between current node and the neighbor\r\n            // and calculate the next g score\r\n            ng = node.g + ((x - node.x === 0 || y - node.y === 0) ? 1 : SQRT2);\r\n\r\n            // check if the neighbor has not been inspected yet, or\r\n            // can be reached with smaller cost from the current node\r\n            if (!neighbor.opened || ng < neighbor.g) {\r\n                neighbor.g = ng;\r\n                neighbor.h = neighbor.h ||\r\n                    weight * heuristic(abs(x - startX), abs(y - startY));\r\n                neighbor.f = neighbor.g + neighbor.h;\r\n                neighbor.parent = node;\r\n\r\n                if (!neighbor.opened) {\r\n                    endOpenList.push(neighbor);\r\n                    neighbor.opened = BY_END;\r\n                } else {\r\n                    // the neighbor can be reached with smaller cost.\r\n                    // Since its f value has been updated, we have to\r\n                    // update its position in the open list\r\n                    endOpenList.updateItem(neighbor);\r\n                }\r\n            }\r\n        } // end for each neighbor\r\n    } // end while not open list empty\r\n\r\n    // fail to find the path\r\n    return [];\r\n};\r\n\r\nmodule.exports = BiAStarFinder;\r\n","module.exports = require('./src/PathFinding');\r\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","var baseRandom = require('./_baseRandom');\n\n/**\n * A specialized version of `_.sample` for arrays.\n *\n * @private\n * @param {Array} array The array to sample.\n * @returns {*} Returns the random element.\n */\nfunction arraySample(array) {\n  var length = array.length;\n  return length ? array[baseRandom(0, length - 1)] : undefined;\n}\n\nmodule.exports = arraySample;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeFloor = Math.floor,\n    nativeRandom = Math.random;\n\n/**\n * The base implementation of `_.random` without support for returning\n * floating-point numbers.\n *\n * @private\n * @param {number} lower The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the random number.\n */\nfunction baseRandom(lower, upper) {\n  return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n}\n\nmodule.exports = baseRandom;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var baseSet = require('./_baseSet');\n\n/**\n * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n * it's created. Arrays are created for missing index properties while objects\n * are created for all other missing properties. Use `_.setWith` to customize\n * `path` creation.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.set(object, 'a[0].b.c', 4);\n * console.log(object.a[0].b.c);\n * // => 4\n *\n * _.set(object, ['x', '0', 'y', 'z'], 5);\n * console.log(object.x[0].y.z);\n * // => 5\n */\nfunction set(object, path, value) {\n  return object == null ? object : baseSet(object, path, value);\n}\n\nmodule.exports = set;\n","var arraySome = require('./_arraySome'),\n    baseIteratee = require('./_baseIteratee'),\n    baseSome = require('./_baseSome'),\n    isArray = require('./isArray'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Checks if `predicate` returns truthy for **any** element of `collection`.\n * Iteration is stopped once `predicate` returns truthy. The predicate is\n * invoked with three arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n * @example\n *\n * _.some([null, 0, 'yes', false], Boolean);\n * // => true\n *\n * var users = [\n *   { 'user': 'barney', 'active': true },\n *   { 'user': 'fred',   'active': false }\n * ];\n *\n * // The `_.matches` iteratee shorthand.\n * _.some(users, { 'user': 'barney', 'active': false });\n * // => false\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.some(users, ['active', false]);\n * // => true\n *\n * // The `_.property` iteratee shorthand.\n * _.some(users, 'active');\n * // => true\n */\nfunction some(collection, predicate, guard) {\n  var func = isArray(collection) ? arraySome : baseSome;\n  if (guard && isIterateeCall(collection, predicate, guard)) {\n    predicate = undefined;\n  }\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = some;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var arraySample = require('./_arraySample'),\n    values = require('./values');\n\n/**\n * The base implementation of `_.sample`.\n *\n * @private\n * @param {Array|Object} collection The collection to sample.\n * @returns {*} Returns the random element.\n */\nfunction baseSample(collection) {\n  return arraySample(values(collection));\n}\n\nmodule.exports = baseSample;\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var toFinite = require('./toFinite');\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nmodule.exports = toInteger;\n","var assignValue = require('./_assignValue'),\n    castPath = require('./_castPath'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.set`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseSet(object, path, value, customizer) {\n  if (!isObject(object)) {\n    return object;\n  }\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      lastIndex = length - 1,\n      nested = object;\n\n  while (nested != null && ++index < length) {\n    var key = toKey(path[index]),\n        newValue = value;\n\n    if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n      return object;\n    }\n\n    if (index != lastIndex) {\n      var objValue = nested[key];\n      newValue = customizer ? customizer(objValue, key, nested) : undefined;\n      if (newValue === undefined) {\n        newValue = isObject(objValue)\n          ? objValue\n          : (isIndex(path[index + 1]) ? [] : {});\n      }\n    }\n    assignValue(nested, key, newValue);\n    nested = nested[key];\n  }\n  return object;\n}\n\nmodule.exports = baseSet;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.some` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction baseSome(collection, predicate) {\n  var result;\n\n  baseEach(collection, function(value, index, collection) {\n    result = predicate(value, index, collection);\n    return !result;\n  });\n  return !!result;\n}\n\nmodule.exports = baseSome;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","module.exports = {\r\n    'Heap'                      : require('heap'),\r\n    'Node'                      : require('./core/Node'),\r\n    'Grid'                      : require('./core/Grid'),\r\n    'Util'                      : require('./core/Util'),\r\n    'DiagonalMovement'          : require('./core/DiagonalMovement'),\r\n    'Heuristic'                 : require('./core/Heuristic'),\r\n    'AStarFinder'               : require('./finders/AStarFinder'),\r\n    'BestFirstFinder'           : require('./finders/BestFirstFinder'),\r\n    'BreadthFirstFinder'        : require('./finders/BreadthFirstFinder'),\r\n    'DijkstraFinder'            : require('./finders/DijkstraFinder'),\r\n    'BiAStarFinder'             : require('./finders/BiAStarFinder'),\r\n    'BiBestFirstFinder'         : require('./finders/BiBestFirstFinder'),\r\n    'BiBreadthFirstFinder'      : require('./finders/BiBreadthFirstFinder'),\r\n    'BiDijkstraFinder'          : require('./finders/BiDijkstraFinder'),\r\n    'IDAStarFinder'             : require('./finders/IDAStarFinder'),\r\n    'JumpPointFinder'           : require('./finders/JumpPointFinder'),\r\n};\r\n","// Generated by CoffeeScript 1.8.0\n(function() {\n  var Heap, defaultCmp, floor, heapify, heappop, heappush, heappushpop, heapreplace, insort, min, nlargest, nsmallest, updateItem, _siftdown, _siftup;\n\n  floor = Math.floor, min = Math.min;\n\n\n  /*\n  Default comparison function to be used\n   */\n\n  defaultCmp = function(x, y) {\n    if (x < y) {\n      return -1;\n    }\n    if (x > y) {\n      return 1;\n    }\n    return 0;\n  };\n\n\n  /*\n  Insert item x in list a, and keep it sorted assuming a is sorted.\n  \n  If x is already in a, insert it to the right of the rightmost x.\n  \n  Optional args lo (default 0) and hi (default a.length) bound the slice\n  of a to be searched.\n   */\n\n  insort = function(a, x, lo, hi, cmp) {\n    var mid;\n    if (lo == null) {\n      lo = 0;\n    }\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (lo < 0) {\n      throw new Error('lo must be non-negative');\n    }\n    if (hi == null) {\n      hi = a.length;\n    }\n    while (lo < hi) {\n      mid = floor((lo + hi) / 2);\n      if (cmp(x, a[mid]) < 0) {\n        hi = mid;\n      } else {\n        lo = mid + 1;\n      }\n    }\n    return ([].splice.apply(a, [lo, lo - lo].concat(x)), x);\n  };\n\n\n  /*\n  Push item onto heap, maintaining the heap invariant.\n   */\n\n  heappush = function(array, item, cmp) {\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    array.push(item);\n    return _siftdown(array, 0, array.length - 1, cmp);\n  };\n\n\n  /*\n  Pop the smallest item off the heap, maintaining the heap invariant.\n   */\n\n  heappop = function(array, cmp) {\n    var lastelt, returnitem;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    lastelt = array.pop();\n    if (array.length) {\n      returnitem = array[0];\n      array[0] = lastelt;\n      _siftup(array, 0, cmp);\n    } else {\n      returnitem = lastelt;\n    }\n    return returnitem;\n  };\n\n\n  /*\n  Pop and return the current smallest value, and add the new item.\n  \n  This is more efficient than heappop() followed by heappush(), and can be\n  more appropriate when using a fixed size heap. Note that the value\n  returned may be larger than item! That constrains reasonable use of\n  this routine unless written as part of a conditional replacement:\n      if item > array[0]\n        item = heapreplace(array, item)\n   */\n\n  heapreplace = function(array, item, cmp) {\n    var returnitem;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    returnitem = array[0];\n    array[0] = item;\n    _siftup(array, 0, cmp);\n    return returnitem;\n  };\n\n\n  /*\n  Fast version of a heappush followed by a heappop.\n   */\n\n  heappushpop = function(array, item, cmp) {\n    var _ref;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (array.length && cmp(array[0], item) < 0) {\n      _ref = [array[0], item], item = _ref[0], array[0] = _ref[1];\n      _siftup(array, 0, cmp);\n    }\n    return item;\n  };\n\n\n  /*\n  Transform list into a heap, in-place, in O(array.length) time.\n   */\n\n  heapify = function(array, cmp) {\n    var i, _i, _j, _len, _ref, _ref1, _results, _results1;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    _ref1 = (function() {\n      _results1 = [];\n      for (var _j = 0, _ref = floor(array.length / 2); 0 <= _ref ? _j < _ref : _j > _ref; 0 <= _ref ? _j++ : _j--){ _results1.push(_j); }\n      return _results1;\n    }).apply(this).reverse();\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      i = _ref1[_i];\n      _results.push(_siftup(array, i, cmp));\n    }\n    return _results;\n  };\n\n\n  /*\n  Update the position of the given item in the heap.\n  This function should be called every time the item is being modified.\n   */\n\n  updateItem = function(array, item, cmp) {\n    var pos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    pos = array.indexOf(item);\n    if (pos === -1) {\n      return;\n    }\n    _siftdown(array, 0, pos, cmp);\n    return _siftup(array, pos, cmp);\n  };\n\n\n  /*\n  Find the n largest elements in a dataset.\n   */\n\n  nlargest = function(array, n, cmp) {\n    var elem, result, _i, _len, _ref;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    result = array.slice(0, n);\n    if (!result.length) {\n      return result;\n    }\n    heapify(result, cmp);\n    _ref = array.slice(n);\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      elem = _ref[_i];\n      heappushpop(result, elem, cmp);\n    }\n    return result.sort(cmp).reverse();\n  };\n\n\n  /*\n  Find the n smallest elements in a dataset.\n   */\n\n  nsmallest = function(array, n, cmp) {\n    var elem, i, los, result, _i, _j, _len, _ref, _ref1, _results;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    if (n * 10 <= array.length) {\n      result = array.slice(0, n).sort(cmp);\n      if (!result.length) {\n        return result;\n      }\n      los = result[result.length - 1];\n      _ref = array.slice(n);\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elem = _ref[_i];\n        if (cmp(elem, los) < 0) {\n          insort(result, elem, 0, null, cmp);\n          result.pop();\n          los = result[result.length - 1];\n        }\n      }\n      return result;\n    }\n    heapify(array, cmp);\n    _results = [];\n    for (i = _j = 0, _ref1 = min(n, array.length); 0 <= _ref1 ? _j < _ref1 : _j > _ref1; i = 0 <= _ref1 ? ++_j : --_j) {\n      _results.push(heappop(array, cmp));\n    }\n    return _results;\n  };\n\n  _siftdown = function(array, startpos, pos, cmp) {\n    var newitem, parent, parentpos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    newitem = array[pos];\n    while (pos > startpos) {\n      parentpos = (pos - 1) >> 1;\n      parent = array[parentpos];\n      if (cmp(newitem, parent) < 0) {\n        array[pos] = parent;\n        pos = parentpos;\n        continue;\n      }\n      break;\n    }\n    return array[pos] = newitem;\n  };\n\n  _siftup = function(array, pos, cmp) {\n    var childpos, endpos, newitem, rightpos, startpos;\n    if (cmp == null) {\n      cmp = defaultCmp;\n    }\n    endpos = array.length;\n    startpos = pos;\n    newitem = array[pos];\n    childpos = 2 * pos + 1;\n    while (childpos < endpos) {\n      rightpos = childpos + 1;\n      if (rightpos < endpos && !(cmp(array[childpos], array[rightpos]) < 0)) {\n        childpos = rightpos;\n      }\n      array[pos] = array[childpos];\n      pos = childpos;\n      childpos = 2 * pos + 1;\n    }\n    array[pos] = newitem;\n    return _siftdown(array, startpos, pos, cmp);\n  };\n\n  Heap = (function() {\n    Heap.push = heappush;\n\n    Heap.pop = heappop;\n\n    Heap.replace = heapreplace;\n\n    Heap.pushpop = heappushpop;\n\n    Heap.heapify = heapify;\n\n    Heap.updateItem = updateItem;\n\n    Heap.nlargest = nlargest;\n\n    Heap.nsmallest = nsmallest;\n\n    function Heap(cmp) {\n      this.cmp = cmp != null ? cmp : defaultCmp;\n      this.nodes = [];\n    }\n\n    Heap.prototype.push = function(x) {\n      return heappush(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.pop = function() {\n      return heappop(this.nodes, this.cmp);\n    };\n\n    Heap.prototype.peek = function() {\n      return this.nodes[0];\n    };\n\n    Heap.prototype.contains = function(x) {\n      return this.nodes.indexOf(x) !== -1;\n    };\n\n    Heap.prototype.replace = function(x) {\n      return heapreplace(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.pushpop = function(x) {\n      return heappushpop(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.heapify = function() {\n      return heapify(this.nodes, this.cmp);\n    };\n\n    Heap.prototype.updateItem = function(x) {\n      return updateItem(this.nodes, x, this.cmp);\n    };\n\n    Heap.prototype.clear = function() {\n      return this.nodes = [];\n    };\n\n    Heap.prototype.empty = function() {\n      return this.nodes.length === 0;\n    };\n\n    Heap.prototype.size = function() {\n      return this.nodes.length;\n    };\n\n    Heap.prototype.clone = function() {\n      var heap;\n      heap = new Heap();\n      heap.nodes = this.nodes.slice(0);\n      return heap;\n    };\n\n    Heap.prototype.toArray = function() {\n      return this.nodes.slice(0);\n    };\n\n    Heap.prototype.insert = Heap.prototype.push;\n\n    Heap.prototype.top = Heap.prototype.peek;\n\n    Heap.prototype.front = Heap.prototype.peek;\n\n    Heap.prototype.has = Heap.prototype.contains;\n\n    Heap.prototype.copy = Heap.prototype.clone;\n\n    return Heap;\n\n  })();\n\n  if (typeof module !== \"undefined\" && module !== null ? module.exports : void 0) {\n    module.exports = Heap;\n  } else {\n    window.Heap = Heap;\n  }\n\n}).call(this);\n","var Node = require('./Node');\r\nvar DiagonalMovement = require('./DiagonalMovement');\r\n\r\n/**\r\n * The Grid class, which serves as the encapsulation of the layout of the nodes.\r\n * @constructor\r\n * @param {number|Array<Array<(number|boolean)>>} width_or_matrix Number of columns of the grid, or matrix\r\n * @param {number} height Number of rows of the grid.\r\n * @param {Array<Array<(number|boolean)>>} [matrix] - A 0-1 matrix\r\n *     representing the walkable status of the nodes(0 or false for walkable).\r\n *     If the matrix is not supplied, all the nodes will be walkable.  */\r\nfunction Grid(width_or_matrix, height, matrix) {\r\n    var width;\r\n\r\n    if (typeof width_or_matrix !== 'object') {\r\n        width = width_or_matrix;\r\n    } else {\r\n        height = width_or_matrix.length;\r\n        width = width_or_matrix[0].length;\r\n        matrix = width_or_matrix;\r\n    }\r\n\r\n    /**\r\n     * The number of columns of the grid.\r\n     * @type number\r\n     */\r\n    this.width = width;\r\n    /**\r\n     * The number of rows of the grid.\r\n     * @type number\r\n     */\r\n    this.height = height;\r\n\r\n    /**\r\n     * A 2D array of nodes.\r\n     */\r\n    this.nodes = this._buildNodes(width, height, matrix);\r\n}\r\n\r\n/**\r\n * Build and return the nodes.\r\n * @private\r\n * @param {number} width\r\n * @param {number} height\r\n * @param {Array<Array<number|boolean>>} [matrix] - A 0-1 matrix representing\r\n *     the walkable status of the nodes.\r\n * @see Grid\r\n */\r\nGrid.prototype._buildNodes = function(width, height, matrix) {\r\n    var i, j,\r\n        nodes = new Array(height);\r\n\r\n    for (i = 0; i < height; ++i) {\r\n        nodes[i] = new Array(width);\r\n        for (j = 0; j < width; ++j) {\r\n            nodes[i][j] = new Node(j, i);\r\n        }\r\n    }\r\n\r\n\r\n    if (matrix === undefined) {\r\n        return nodes;\r\n    }\r\n\r\n    if (matrix.length !== height || matrix[0].length !== width) {\r\n        throw new Error('Matrix size does not fit');\r\n    }\r\n\r\n    for (i = 0; i < height; ++i) {\r\n        for (j = 0; j < width; ++j) {\r\n            if (matrix[i][j]) {\r\n                // 0, false, null will be walkable\r\n                // while others will be un-walkable\r\n                nodes[i][j].walkable = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return nodes;\r\n};\r\n\r\n\r\nGrid.prototype.getNodeAt = function(x, y) {\r\n    return this.nodes[y][x];\r\n};\r\n\r\n\r\n/**\r\n * Determine whether the node at the given position is walkable.\r\n * (Also returns false if the position is outside the grid.)\r\n * @param {number} x - The x coordinate of the node.\r\n * @param {number} y - The y coordinate of the node.\r\n * @return {boolean} - The walkability of the node.\r\n */\r\nGrid.prototype.isWalkableAt = function(x, y) {\r\n    return this.isInside(x, y) && this.nodes[y][x].walkable;\r\n};\r\n\r\n\r\n/**\r\n * Determine whether the position is inside the grid.\r\n * XXX: `grid.isInside(x, y)` is wierd to read.\r\n * It should be `(x, y) is inside grid`, but I failed to find a better\r\n * name for this method.\r\n * @param {number} x\r\n * @param {number} y\r\n * @return {boolean}\r\n */\r\nGrid.prototype.isInside = function(x, y) {\r\n    return (x >= 0 && x < this.width) && (y >= 0 && y < this.height);\r\n};\r\n\r\n\r\n/**\r\n * Set whether the node on the given position is walkable.\r\n * NOTE: throws exception if the coordinate is not inside the grid.\r\n * @param {number} x - The x coordinate of the node.\r\n * @param {number} y - The y coordinate of the node.\r\n * @param {boolean} walkable - Whether the position is walkable.\r\n */\r\nGrid.prototype.setWalkableAt = function(x, y, walkable) {\r\n    this.nodes[y][x].walkable = walkable;\r\n};\r\n\r\n\r\n/**\r\n * Get the neighbors of the given node.\r\n *\r\n *     offsets      diagonalOffsets:\r\n *  +---+---+---+    +---+---+---+\r\n *  |   | 0 |   |    | 0 |   | 1 |\r\n *  +---+---+---+    +---+---+---+\r\n *  | 3 |   | 1 |    |   |   |   |\r\n *  +---+---+---+    +---+---+---+\r\n *  |   | 2 |   |    | 3 |   | 2 |\r\n *  +---+---+---+    +---+---+---+\r\n *\r\n *  When allowDiagonal is true, if offsets[i] is valid, then\r\n *  diagonalOffsets[i] and\r\n *  diagonalOffsets[(i + 1) % 4] is valid.\r\n * @param {Node} node\r\n * @param {DiagonalMovement} diagonalMovement\r\n */\r\nGrid.prototype.getNeighbors = function(node, diagonalMovement) {\r\n    var x = node.x,\r\n        y = node.y,\r\n        neighbors = [],\r\n        s0 = false, d0 = false,\r\n        s1 = false, d1 = false,\r\n        s2 = false, d2 = false,\r\n        s3 = false, d3 = false,\r\n        nodes = this.nodes;\r\n\r\n    // \r\n    if (this.isWalkableAt(x, y - 1)) {\r\n        neighbors.push(nodes[y - 1][x]);\r\n        s0 = true;\r\n    }\r\n    // \r\n    if (this.isWalkableAt(x + 1, y)) {\r\n        neighbors.push(nodes[y][x + 1]);\r\n        s1 = true;\r\n    }\r\n    // \r\n    if (this.isWalkableAt(x, y + 1)) {\r\n        neighbors.push(nodes[y + 1][x]);\r\n        s2 = true;\r\n    }\r\n    // \r\n    if (this.isWalkableAt(x - 1, y)) {\r\n        neighbors.push(nodes[y][x - 1]);\r\n        s3 = true;\r\n    }\r\n\r\n    if (diagonalMovement === DiagonalMovement.Never) {\r\n        return neighbors;\r\n    }\r\n\r\n    if (diagonalMovement === DiagonalMovement.OnlyWhenNoObstacles) {\r\n        d0 = s3 && s0;\r\n        d1 = s0 && s1;\r\n        d2 = s1 && s2;\r\n        d3 = s2 && s3;\r\n    } else if (diagonalMovement === DiagonalMovement.IfAtMostOneObstacle) {\r\n        d0 = s3 || s0;\r\n        d1 = s0 || s1;\r\n        d2 = s1 || s2;\r\n        d3 = s2 || s3;\r\n    } else if (diagonalMovement === DiagonalMovement.Always) {\r\n        d0 = true;\r\n        d1 = true;\r\n        d2 = true;\r\n        d3 = true;\r\n    } else {\r\n        throw new Error('Incorrect value of diagonalMovement');\r\n    }\r\n\r\n    // \r\n    if (d0 && this.isWalkableAt(x - 1, y - 1)) {\r\n        neighbors.push(nodes[y - 1][x - 1]);\r\n    }\r\n    // \r\n    if (d1 && this.isWalkableAt(x + 1, y - 1)) {\r\n        neighbors.push(nodes[y - 1][x + 1]);\r\n    }\r\n    // \r\n    if (d2 && this.isWalkableAt(x + 1, y + 1)) {\r\n        neighbors.push(nodes[y + 1][x + 1]);\r\n    }\r\n    // \r\n    if (d3 && this.isWalkableAt(x - 1, y + 1)) {\r\n        neighbors.push(nodes[y + 1][x - 1]);\r\n    }\r\n\r\n    return neighbors;\r\n};\r\n\r\n\r\n/**\r\n * Get a clone of this grid.\r\n * @return {Grid} Cloned grid.\r\n */\r\nGrid.prototype.clone = function() {\r\n    var i, j,\r\n\r\n        width = this.width,\r\n        height = this.height,\r\n        thisNodes = this.nodes,\r\n\r\n        newGrid = new Grid(width, height),\r\n        newNodes = new Array(height);\r\n\r\n    for (i = 0; i < height; ++i) {\r\n        newNodes[i] = new Array(width);\r\n        for (j = 0; j < width; ++j) {\r\n            newNodes[i][j] = new Node(j, i, thisNodes[i][j].walkable);\r\n        }\r\n    }\r\n\r\n    newGrid.nodes = newNodes;\r\n\r\n    return newGrid;\r\n};\r\n\r\nmodule.exports = Grid;\r\n","var AStarFinder = require('./AStarFinder');\r\n\r\n/**\r\n * Best-First-Search path-finder.\r\n * @constructor\r\n * @extends AStarFinder\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n */\r\nfunction BestFirstFinder(opt) {\r\n    AStarFinder.call(this, opt);\r\n\r\n    var orig = this.heuristic;\r\n    this.heuristic = function(dx, dy) {\r\n        return orig(dx, dy) * 1000000;\r\n    };\r\n}\r\n\r\nBestFirstFinder.prototype = new AStarFinder();\r\nBestFirstFinder.prototype.constructor = BestFirstFinder;\r\n\r\nmodule.exports = BestFirstFinder;\r\n","var Util = require('../core/Util');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Breadth-First-Search path finder.\r\n * @constructor\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n */\r\nfunction BreadthFirstFinder(opt) {\r\n    opt = opt || {};\r\n    this.allowDiagonal = opt.allowDiagonal;\r\n    this.dontCrossCorners = opt.dontCrossCorners;\r\n    this.diagonalMovement = opt.diagonalMovement;\r\n\r\n    if (!this.diagonalMovement) {\r\n        if (!this.allowDiagonal) {\r\n            this.diagonalMovement = DiagonalMovement.Never;\r\n        } else {\r\n            if (this.dontCrossCorners) {\r\n                this.diagonalMovement = DiagonalMovement.OnlyWhenNoObstacles;\r\n            } else {\r\n                this.diagonalMovement = DiagonalMovement.IfAtMostOneObstacle;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Find and return the the path.\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nBreadthFirstFinder.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    var openList = [],\r\n        diagonalMovement = this.diagonalMovement,\r\n        startNode = grid.getNodeAt(startX, startY),\r\n        endNode = grid.getNodeAt(endX, endY),\r\n        neighbors, neighbor, node, i, l;\r\n\r\n    // push the start pos into the queue\r\n    openList.push(startNode);\r\n    startNode.opened = true;\r\n\r\n    // while the queue is not empty\r\n    while (openList.length) {\r\n        // take the front node from the queue\r\n        node = openList.shift();\r\n        node.closed = true;\r\n\r\n        // reached the end position\r\n        if (node === endNode) {\r\n            return Util.backtrace(endNode);\r\n        }\r\n\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            // skip this neighbor if it has been inspected before\r\n            if (neighbor.closed || neighbor.opened) {\r\n                continue;\r\n            }\r\n\r\n            openList.push(neighbor);\r\n            neighbor.opened = true;\r\n            neighbor.parent = node;\r\n        }\r\n    }\r\n    \r\n    // fail to find the path\r\n    return [];\r\n};\r\n\r\nmodule.exports = BreadthFirstFinder;\r\n","var AStarFinder = require('./AStarFinder');\r\n\r\n/**\r\n * Dijkstra path-finder.\r\n * @constructor\r\n * @extends AStarFinder\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n */\r\nfunction DijkstraFinder(opt) {\r\n    AStarFinder.call(this, opt);\r\n    this.heuristic = function(dx, dy) {\r\n        return 0;\r\n    };\r\n}\r\n\r\nDijkstraFinder.prototype = new AStarFinder();\r\nDijkstraFinder.prototype.constructor = DijkstraFinder;\r\n\r\nmodule.exports = DijkstraFinder;\r\n","var BiAStarFinder = require('./BiAStarFinder');\r\n\r\n/**\r\n * Bi-direcitional Best-First-Search path-finder.\r\n * @constructor\r\n * @extends BiAStarFinder\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n */\r\nfunction BiBestFirstFinder(opt) {\r\n    BiAStarFinder.call(this, opt);\r\n\r\n    var orig = this.heuristic;\r\n    this.heuristic = function(dx, dy) {\r\n        return orig(dx, dy) * 1000000;\r\n    };\r\n}\r\n\r\nBiBestFirstFinder.prototype = new BiAStarFinder();\r\nBiBestFirstFinder.prototype.constructor = BiBestFirstFinder;\r\n\r\nmodule.exports = BiBestFirstFinder;\r\n","var Util = require('../core/Util');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Bi-directional Breadth-First-Search path finder.\r\n * @constructor\r\n * @param {object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n */\r\nfunction BiBreadthFirstFinder(opt) {\r\n    opt = opt || {};\r\n    this.allowDiagonal = opt.allowDiagonal;\r\n    this.dontCrossCorners = opt.dontCrossCorners;\r\n    this.diagonalMovement = opt.diagonalMovement;\r\n\r\n    if (!this.diagonalMovement) {\r\n        if (!this.allowDiagonal) {\r\n            this.diagonalMovement = DiagonalMovement.Never;\r\n        } else {\r\n            if (this.dontCrossCorners) {\r\n                this.diagonalMovement = DiagonalMovement.OnlyWhenNoObstacles;\r\n            } else {\r\n                this.diagonalMovement = DiagonalMovement.IfAtMostOneObstacle;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Find and return the the path.\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nBiBreadthFirstFinder.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    var startNode = grid.getNodeAt(startX, startY),\r\n        endNode = grid.getNodeAt(endX, endY),\r\n        startOpenList = [], endOpenList = [],\r\n        neighbors, neighbor, node,\r\n        diagonalMovement = this.diagonalMovement,\r\n        BY_START = 0, BY_END = 1,\r\n        i, l;\r\n\r\n    // push the start and end nodes into the queues\r\n    startOpenList.push(startNode);\r\n    startNode.opened = true;\r\n    startNode.by = BY_START;\r\n\r\n    endOpenList.push(endNode);\r\n    endNode.opened = true;\r\n    endNode.by = BY_END;\r\n\r\n    // while both the queues are not empty\r\n    while (startOpenList.length && endOpenList.length) {\r\n\r\n        // expand start open list\r\n\r\n        node = startOpenList.shift();\r\n        node.closed = true;\r\n\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            if (neighbor.closed) {\r\n                continue;\r\n            }\r\n            if (neighbor.opened) {\r\n                // if this node has been inspected by the reversed search,\r\n                // then a path is found.\r\n                if (neighbor.by === BY_END) {\r\n                    return Util.biBacktrace(node, neighbor);\r\n                }\r\n                continue;\r\n            }\r\n            startOpenList.push(neighbor);\r\n            neighbor.parent = node;\r\n            neighbor.opened = true;\r\n            neighbor.by = BY_START;\r\n        }\r\n\r\n        // expand end open list\r\n\r\n        node = endOpenList.shift();\r\n        node.closed = true;\r\n\r\n        neighbors = grid.getNeighbors(node, diagonalMovement);\r\n        for (i = 0, l = neighbors.length; i < l; ++i) {\r\n            neighbor = neighbors[i];\r\n\r\n            if (neighbor.closed) {\r\n                continue;\r\n            }\r\n            if (neighbor.opened) {\r\n                if (neighbor.by === BY_START) {\r\n                    return Util.biBacktrace(neighbor, node);\r\n                }\r\n                continue;\r\n            }\r\n            endOpenList.push(neighbor);\r\n            neighbor.parent = node;\r\n            neighbor.opened = true;\r\n            neighbor.by = BY_END;\r\n        }\r\n    }\r\n\r\n    // fail to find the path\r\n    return [];\r\n};\r\n\r\nmodule.exports = BiBreadthFirstFinder;\r\n","var BiAStarFinder = require('./BiAStarFinder');\r\n\r\n/**\r\n * Bi-directional Dijkstra path-finder.\r\n * @constructor\r\n * @extends BiAStarFinder\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n */\r\nfunction BiDijkstraFinder(opt) {\r\n    BiAStarFinder.call(this, opt);\r\n    this.heuristic = function(dx, dy) {\r\n        return 0;\r\n    };\r\n}\r\n\r\nBiDijkstraFinder.prototype = new BiAStarFinder();\r\nBiDijkstraFinder.prototype.constructor = BiDijkstraFinder;\r\n\r\nmodule.exports = BiDijkstraFinder;\r\n","var Util       = require('../core/Util');\r\nvar Heuristic  = require('../core/Heuristic');\r\nvar Node       = require('../core/Node');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Iterative Deeping A Star (IDA*) path-finder.\r\n *\r\n * Recursion based on:\r\n *   http://www.apl.jhu.edu/~hall/AI-Programming/IDA-Star.html\r\n *\r\n * Path retracing based on:\r\n *  V. Nageshwara Rao, Vipin Kumar and K. Ramesh\r\n *  \"A Parallel Implementation of Iterative-Deeping-A*\", January 1987.\r\n *  ftp://ftp.cs.utexas.edu/.snapshot/hourly.1/pub/AI-Lab/tech-reports/UT-AI-TR-87-46.pdf\r\n *\r\n * @author Gerard Meier (www.gerardmeier.com)\r\n *\r\n * @constructor\r\n * @param {Object} opt\r\n * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\r\n *     Deprecated, use diagonalMovement instead.\r\n * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching\r\n *     block corners. Deprecated, use diagonalMovement instead.\r\n * @param {DiagonalMovement} opt.diagonalMovement Allowed diagonal movement.\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n * @param {number} opt.weight Weight to apply to the heuristic to allow for\r\n *     suboptimal paths, in order to speed up the search.\r\n * @param {boolean} opt.trackRecursion Whether to track recursion for\r\n *     statistical purposes.\r\n * @param {number} opt.timeLimit Maximum execution time. Use <= 0 for infinite.\r\n */\r\nfunction IDAStarFinder(opt) {\r\n    opt = opt || {};\r\n    this.allowDiagonal = opt.allowDiagonal;\r\n    this.dontCrossCorners = opt.dontCrossCorners;\r\n    this.diagonalMovement = opt.diagonalMovement;\r\n    this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    this.weight = opt.weight || 1;\r\n    this.trackRecursion = opt.trackRecursion || false;\r\n    this.timeLimit = opt.timeLimit || Infinity; // Default: no time limit.\r\n\r\n    if (!this.diagonalMovement) {\r\n        if (!this.allowDiagonal) {\r\n            this.diagonalMovement = DiagonalMovement.Never;\r\n        } else {\r\n            if (this.dontCrossCorners) {\r\n                this.diagonalMovement = DiagonalMovement.OnlyWhenNoObstacles;\r\n            } else {\r\n                this.diagonalMovement = DiagonalMovement.IfAtMostOneObstacle;\r\n            }\r\n        }\r\n    }\r\n\r\n    // When diagonal movement is allowed the manhattan heuristic is not\r\n    // admissible, it should be octile instead\r\n    if (this.diagonalMovement === DiagonalMovement.Never) {\r\n        this.heuristic = opt.heuristic || Heuristic.manhattan;\r\n    } else {\r\n        this.heuristic = opt.heuristic || Heuristic.octile;\r\n    }\r\n}\r\n\r\n/**\r\n * Find and return the the path. When an empty array is returned, either\r\n * no path is possible, or the maximum execution time is reached.\r\n *\r\n * @return {Array<Array<number>>} The path, including both start and\r\n *     end positions.\r\n */\r\nIDAStarFinder.prototype.findPath = function(startX, startY, endX, endY, grid) {\r\n    // Used for statistics:\r\n    var nodesVisited = 0;\r\n\r\n    // Execution time limitation:\r\n    var startTime = new Date().getTime();\r\n\r\n    // Heuristic helper:\r\n    var h = function(a, b) {\r\n        return this.heuristic(Math.abs(b.x - a.x), Math.abs(b.y - a.y));\r\n    }.bind(this);\r\n\r\n    // Step cost from a to b:\r\n    var cost = function(a, b) {\r\n        return (a.x === b.x || a.y === b.y) ? 1 : Math.SQRT2;\r\n    };\r\n\r\n    /**\r\n     * IDA* search implementation.\r\n     *\r\n     * @param {Node} The node currently expanding from.\r\n     * @param {number} Cost to reach the given node.\r\n     * @param {number} Maximum search depth (cut-off value).\r\n     * @param {Array<Array<number>>} The found route.\r\n     * @param {number} Recursion depth.\r\n     *\r\n     * @return {Object} either a number with the new optimal cut-off depth,\r\n     * or a valid node instance, in which case a path was found.\r\n     */\r\n    var search = function(node, g, cutoff, route, depth) {\r\n        nodesVisited++;\r\n\r\n        // Enforce timelimit:\r\n        if (this.timeLimit > 0 &&\r\n            new Date().getTime() - startTime > this.timeLimit * 1000) {\r\n            // Enforced as \"path-not-found\".\r\n            return Infinity;\r\n        }\r\n\r\n        var f = g + h(node, end) * this.weight;\r\n\r\n        // We've searched too deep for this iteration.\r\n        if (f > cutoff) {\r\n            return f;\r\n        }\r\n\r\n        if (node == end) {\r\n            route[depth] = [node.x, node.y];\r\n            return node;\r\n        }\r\n\r\n        var min, t, k, neighbour;\r\n\r\n        var neighbours = grid.getNeighbors(node, this.diagonalMovement);\r\n\r\n        // Sort the neighbours, gives nicer paths. But, this deviates\r\n        // from the original algorithm - so I left it out.\r\n        //neighbours.sort(function(a, b){\r\n        //    return h(a, end) - h(b, end);\r\n        //});\r\n\r\n        \r\n        /*jshint -W084 *///Disable warning: Expected a conditional expression and instead saw an assignment\r\n        for (k = 0, min = Infinity; neighbour = neighbours[k]; ++k) {\r\n        /*jshint +W084 *///Enable warning: Expected a conditional expression and instead saw an assignment\r\n            if (this.trackRecursion) {\r\n                // Retain a copy for visualisation. Due to recursion, this\r\n                // node may be part of other paths too.\r\n                neighbour.retainCount = neighbour.retainCount + 1 || 1;\r\n\r\n                if(neighbour.tested !== true) {\r\n                    neighbour.tested = true;\r\n                }\r\n            }\r\n\r\n            t = search(neighbour, g + cost(node, neighbour), cutoff, route, depth + 1);\r\n\r\n            if (t instanceof Node) {\r\n                route[depth] = [node.x, node.y];\r\n\r\n                // For a typical A* linked list, this would work:\r\n                // neighbour.parent = node;\r\n                return t;\r\n            }\r\n\r\n            // Decrement count, then determine whether it's actually closed.\r\n            if (this.trackRecursion && (--neighbour.retainCount) === 0) {\r\n                neighbour.tested = false;\r\n            }\r\n\r\n            if (t < min) {\r\n                min = t;\r\n            }\r\n        }\r\n\r\n        return min;\r\n\r\n    }.bind(this);\r\n\r\n    // Node instance lookups:\r\n    var start = grid.getNodeAt(startX, startY);\r\n    var end   = grid.getNodeAt(endX, endY);\r\n\r\n    // Initial search depth, given the typical heuristic contraints,\r\n    // there should be no cheaper route possible.\r\n    var cutOff = h(start, end);\r\n\r\n    var j, route, t;\r\n\r\n    // With an overflow protection.\r\n    for (j = 0; true; ++j) {\r\n\r\n        route = [];\r\n\r\n        // Search till cut-off depth:\r\n        t = search(start, 0, cutOff, route, 0);\r\n\r\n        // Route not possible, or not found in time limit.\r\n        if (t === Infinity) {\r\n            return [];\r\n        }\r\n\r\n        // If t is a node, it's also the end node. Route is now\r\n        // populated with a valid path to the end node.\r\n        if (t instanceof Node) {\r\n            return route;\r\n        }\r\n\r\n        // Try again, this time with a deeper cut-off. The t score\r\n        // is the closest we got to the end node.\r\n        cutOff = t;\r\n    }\r\n\r\n    // This _should_ never to be reached.\r\n    return [];\r\n};\r\n\r\nmodule.exports = IDAStarFinder;\r\n","/**\r\n * @author aniero / https://github.com/aniero\r\n */\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\nvar JPFNeverMoveDiagonally = require('./JPFNeverMoveDiagonally');\r\nvar JPFAlwaysMoveDiagonally = require('./JPFAlwaysMoveDiagonally');\r\nvar JPFMoveDiagonallyIfNoObstacles = require('./JPFMoveDiagonallyIfNoObstacles');\r\nvar JPFMoveDiagonallyIfAtMostOneObstacle = require('./JPFMoveDiagonallyIfAtMostOneObstacle');\r\n\r\n/**\r\n * Path finder using the Jump Point Search algorithm\r\n * @param {Object} opt\r\n * @param {function} opt.heuristic Heuristic function to estimate the distance\r\n *     (defaults to manhattan).\r\n * @param {DiagonalMovement} opt.diagonalMovement Condition under which diagonal\r\n *      movement will be allowed.\r\n */\r\nfunction JumpPointFinder(opt) {\r\n    opt = opt || {};\r\n    if (opt.diagonalMovement === DiagonalMovement.Never) {\r\n        return new JPFNeverMoveDiagonally(opt);\r\n    } else if (opt.diagonalMovement === DiagonalMovement.Always) {\r\n        return new JPFAlwaysMoveDiagonally(opt);\r\n    } else if (opt.diagonalMovement === DiagonalMovement.OnlyWhenNoObstacles) {\r\n        return new JPFMoveDiagonallyIfNoObstacles(opt);\r\n    } else {\r\n        return new JPFMoveDiagonallyIfAtMostOneObstacle(opt);\r\n    }\r\n}\r\n\r\nmodule.exports = JumpPointFinder;\r\n","/**\r\n * @author imor / https://github.com/imor\r\n */\r\nvar JumpPointFinderBase = require('./JumpPointFinderBase');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Path finder using the Jump Point Search algorithm allowing only horizontal\r\n * or vertical movements.\r\n */\r\nfunction JPFNeverMoveDiagonally(opt) {\r\n    JumpPointFinderBase.call(this, opt);\r\n}\r\n\r\nJPFNeverMoveDiagonally.prototype = new JumpPointFinderBase();\r\nJPFNeverMoveDiagonally.prototype.constructor = JPFNeverMoveDiagonally;\r\n\r\n/**\r\n * Search recursively in the direction (parent -> child), stopping only when a\r\n * jump point is found.\r\n * @protected\r\n * @return {Array<Array<number>>} The x, y coordinate of the jump point\r\n *     found, or null if not found\r\n */\r\nJPFNeverMoveDiagonally.prototype._jump = function(x, y, px, py) {\r\n    var grid = this.grid,\r\n        dx = x - px, dy = y - py;\r\n\r\n    if (!grid.isWalkableAt(x, y)) {\r\n        return null;\r\n    }\r\n\r\n    if(this.trackJumpRecursion === true) {\r\n        grid.getNodeAt(x, y).tested = true;\r\n    }\r\n\r\n    if (grid.getNodeAt(x, y) === this.endNode) {\r\n        return [x, y];\r\n    }\r\n\r\n    if (dx !== 0) {\r\n        if ((grid.isWalkableAt(x, y - 1) && !grid.isWalkableAt(x - dx, y - 1)) ||\r\n            (grid.isWalkableAt(x, y + 1) && !grid.isWalkableAt(x - dx, y + 1))) {\r\n            return [x, y];\r\n        }\r\n    }\r\n    else if (dy !== 0) {\r\n        if ((grid.isWalkableAt(x - 1, y) && !grid.isWalkableAt(x - 1, y - dy)) ||\r\n            (grid.isWalkableAt(x + 1, y) && !grid.isWalkableAt(x + 1, y - dy))) {\r\n            return [x, y];\r\n        }\r\n        //When moving vertically, must check for horizontal jump points\r\n        if (this._jump(x + 1, y, x, y) || this._jump(x - 1, y, x, y)) {\r\n            return [x, y];\r\n        }\r\n    }\r\n    else {\r\n        throw new Error(\"Only horizontal and vertical movements are allowed\");\r\n    }\r\n\r\n    return this._jump(x + dx, y + dy, x, y);\r\n};\r\n\r\n/**\r\n * Find the neighbors for the given node. If the node has a parent,\r\n * prune the neighbors based on the jump point search algorithm, otherwise\r\n * return all available neighbors.\r\n * @return {Array<Array<number>>} The neighbors found.\r\n */\r\nJPFNeverMoveDiagonally.prototype._findNeighbors = function(node) {\r\n    var parent = node.parent,\r\n        x = node.x, y = node.y,\r\n        grid = this.grid,\r\n        px, py, nx, ny, dx, dy,\r\n        neighbors = [], neighborNodes, neighborNode, i, l;\r\n\r\n    // directed pruning: can ignore most neighbors, unless forced.\r\n    if (parent) {\r\n        px = parent.x;\r\n        py = parent.y;\r\n        // get the normalized direction of travel\r\n        dx = (x - px) / Math.max(Math.abs(x - px), 1);\r\n        dy = (y - py) / Math.max(Math.abs(y - py), 1);\r\n\r\n        if (dx !== 0) {\r\n            if (grid.isWalkableAt(x, y - 1)) {\r\n                neighbors.push([x, y - 1]);\r\n            }\r\n            if (grid.isWalkableAt(x, y + 1)) {\r\n                neighbors.push([x, y + 1]);\r\n            }\r\n            if (grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y]);\r\n            }\r\n        }\r\n        else if (dy !== 0) {\r\n            if (grid.isWalkableAt(x - 1, y)) {\r\n                neighbors.push([x - 1, y]);\r\n            }\r\n            if (grid.isWalkableAt(x + 1, y)) {\r\n                neighbors.push([x + 1, y]);\r\n            }\r\n            if (grid.isWalkableAt(x, y + dy)) {\r\n                neighbors.push([x, y + dy]);\r\n            }\r\n        }\r\n    }\r\n    // return all neighbors\r\n    else {\r\n        neighborNodes = grid.getNeighbors(node, DiagonalMovement.Never);\r\n        for (i = 0, l = neighborNodes.length; i < l; ++i) {\r\n            neighborNode = neighborNodes[i];\r\n            neighbors.push([neighborNode.x, neighborNode.y]);\r\n        }\r\n    }\r\n\r\n    return neighbors;\r\n};\r\n\r\nmodule.exports = JPFNeverMoveDiagonally;\r\n","/**\r\n * @author imor / https://github.com/imor\r\n */\r\nvar JumpPointFinderBase = require('./JumpPointFinderBase');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Path finder using the Jump Point Search algorithm which always moves\r\n * diagonally irrespective of the number of obstacles.\r\n */\r\nfunction JPFAlwaysMoveDiagonally(opt) {\r\n    JumpPointFinderBase.call(this, opt);\r\n}\r\n\r\nJPFAlwaysMoveDiagonally.prototype = new JumpPointFinderBase();\r\nJPFAlwaysMoveDiagonally.prototype.constructor = JPFAlwaysMoveDiagonally;\r\n\r\n/**\r\n * Search recursively in the direction (parent -> child), stopping only when a\r\n * jump point is found.\r\n * @protected\r\n * @return {Array<Array<number>>} The x, y coordinate of the jump point\r\n *     found, or null if not found\r\n */\r\nJPFAlwaysMoveDiagonally.prototype._jump = function(x, y, px, py) {\r\n    var grid = this.grid,\r\n        dx = x - px, dy = y - py;\r\n\r\n    if (!grid.isWalkableAt(x, y)) {\r\n        return null;\r\n    }\r\n\r\n    if(this.trackJumpRecursion === true) {\r\n        grid.getNodeAt(x, y).tested = true;\r\n    }\r\n\r\n    if (grid.getNodeAt(x, y) === this.endNode) {\r\n        return [x, y];\r\n    }\r\n\r\n    // check for forced neighbors\r\n    // along the diagonal\r\n    if (dx !== 0 && dy !== 0) {\r\n        if ((grid.isWalkableAt(x - dx, y + dy) && !grid.isWalkableAt(x - dx, y)) ||\r\n            (grid.isWalkableAt(x + dx, y - dy) && !grid.isWalkableAt(x, y - dy))) {\r\n            return [x, y];\r\n        }\r\n        // when moving diagonally, must check for vertical/horizontal jump points\r\n        if (this._jump(x + dx, y, x, y) || this._jump(x, y + dy, x, y)) {\r\n            return [x, y];\r\n        }\r\n    }\r\n    // horizontally/vertically\r\n    else {\r\n        if( dx !== 0 ) { // moving along x\r\n            if((grid.isWalkableAt(x + dx, y + 1) && !grid.isWalkableAt(x, y + 1)) ||\r\n               (grid.isWalkableAt(x + dx, y - 1) && !grid.isWalkableAt(x, y - 1))) {\r\n                return [x, y];\r\n            }\r\n        }\r\n        else {\r\n            if((grid.isWalkableAt(x + 1, y + dy) && !grid.isWalkableAt(x + 1, y)) ||\r\n               (grid.isWalkableAt(x - 1, y + dy) && !grid.isWalkableAt(x - 1, y))) {\r\n                return [x, y];\r\n            }\r\n        }\r\n    }\r\n\r\n    return this._jump(x + dx, y + dy, x, y);\r\n};\r\n\r\n/**\r\n * Find the neighbors for the given node. If the node has a parent,\r\n * prune the neighbors based on the jump point search algorithm, otherwise\r\n * return all available neighbors.\r\n * @return {Array<Array<number>>} The neighbors found.\r\n */\r\nJPFAlwaysMoveDiagonally.prototype._findNeighbors = function(node) {\r\n    var parent = node.parent,\r\n        x = node.x, y = node.y,\r\n        grid = this.grid,\r\n        px, py, nx, ny, dx, dy,\r\n        neighbors = [], neighborNodes, neighborNode, i, l;\r\n\r\n    // directed pruning: can ignore most neighbors, unless forced.\r\n    if (parent) {\r\n        px = parent.x;\r\n        py = parent.y;\r\n        // get the normalized direction of travel\r\n        dx = (x - px) / Math.max(Math.abs(x - px), 1);\r\n        dy = (y - py) / Math.max(Math.abs(y - py), 1);\r\n\r\n        // search diagonally\r\n        if (dx !== 0 && dy !== 0) {\r\n            if (grid.isWalkableAt(x, y + dy)) {\r\n                neighbors.push([x, y + dy]);\r\n            }\r\n            if (grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y]);\r\n            }\r\n            if (grid.isWalkableAt(x + dx, y + dy)) {\r\n                neighbors.push([x + dx, y + dy]);\r\n            }\r\n            if (!grid.isWalkableAt(x - dx, y)) {\r\n                neighbors.push([x - dx, y + dy]);\r\n            }\r\n            if (!grid.isWalkableAt(x, y - dy)) {\r\n                neighbors.push([x + dx, y - dy]);\r\n            }\r\n        }\r\n        // search horizontally/vertically\r\n        else {\r\n            if(dx === 0) {\r\n                if (grid.isWalkableAt(x, y + dy)) {\r\n                    neighbors.push([x, y + dy]);\r\n                }\r\n                if (!grid.isWalkableAt(x + 1, y)) {\r\n                    neighbors.push([x + 1, y + dy]);\r\n                }\r\n                if (!grid.isWalkableAt(x - 1, y)) {\r\n                    neighbors.push([x - 1, y + dy]);\r\n                }\r\n            }\r\n            else {\r\n                if (grid.isWalkableAt(x + dx, y)) {\r\n                    neighbors.push([x + dx, y]);\r\n                }\r\n                if (!grid.isWalkableAt(x, y + 1)) {\r\n                    neighbors.push([x + dx, y + 1]);\r\n                }\r\n                if (!grid.isWalkableAt(x, y - 1)) {\r\n                    neighbors.push([x + dx, y - 1]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // return all neighbors\r\n    else {\r\n        neighborNodes = grid.getNeighbors(node, DiagonalMovement.Always);\r\n        for (i = 0, l = neighborNodes.length; i < l; ++i) {\r\n            neighborNode = neighborNodes[i];\r\n            neighbors.push([neighborNode.x, neighborNode.y]);\r\n        }\r\n    }\r\n\r\n    return neighbors;\r\n};\r\n\r\nmodule.exports = JPFAlwaysMoveDiagonally;\r\n","/**\r\n * @author imor / https://github.com/imor\r\n */\r\nvar JumpPointFinderBase = require('./JumpPointFinderBase');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Path finder using the Jump Point Search algorithm which moves\r\n * diagonally only when there are no obstacles.\r\n */\r\nfunction JPFMoveDiagonallyIfNoObstacles(opt) {\r\n    JumpPointFinderBase.call(this, opt);\r\n}\r\n\r\nJPFMoveDiagonallyIfNoObstacles.prototype = new JumpPointFinderBase();\r\nJPFMoveDiagonallyIfNoObstacles.prototype.constructor = JPFMoveDiagonallyIfNoObstacles;\r\n\r\n/**\r\n * Search recursively in the direction (parent -> child), stopping only when a\r\n * jump point is found.\r\n * @protected\r\n * @return {Array<Array<number>>} The x, y coordinate of the jump point\r\n *     found, or null if not found\r\n */\r\nJPFMoveDiagonallyIfNoObstacles.prototype._jump = function(x, y, px, py) {\r\n    var grid = this.grid,\r\n        dx = x - px, dy = y - py;\r\n\r\n    if (!grid.isWalkableAt(x, y)) {\r\n        return null;\r\n    }\r\n\r\n    if(this.trackJumpRecursion === true) {\r\n        grid.getNodeAt(x, y).tested = true;\r\n    }\r\n\r\n    if (grid.getNodeAt(x, y) === this.endNode) {\r\n        return [x, y];\r\n    }\r\n\r\n    // check for forced neighbors\r\n    // along the diagonal\r\n    if (dx !== 0 && dy !== 0) {\r\n        // if ((grid.isWalkableAt(x - dx, y + dy) && !grid.isWalkableAt(x - dx, y)) ||\r\n            // (grid.isWalkableAt(x + dx, y - dy) && !grid.isWalkableAt(x, y - dy))) {\r\n            // return [x, y];\r\n        // }\r\n        // when moving diagonally, must check for vertical/horizontal jump points\r\n        if (this._jump(x + dx, y, x, y) || this._jump(x, y + dy, x, y)) {\r\n            return [x, y];\r\n        }\r\n    }\r\n    // horizontally/vertically\r\n    else {\r\n        if (dx !== 0) {\r\n            if ((grid.isWalkableAt(x, y - 1) && !grid.isWalkableAt(x - dx, y - 1)) ||\r\n                (grid.isWalkableAt(x, y + 1) && !grid.isWalkableAt(x - dx, y + 1))) {\r\n                return [x, y];\r\n            }\r\n        }\r\n        else if (dy !== 0) {\r\n            if ((grid.isWalkableAt(x - 1, y) && !grid.isWalkableAt(x - 1, y - dy)) ||\r\n                (grid.isWalkableAt(x + 1, y) && !grid.isWalkableAt(x + 1, y - dy))) {\r\n                return [x, y];\r\n            }\r\n            // When moving vertically, must check for horizontal jump points\r\n            // if (this._jump(x + 1, y, x, y) || this._jump(x - 1, y, x, y)) {\r\n                // return [x, y];\r\n            // }\r\n        }\r\n    }\r\n\r\n    // moving diagonally, must make sure one of the vertical/horizontal\r\n    // neighbors is open to allow the path\r\n    if (grid.isWalkableAt(x + dx, y) && grid.isWalkableAt(x, y + dy)) {\r\n        return this._jump(x + dx, y + dy, x, y);\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\n/**\r\n * Find the neighbors for the given node. If the node has a parent,\r\n * prune the neighbors based on the jump point search algorithm, otherwise\r\n * return all available neighbors.\r\n * @return {Array<Array<number>>} The neighbors found.\r\n */\r\nJPFMoveDiagonallyIfNoObstacles.prototype._findNeighbors = function(node) {\r\n    var parent = node.parent,\r\n        x = node.x, y = node.y,\r\n        grid = this.grid,\r\n        px, py, nx, ny, dx, dy,\r\n        neighbors = [], neighborNodes, neighborNode, i, l;\r\n\r\n    // directed pruning: can ignore most neighbors, unless forced.\r\n    if (parent) {\r\n        px = parent.x;\r\n        py = parent.y;\r\n        // get the normalized direction of travel\r\n        dx = (x - px) / Math.max(Math.abs(x - px), 1);\r\n        dy = (y - py) / Math.max(Math.abs(y - py), 1);\r\n\r\n        // search diagonally\r\n        if (dx !== 0 && dy !== 0) {\r\n            if (grid.isWalkableAt(x, y + dy)) {\r\n                neighbors.push([x, y + dy]);\r\n            }\r\n            if (grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y]);\r\n            }\r\n            if (grid.isWalkableAt(x, y + dy) && grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y + dy]);\r\n            }\r\n        }\r\n        // search horizontally/vertically\r\n        else {\r\n            var isNextWalkable;\r\n            if (dx !== 0) {\r\n                isNextWalkable = grid.isWalkableAt(x + dx, y);\r\n                var isTopWalkable = grid.isWalkableAt(x, y + 1);\r\n                var isBottomWalkable = grid.isWalkableAt(x, y - 1);\r\n\r\n                if (isNextWalkable) {\r\n                    neighbors.push([x + dx, y]);\r\n                    if (isTopWalkable) {\r\n                        neighbors.push([x + dx, y + 1]);\r\n                    }\r\n                    if (isBottomWalkable) {\r\n                        neighbors.push([x + dx, y - 1]);\r\n                    }\r\n                }\r\n                if (isTopWalkable) {\r\n                    neighbors.push([x, y + 1]);\r\n                }\r\n                if (isBottomWalkable) {\r\n                    neighbors.push([x, y - 1]);\r\n                }\r\n            }\r\n            else if (dy !== 0) {\r\n                isNextWalkable = grid.isWalkableAt(x, y + dy);\r\n                var isRightWalkable = grid.isWalkableAt(x + 1, y);\r\n                var isLeftWalkable = grid.isWalkableAt(x - 1, y);\r\n\r\n                if (isNextWalkable) {\r\n                    neighbors.push([x, y + dy]);\r\n                    if (isRightWalkable) {\r\n                        neighbors.push([x + 1, y + dy]);\r\n                    }\r\n                    if (isLeftWalkable) {\r\n                        neighbors.push([x - 1, y + dy]);\r\n                    }\r\n                }\r\n                if (isRightWalkable) {\r\n                    neighbors.push([x + 1, y]);\r\n                }\r\n                if (isLeftWalkable) {\r\n                    neighbors.push([x - 1, y]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // return all neighbors\r\n    else {\r\n        neighborNodes = grid.getNeighbors(node, DiagonalMovement.OnlyWhenNoObstacles);\r\n        for (i = 0, l = neighborNodes.length; i < l; ++i) {\r\n            neighborNode = neighborNodes[i];\r\n            neighbors.push([neighborNode.x, neighborNode.y]);\r\n        }\r\n    }\r\n\r\n    return neighbors;\r\n};\r\n\r\nmodule.exports = JPFMoveDiagonallyIfNoObstacles;\r\n","/**\r\n * @author imor / https://github.com/imor\r\n */\r\nvar JumpPointFinderBase = require('./JumpPointFinderBase');\r\nvar DiagonalMovement = require('../core/DiagonalMovement');\r\n\r\n/**\r\n * Path finder using the Jump Point Search algorithm which moves\r\n * diagonally only when there is at most one obstacle.\r\n */\r\nfunction JPFMoveDiagonallyIfAtMostOneObstacle(opt) {\r\n    JumpPointFinderBase.call(this, opt);\r\n}\r\n\r\nJPFMoveDiagonallyIfAtMostOneObstacle.prototype = new JumpPointFinderBase();\r\nJPFMoveDiagonallyIfAtMostOneObstacle.prototype.constructor = JPFMoveDiagonallyIfAtMostOneObstacle;\r\n\r\n/**\r\n * Search recursively in the direction (parent -> child), stopping only when a\r\n * jump point is found.\r\n * @protected\r\n * @return {Array<Array<number>>} The x, y coordinate of the jump point\r\n *     found, or null if not found\r\n */\r\nJPFMoveDiagonallyIfAtMostOneObstacle.prototype._jump = function(x, y, px, py) {\r\n    var grid = this.grid,\r\n        dx = x - px, dy = y - py;\r\n\r\n    if (!grid.isWalkableAt(x, y)) {\r\n        return null;\r\n    }\r\n\r\n    if(this.trackJumpRecursion === true) {\r\n        grid.getNodeAt(x, y).tested = true;\r\n    }\r\n\r\n    if (grid.getNodeAt(x, y) === this.endNode) {\r\n        return [x, y];\r\n    }\r\n\r\n    // check for forced neighbors\r\n    // along the diagonal\r\n    if (dx !== 0 && dy !== 0) {\r\n        if ((grid.isWalkableAt(x - dx, y + dy) && !grid.isWalkableAt(x - dx, y)) ||\r\n            (grid.isWalkableAt(x + dx, y - dy) && !grid.isWalkableAt(x, y - dy))) {\r\n            return [x, y];\r\n        }\r\n        // when moving diagonally, must check for vertical/horizontal jump points\r\n        if (this._jump(x + dx, y, x, y) || this._jump(x, y + dy, x, y)) {\r\n            return [x, y];\r\n        }\r\n    }\r\n    // horizontally/vertically\r\n    else {\r\n        if( dx !== 0 ) { // moving along x\r\n            if((grid.isWalkableAt(x + dx, y + 1) && !grid.isWalkableAt(x, y + 1)) ||\r\n               (grid.isWalkableAt(x + dx, y - 1) && !grid.isWalkableAt(x, y - 1))) {\r\n                return [x, y];\r\n            }\r\n        }\r\n        else {\r\n            if((grid.isWalkableAt(x + 1, y + dy) && !grid.isWalkableAt(x + 1, y)) ||\r\n               (grid.isWalkableAt(x - 1, y + dy) && !grid.isWalkableAt(x - 1, y))) {\r\n                return [x, y];\r\n            }\r\n        }\r\n    }\r\n\r\n    // moving diagonally, must make sure one of the vertical/horizontal\r\n    // neighbors is open to allow the path\r\n    if (grid.isWalkableAt(x + dx, y) || grid.isWalkableAt(x, y + dy)) {\r\n        return this._jump(x + dx, y + dy, x, y);\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\n/**\r\n * Find the neighbors for the given node. If the node has a parent,\r\n * prune the neighbors based on the jump point search algorithm, otherwise\r\n * return all available neighbors.\r\n * @return {Array<Array<number>>} The neighbors found.\r\n */\r\nJPFMoveDiagonallyIfAtMostOneObstacle.prototype._findNeighbors = function(node) {\r\n    var parent = node.parent,\r\n        x = node.x, y = node.y,\r\n        grid = this.grid,\r\n        px, py, nx, ny, dx, dy,\r\n        neighbors = [], neighborNodes, neighborNode, i, l;\r\n\r\n    // directed pruning: can ignore most neighbors, unless forced.\r\n    if (parent) {\r\n        px = parent.x;\r\n        py = parent.y;\r\n        // get the normalized direction of travel\r\n        dx = (x - px) / Math.max(Math.abs(x - px), 1);\r\n        dy = (y - py) / Math.max(Math.abs(y - py), 1);\r\n\r\n        // search diagonally\r\n        if (dx !== 0 && dy !== 0) {\r\n            if (grid.isWalkableAt(x, y + dy)) {\r\n                neighbors.push([x, y + dy]);\r\n            }\r\n            if (grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y]);\r\n            }\r\n            if (grid.isWalkableAt(x, y + dy) || grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y + dy]);\r\n            }\r\n            if (!grid.isWalkableAt(x - dx, y) && grid.isWalkableAt(x, y + dy)) {\r\n                neighbors.push([x - dx, y + dy]);\r\n            }\r\n            if (!grid.isWalkableAt(x, y - dy) && grid.isWalkableAt(x + dx, y)) {\r\n                neighbors.push([x + dx, y - dy]);\r\n            }\r\n        }\r\n        // search horizontally/vertically\r\n        else {\r\n            if(dx === 0) {\r\n                if (grid.isWalkableAt(x, y + dy)) {\r\n                    neighbors.push([x, y + dy]);\r\n                    if (!grid.isWalkableAt(x + 1, y)) {\r\n                        neighbors.push([x + 1, y + dy]);\r\n                    }\r\n                    if (!grid.isWalkableAt(x - 1, y)) {\r\n                        neighbors.push([x - 1, y + dy]);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (grid.isWalkableAt(x + dx, y)) {\r\n                    neighbors.push([x + dx, y]);\r\n                    if (!grid.isWalkableAt(x, y + 1)) {\r\n                        neighbors.push([x + dx, y + 1]);\r\n                    }\r\n                    if (!grid.isWalkableAt(x, y - 1)) {\r\n                        neighbors.push([x + dx, y - 1]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // return all neighbors\r\n    else {\r\n        neighborNodes = grid.getNeighbors(node, DiagonalMovement.IfAtMostOneObstacle);\r\n        for (i = 0, l = neighborNodes.length; i < l; ++i) {\r\n            neighborNode = neighborNodes[i];\r\n            neighbors.push([neighborNode.x, neighborNode.y]);\r\n        }\r\n    }\r\n\r\n    return neighbors;\r\n};\r\n\r\nmodule.exports = JPFMoveDiagonallyIfAtMostOneObstacle;\r\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","export default __webpack_public_path__ + \"7ccdb4fcc64ae7ca215ce76c927ec773.png\";","import sample from 'lodash/sample';\r\nimport { grid } from './canvas';\r\n\r\nexport const CARDINAL = [\r\n  { x: 0, y: -1 }, // N\r\n  { x: 1, y: 0 }, // E\r\n  { x: 0, y: 1 }, // S\r\n  { x: -1, y: 0 }, // W\r\n];\r\n\r\nexport const DIAGONAL = [\r\n  { x: 1, y: -1 }, // NE\r\n  { x: 1, y: 1 }, // SE\r\n  { x: -1, y: 1 }, // SW\r\n  { x: -1, y: -1 }, // NW\r\n];\r\n\r\nexport const ALL = [...CARDINAL, ...DIAGONAL];\r\n\r\nexport const toCell = (cellOrId) => {\r\n  let cell = cellOrId;\r\n  if (typeof cell === 'string') cell = idToCell(cell);\r\n\r\n  return cell;\r\n};\r\n\r\nexport const toLocId = (cellOrId) => {\r\n  let locId = cellOrId;\r\n  if (typeof locId !== 'string') locId = cellToId(locId);\r\n\r\n  return locId;\r\n};\r\n\r\nconst insideCircle = (center, tile, radius) => {\r\n  const dx = center.x - tile.x;\r\n  const dy = center.y - tile.y;\r\n  const distance_squared = dx * dx + dy * dy;\r\n  return distance_squared <= radius * radius;\r\n};\r\n\r\nexport const circle = (center, radius) => {\r\n  const diameter = radius % 1 ? radius * 2 : radius * 2 + 1;\r\n  const top = center.y - radius;\r\n  const bottom = center.y + radius;\r\n  const left = center.x - radius;\r\n  const right = center.x + radius;\r\n\r\n  const locsIds = [];\r\n\r\n  for (let y = top; y <= bottom; y++) {\r\n    for (let x = left; x <= right; x++) {\r\n      const cx = Math.ceil(x);\r\n      const cy = Math.ceil(y);\r\n      if (insideCircle(center, { x: cx, y: cy }, radius)) {\r\n        locsIds.push(`${cx},${cy}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  return locsIds;\r\n};\r\n\r\nexport const rectangle = ({ x, y, z, width, height, hasWalls }, tileProps) => {\r\n  const tiles = {};\r\n\r\n  const x1 = x;\r\n  const x2 = x + width - 1;\r\n  const y1 = y;\r\n  const y2 = y + height - 1;\r\n  if (hasWalls) {\r\n    for (let yi = y1 + 1; yi <= y2 - 1; yi++) {\r\n      for (let xi = x1 + 1; xi <= x2 - 1; xi++) {\r\n        tiles[`${xi},${yi},${z}`] = { x: xi, y: yi, z, ...tileProps };\r\n      }\r\n    }\r\n  } else {\r\n    for (let yi = y1; yi <= y2; yi++) {\r\n      for (let xi = x1; xi <= x2; xi++) {\r\n        tiles[`${xi},${yi},${z}`] = { x: xi, y: yi, z, ...tileProps };\r\n      }\r\n    }\r\n  }\r\n\r\n  const center = {\r\n    x: Math.round((x1 + x2) / 2),\r\n    y: Math.round((y1 + y2) / 2),\r\n    z,\r\n  };\r\n\r\n  return { x1, x2, y1, y2, center, hasWalls, tiles };\r\n};\r\n\r\nexport const rectsIntersect = (rect1, rect2) => {\r\n  return (\r\n    rect1.x1 <= rect2.x2 &&\r\n    rect1.x2 >= rect2.x1 &&\r\n    rect1.y1 <= rect2.y2 &&\r\n    rect1.y2 >= rect2.y1\r\n  );\r\n};\r\n\r\nexport const distance = (cell1, cell2) => {\r\n  const x = Math.pow(cell2.x - cell1.x, 2);\r\n  const y = Math.pow(cell2.y - cell1.y, 2);\r\n  return Math.floor(Math.sqrt(x + y));\r\n};\r\n\r\nexport const idToCell = (id) => {\r\n  const coords = id.split(',');\r\n  return {\r\n    x: parseInt(coords[0], 10),\r\n    y: parseInt(coords[1], 10),\r\n    z: parseInt(coords[2], 10),\r\n  };\r\n};\r\n\r\nexport const cellToId = ({ x, y, z }) => `${x},${y},${z}`;\r\n\r\nexport const isOnMapEdge = (x, y) => {\r\n  const { width, height, x: mapX, y: mapY } = grid.map;\r\n\r\n  if (x === mapX) return true; // west edge\r\n  if (y === mapY) return true; // north edge\r\n  if (x === mapX + width - 1) return true; // east edge\r\n  if (y === mapY + height - 1) return true; // south edge\r\n  return false;\r\n};\r\n\r\nexport const getNeighbors = ({ x, y }, direction = CARDINAL) => {\r\n  const points = [];\r\n  for (let dir of direction) {\r\n    let candidate = {\r\n      x: x + dir.x,\r\n      y: y + dir.y,\r\n    };\r\n    if (\r\n      candidate.x >= 0 &&\r\n      candidate.x < grid.width &&\r\n      candidate.y >= 0 &&\r\n      candidate.y < grid.height\r\n    ) {\r\n      points.push(candidate);\r\n    }\r\n  }\r\n  return points;\r\n};\r\n\r\nexport const getNeighborIds = (cellOrId, direction = 'CARDINAL') => {\r\n  let cell = toCell(cellOrId);\r\n\r\n  if (direction === 'CARDINAL') {\r\n    return getNeighbors(cell, CARDINAL).map(cellToId);\r\n  }\r\n\r\n  if (direction === 'DIAGONAL') {\r\n    return getNeighbors(cell, DIAGONAL).map(cellToId);\r\n  }\r\n\r\n  if (direction === 'ALL') {\r\n    return [\r\n      ...getNeighbors(cell, CARDINAL).map(cellToId),\r\n      ...getNeighbors(cell, DIAGONAL).map(cellToId),\r\n    ];\r\n  }\r\n};\r\n\r\nexport const isNeighbor = (a, b) => {\r\n  let posA = a;\r\n  if (typeof posA === 'string') {\r\n    posA = idToCell(a);\r\n  }\r\n\r\n  let posB = b;\r\n  if (typeof posB === 'string') {\r\n    posB = idToCell(b);\r\n  }\r\n\r\n  const { x: ax, y: ay } = posA;\r\n  const { x: bx, y: by } = posB;\r\n\r\n  if (\r\n    (ax - bx === 1 && ay - by === 0) ||\r\n    (ax - bx === 0 && ay - by === -1) ||\r\n    (ax - bx === -1 && ay - by === 0) ||\r\n    (ax - bx === 0 && ay - by === 1)\r\n  ) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nexport const randomNeighbor = (startX, startY) => {\r\n  const direction = sample(CARDINAL);\r\n  const x = startX + direction.x;\r\n  const y = startY + direction.y;\r\n  return { x, y };\r\n};\r\n\r\nexport const getNeighbor = (x, y, dir) => {\r\n  const dirMap = { N: 0, E: 1, S: 2, W: 3 };\r\n  const direction = CARDINAL[dirMap[dir]];\r\n  return {\r\n    x: x + direction.x,\r\n    y: y + direction.y,\r\n  };\r\n};\r\n\r\nexport const getDirection = (a, b) => {\r\n  const cellA = toCell(a);\r\n  const cellB = toCell(b);\r\n\r\n  const { x: ax, y: ay } = cellA;\r\n  const { x: bx, y: by } = cellB;\r\n\r\n  let dir;\r\n\r\n  if (ax - bx === 1 && ay - by === 0) dir = '';\r\n  if (ax - bx === 0 && ay - by === -1) dir = '';\r\n  if (ax - bx === -1 && ay - by === 0) dir = '';\r\n  if (ax - bx === 0 && ay - by === 1) dir = '';\r\n\r\n  return dir;\r\n};\r\n","import { circle, rectangle } from './grid';\r\n\r\nconst pixelRatio = window.devicePixelRatio || 1;\r\nconst canvas = document.querySelector('#canvas');\r\nconst ctx = canvas.getContext('2d');\r\n\r\nexport const grid = {\r\n  width: 100,\r\n  height: 35,\r\n\r\n  map: {\r\n    width: 79,\r\n    height: 29,\r\n    x: 21,\r\n    y: 3,\r\n  },\r\n\r\n  messageLog: {\r\n    width: 79,\r\n    height: 3,\r\n    x: 21,\r\n    y: 0,\r\n  },\r\n\r\n  playerHud: {\r\n    width: 20,\r\n    height: 6,\r\n    x: 0,\r\n    y: 0,\r\n  },\r\n\r\n  playerEquipment: {\r\n    width: 20,\r\n    height: 13,\r\n    x: 0,\r\n    y: 7,\r\n    head: { x: 5, y: 7 },\r\n    weapon: { x: 1, y: 11 },\r\n    chest: { x: 5, y: 11 },\r\n    shield: { x: 9, y: 11 },\r\n    legs: { x: 5, y: 15 },\r\n  },\r\n\r\n  equipmentInfo: {\r\n    width: 20,\r\n    height: 7,\r\n    x: 0,\r\n    y: 20,\r\n  },\r\n\r\n  infoBar: {\r\n    width: 79,\r\n    height: 3,\r\n    x: 21,\r\n    y: 32,\r\n  },\r\n\r\n  inventory: {\r\n    width: 37,\r\n    height: 28,\r\n    x: 21,\r\n    y: 4,\r\n  },\r\n\r\n  menu: {\r\n    width: 100,\r\n    height: 1,\r\n    x: 0,\r\n    y: 33,\r\n  },\r\n};\r\n\r\nconst lineHeight = 1.2;\r\n\r\nlet calculatedFontSize = window.innerWidth / grid.width;\r\nlet cellWidth = calculatedFontSize * pixelRatio;\r\nlet cellHeight = calculatedFontSize * lineHeight * pixelRatio;\r\nlet fontSize = calculatedFontSize * pixelRatio;\r\n\r\ncanvas.style.cssText = `width: ${calculatedFontSize * grid.width}; height: ${\r\n  calculatedFontSize * lineHeight * grid.height\r\n}`;\r\ncanvas.width = cellWidth * grid.width;\r\ncanvas.height = cellHeight * grid.height;\r\n\r\nctx.font = `normal ${fontSize}px 'Fira Code'`;\r\nctx.textAlign = 'center';\r\nctx.textBaseline = 'middle';\r\n\r\nexport const clearCanvas = (x, y, w, h) => {\r\n  const posX = x * cellWidth;\r\n  const posY = y * cellHeight;\r\n\r\n  const width = cellWidth * w;\r\n  const height = cellHeight * h;\r\n\r\n  ctx.clearRect(posX, posY, width, height);\r\n};\r\n\r\nconst drawBackground = ({ color, position }) => {\r\n  if (color === 'transparent') return;\r\n\r\n  ctx.fillStyle = color;\r\n\r\n  ctx.fillRect(\r\n    position.x * cellWidth,\r\n    position.y * cellHeight,\r\n    cellWidth,\r\n    cellHeight\r\n  );\r\n};\r\n\r\nexport const drawChar = ({ char, color, position }) => {\r\n  ctx.fillStyle = color;\r\n  ctx.fillText(\r\n    char,\r\n    position.x * cellWidth + cellWidth / 2,\r\n    position.y * cellHeight + cellHeight / 2\r\n  );\r\n};\r\nexport const drawCell = (entity, options = {}) => {\r\n  const char = options.char || entity.appearance.char;\r\n  const background = options.background || entity.appearance.background;\r\n  const color = options.color || entity.appearance.color;\r\n  const position = entity.position;\r\n\r\n  drawBackground({ color: background, position });\r\n  drawChar({ char, color, position });\r\n};\r\n\r\nexport const drawCircle = (x, y, radius) => {\r\n  const cells = circle({ x, y }, radius);\r\n  cells.forEach((cell) => {\r\n    const x = parseInt(cell.split(',')[0]);\r\n    const y = parseInt(cell.split(',')[1]);\r\n    drawCell({\r\n      appearance: {\r\n        char: '',\r\n        background: 'rgba(74, 0, 218, 0.5)',\r\n      },\r\n      position: { x, y },\r\n    });\r\n  });\r\n};\r\n\r\nexport const drawImage = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  image,\r\n  color = '#FFFFFF',\r\n}) => {\r\n  const img = new Image();\r\n\r\n  const coloredImage = image.replace(/#color/g, color);\r\n  img.src =\r\n    'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(coloredImage);\r\n\r\n  img.onload = () => {\r\n    ctx.drawImage(\r\n      img,\r\n      x * cellWidth + cellWidth / 2,\r\n      y * cellHeight + cellHeight / 2,\r\n      width * cellWidth + cellWidth / 2,\r\n      height * cellHeight\r\n    );\r\n  };\r\n};\r\n\r\nexport const drawRect = (x, y, width, height, color) => {\r\n  const rect = rectangle({ x, y, width, height });\r\n\r\n  Object.values(rect.tiles).forEach((position) => {\r\n    drawBackground({ color, position });\r\n  });\r\n};\r\n\r\nexport const drawText = (template) => {\r\n  const textToRender = template.text;\r\n\r\n  [...textToRender].forEach((char, index) => {\r\n    const options = { ...template };\r\n    const character = {\r\n      appearance: {\r\n        char,\r\n        background: options.background,\r\n        color: options.color,\r\n      },\r\n      position: {\r\n        x: index + options.x,\r\n        y: options.y,\r\n      },\r\n    };\r\n\r\n    delete options.x;\r\n    delete options.y;\r\n    drawCell(character, options);\r\n  });\r\n};\r\n\r\nexport const pxToCell = (ev) => {\r\n  const bounds = canvas.getBoundingClientRect();\r\n  const relativeX = ev.clientX - bounds.left;\r\n  const relativeY = ev.clientY - bounds.top;\r\n  const colPos = Math.trunc((relativeX / cellWidth) * pixelRatio);\r\n  const rowPos = Math.trunc((relativeY / cellHeight) * pixelRatio);\r\n\r\n  return [colPos, rowPos];\r\n};\r\n","import get from 'lodash/get';\r\nimport set from 'lodash/set';\r\n\r\nexport const cache = {\r\n  entitiesAtLocation: {},\r\n  z: -1,\r\n  floors: {}, // {z: {stairsUp: '', stairsDown: ''}}\r\n};\r\n\r\nexport const addCache = (path, value) => {\r\n  set(cache, path, value);\r\n};\r\n\r\nexport const readCache = (path) => get(cache, path);\r\n\r\nexport const addCacheSet = (name, key, value) => {\r\n  if (cache[name][key]) {\r\n    cache[name][key].add(value);\r\n  } else {\r\n    cache[name][key] = new Set();\r\n    cache[name][key].add(value);\r\n  }\r\n};\r\n\r\nexport const deleteCacheSet = (name, key, value) => {\r\n  if (cache[name][key] && cache[name][key].has(value)) {\r\n    cache[name][key].delete(value);\r\n  }\r\n};\r\n\r\nexport const readCacheSet = (name, key, value) => {\r\n  if (cache[name][key]) {\r\n    if (value) {\r\n      return cache[name][key].get(value);\r\n    }\r\n  }\r\n  return cache[name][key];\r\n};\r\n\r\nexport const serializeCache = () => {\r\n  const entitiesAtLocation = Object.keys(cache.entitiesAtLocation).reduce(\r\n    (acc, val) => {\r\n      acc[val] = [...cache.entitiesAtLocation[val]];\r\n      return acc;\r\n    },\r\n    {}\r\n  );\r\n\r\n  return {\r\n    entitiesAtLocation,\r\n    z: cache.z,\r\n    floors: cache.floors,\r\n  };\r\n};\r\n\r\nexport const deserializeCache = (data) => {\r\n  cache.entitiesAtLocation = Object.keys(data.entitiesAtLocation).reduce(\r\n    (acc, val) => {\r\n      acc[val] = new Set(data.entitiesAtLocation[val]);\r\n      return acc;\r\n    },\r\n    {}\r\n  );\r\n\r\n  cache.z = data.z;\r\n  cache.floors = data.floors;\r\n};\r\n\r\nexport const clearCache = () => {\r\n  cache.entitiesAtLocation = {};\r\n  cache.z = 1;\r\n  cache.floors = {};\r\n};\r\n\r\nexport default cache;\r\n","'use strict';\n\nconst preserveCamelCase = string => {\n\tlet isLastCharLower = false;\n\tlet isLastCharUpper = false;\n\tlet isLastLastCharUpper = false;\n\n\tfor (let i = 0; i < string.length; i++) {\n\t\tconst character = string[i];\n\n\t\tif (isLastCharLower && /[\\p{Lu}]/u.test(character)) {\n\t\t\tstring = string.slice(0, i) + '-' + string.slice(i);\n\t\t\tisLastCharLower = false;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = true;\n\t\t\ti++;\n\t\t} else if (isLastCharUpper && isLastLastCharUpper && /[\\p{Ll}]/u.test(character)) {\n\t\t\tstring = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = false;\n\t\t\tisLastCharLower = true;\n\t\t} else {\n\t\t\tisLastCharLower = character.toLocaleLowerCase() === character && character.toLocaleUpperCase() !== character;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = character.toLocaleUpperCase() === character && character.toLocaleLowerCase() !== character;\n\t\t}\n\t}\n\n\treturn string;\n};\n\nconst camelCase = (input, options) => {\n\tif (!(typeof input === 'string' || Array.isArray(input))) {\n\t\tthrow new TypeError('Expected the input to be `string | string[]`');\n\t}\n\n\toptions = {\n\t\t...{pascalCase: false},\n\t\t...options\n\t};\n\n\tconst postProcess = x => options.pascalCase ? x.charAt(0).toLocaleUpperCase() + x.slice(1) : x;\n\n\tif (Array.isArray(input)) {\n\t\tinput = input.map(x => x.trim())\n\t\t\t.filter(x => x.length)\n\t\t\t.join('-');\n\t} else {\n\t\tinput = input.trim();\n\t}\n\n\tif (input.length === 0) {\n\t\treturn '';\n\t}\n\n\tif (input.length === 1) {\n\t\treturn options.pascalCase ? input.toLocaleUpperCase() : input.toLocaleLowerCase();\n\t}\n\n\tconst hasUpperCase = input !== input.toLocaleLowerCase();\n\n\tif (hasUpperCase) {\n\t\tinput = preserveCamelCase(input);\n\t}\n\n\tinput = input\n\t\t.replace(/^[_.\\- ]+/, '')\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[_.\\- ]+([\\p{Alpha}\\p{N}_]|$)/gu, (_, p1) => p1.toLocaleUpperCase())\n\t\t.replace(/\\d+([\\p{Alpha}\\p{N}_]|$)/gu, m => m.toLocaleUpperCase());\n\n\treturn postProcess(input);\n};\n\nmodule.exports = camelCase;\n// TODO: Remove this for the next major release\nmodule.exports.default = camelCase;\n","import camelcaseSlow from 'camelcase';\r\n\r\nconst camelCache = {};\r\n\r\nexport const camelString = (value) => {\r\n    const result = camelCache[value];\r\n\r\n    if (!result) {\r\n        camelCache[value] = camelcaseSlow(value);\r\n\r\n        return camelCache[value];\r\n    }\r\n\r\n    return result;\r\n};\r\n","import { camelString } from './util/string-util';\r\n\r\nexport class ComponentRegistry {\r\n    _cbit = 0;\r\n    _map = {};\r\n\r\n    register(clazz) {\r\n        const key = camelString(clazz.name);\r\n\r\n        clazz.prototype._ckey = key;\r\n        clazz.prototype._cbit = BigInt(++this._cbit);\r\n\r\n        this._map[key] = clazz;\r\n    }\r\n\r\n    get(key) {\r\n        return this._map[key];\r\n    }\r\n}\r\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","import merge from 'deepmerge';\r\n\r\nexport default class PrefabComponent {\r\n    constructor(clazz, properties = {}, overwrite = true) {\r\n        this.clazz = clazz;\r\n        this.properties = properties;\r\n        this.overwrite = overwrite;\r\n    }\r\n\r\n    applyToEntity(entity, initialProps = {}) {\r\n        if (!this.clazz.allowMultiple && entity.has(this.clazz)) {\r\n            if (!this.overwrite) {\r\n                return;\r\n            }\r\n\r\n            const comp = entity[this.clazz.prototype._ckey];\r\n\r\n            entity.remove(comp);\r\n        }\r\n\r\n        const props = merge(this.properties, initialProps);\r\n\r\n        entity.add(this.clazz, props);\r\n    }\r\n}\r\n","export default class Prefab {\r\n    name = '';\r\n    inherit = [];\r\n    components = [];\r\n\r\n    constructor(name) {\r\n        this.name = name;\r\n    }\r\n\r\n    addComponent(prefabComponent) {\r\n        this.components.push(prefabComponent);\r\n    }\r\n\r\n    applyToEntity(entity, prefabProps = {}) {\r\n        this.inherit.forEach((parent) => {\r\n            parent.applyToEntity(entity, prefabProps);\r\n        });\r\n\r\n        const arrComps = {};\r\n\r\n        this.components.forEach((component) => {\r\n            const clazz = component.clazz;\r\n            const ckey = clazz.prototype._ckey;\r\n\r\n            let initialCompProps = {};\r\n\r\n            if (clazz.allowMultiple) {\r\n                if (clazz.keyProperty) {\r\n                    const key = component.properties[clazz.keyProperty];\r\n\r\n                    if (prefabProps[ckey] && prefabProps[ckey][key]) {\r\n                        initialCompProps = prefabProps[ckey][key];\r\n                    }\r\n                } else {\r\n                    if (!arrComps[ckey]) {\r\n                        arrComps[ckey] = 0;\r\n                    }\r\n\r\n                    if (\r\n                        prefabProps[ckey] &&\r\n                        prefabProps[ckey][arrComps[ckey]]\r\n                    ) {\r\n                        initialCompProps = prefabProps[ckey][arrComps[ckey]];\r\n                    }\r\n\r\n                    arrComps[ckey]++;\r\n                }\r\n            } else {\r\n                initialCompProps = prefabProps[ckey];\r\n            }\r\n\r\n            component.applyToEntity(entity, initialCompProps);\r\n        });\r\n\r\n        return entity;\r\n    }\r\n}\r\n","import PrefabComponent from './PrefabComponent';\r\nimport Prefab from './Prefab';\r\nimport { camelString } from './util/string-util';\r\n\r\nexport class PrefabRegistry {\r\n    _prefabs = {};\r\n    _engine = null;\r\n\r\n    constructor(engine) {\r\n        this._engine = engine;\r\n    }\r\n\r\n    deserialize(data) {\r\n        const registered = this.get(data.name);\r\n\r\n        if (registered) {\r\n            return registered;\r\n        }\r\n\r\n        const prefab = new Prefab(data.name);\r\n\r\n        let inherit;\r\n\r\n        if (Array.isArray(data.inherit)) {\r\n            inherit = data.inherit;\r\n        } else if (typeof data.inherit === 'string') {\r\n            inherit = [data.inherit];\r\n        } else {\r\n            inherit = [];\r\n        }\r\n\r\n        prefab.inherit = inherit.map((parent) => {\r\n            const ref = this.get(parent);\r\n\r\n            if (!ref) {\r\n                console.warn(\r\n                    `Prefab \"${data.name}\" cannot inherit from Prefab \"${parent}\" because is not registered yet! Prefabs must be registered in the right order.`\r\n                );\r\n                return parent;\r\n            }\r\n\r\n            return ref;\r\n        });\r\n\r\n        const comps = data.components || [];\r\n\r\n        comps.forEach((componentData) => {\r\n            if (typeof componentData === 'string') {\r\n                const ckey = camelString(componentData);\r\n                const clazz = this._engine._components.get(ckey);\r\n\r\n                if (clazz) {\r\n                    prefab.addComponent(new PrefabComponent(clazz));\r\n\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (typeof componentData === 'object') {\r\n                const ckey = camelString(componentData.type);\r\n                const clazz = this._engine._components.get(ckey);\r\n\r\n                if (clazz) {\r\n                    prefab.addComponent(\r\n                        new PrefabComponent(\r\n                            clazz,\r\n                            componentData.properties,\r\n                            componentData.overwrite\r\n                        )\r\n                    );\r\n\r\n                    return;\r\n                }\r\n            }\r\n\r\n            console.warn(\r\n                `Unrecognized component reference \"${componentData}\" in prefab \"${data.name}\". Ensure the component is registered before the prefab.`\r\n            );\r\n        });\r\n\r\n        return prefab;\r\n    }\r\n\r\n    register(data) {\r\n        const prefab = this.deserialize(data);\r\n\r\n        this._prefabs[prefab.name] = prefab;\r\n    }\r\n\r\n    get(name) {\r\n        return this._prefabs[name];\r\n    }\r\n\r\n    create(world, name, properties = {}) {\r\n        const prefab = this.get(name);\r\n\r\n        if (!prefab) {\r\n            console.warn(\r\n                `Could not instantiate prefab \"${name}\" since it is not registered`\r\n            );\r\n\r\n            return;\r\n        }\r\n\r\n        const entity = world.createEntity();\r\n\r\n        entity._qeligible = false;\r\n\r\n        prefab.applyToEntity(entity, properties);\r\n\r\n        entity._qeligible = true;\r\n        entity._candidacy();\r\n\r\n        return entity;\r\n    }\r\n}\r\n","export class Component {\r\n    static allowMultiple = false;\r\n    static keyProperty = null;\r\n    static properties = {};\r\n\r\n    get world() {\r\n        return this.entity.world;\r\n    }\r\n\r\n    get allowMultiple() {\r\n        return this.constructor.allowMultiple;\r\n    }\r\n\r\n    get keyProperty() {\r\n        return this.constructor.keyProperty;\r\n    }\r\n\r\n    constructor(properties = {}) {\r\n        Object.assign(this, this.constructor.properties, properties);\r\n    }\r\n\r\n    destroy() {\r\n        this.entity.remove(this);\r\n    }\r\n\r\n    _onDestroyed() {\r\n        this.onDestroyed();\r\n        delete this.entity;\r\n    }\r\n\r\n    _onEvent(evt) {\r\n        this.onEvent(evt);\r\n\r\n        if (typeof this[evt.handlerName] === 'function') {\r\n            this[evt.handlerName](evt);\r\n        }\r\n    }\r\n\r\n    _onAttached(entity) {\r\n        this.entity = entity;\r\n        this.onAttached(entity);\r\n    }\r\n\r\n    serialize() {\r\n        const ob = {};\r\n\r\n        for (const key in this.constructor.properties) {\r\n            ob[key] = this[key];\r\n        }\r\n\r\n        return ob;\r\n    }\r\n\r\n    onAttached(entity) {}\r\n    onDestroyed() {}\r\n    onEvent(evt) {}\r\n}\r\n","import { camelString } from './util/string-util';\r\n\r\nexport class EntityEvent {\r\n    data = {};\r\n    prevented = false;\r\n    handled = false;\r\n\r\n    constructor(name, data = {}) {\r\n        this.name = name;\r\n        this.data = data;\r\n        this.handlerName = camelString(`on ${this.name}`);\r\n    }\r\n\r\n    is(name) {\r\n        return this.name === name;\r\n    }\r\n\r\n    handle() {\r\n        this.handled = true;\r\n        this.prevented = true;\r\n    }\r\n\r\n    prevent() {\r\n        this.prevented = true;\r\n    }\r\n}\r\n","const ONE = 1n;\r\n\r\nexport const subtractBit = (num, bit) => {\r\n    return num & ~(1n << bit);\r\n};\r\n\r\nexport const addBit = (num, bit) => {\r\n    return num | (ONE << bit);\r\n};\r\n\r\nexport const hasBit = (num, bit) => {\r\n    return (num >> bit) % 2n !== 0n;\r\n};\r\n\r\nexport const bitIntersection = (n1, n2) => {\r\n    return n1 & n2;\r\n};\r\n","import { Component } from './Component';\r\nimport { EntityEvent } from './EntityEvent';\r\nimport { addBit, hasBit, subtractBit } from './util/bit-util';\r\n\r\nconst attachComponent = (entity, component) => {\r\n    const key = component._ckey;\r\n\r\n    entity[key] = component;\r\n    entity.components[key] = component;\r\n};\r\n\r\nconst attachComponentKeyed = (entity, component) => {\r\n    const key = component._ckey;\r\n\r\n    if (!entity.components[key]) {\r\n        entity[key] = {};\r\n        entity.components[key] = {};\r\n    }\r\n\r\n    entity[key][component[component.keyProperty]] = component;\r\n    entity.components[key][component[component.keyProperty]] = component;\r\n};\r\n\r\nconst attachComponentArray = (entity, component) => {\r\n    const key = component._ckey;\r\n\r\n    if (!entity.components[key]) {\r\n        entity[key] = [];\r\n        entity.components[key] = [];\r\n    }\r\n\r\n    entity[key].push(component);\r\n    entity.components[key].push(component);\r\n};\r\n\r\nconst removeComponent = (entity, component) => {\r\n    const key = component._ckey;\r\n\r\n    delete entity[key];\r\n    delete entity.components[key];\r\n\r\n    entity._cbits = subtractBit(entity._cbits, component._cbit);\r\n    entity._candidacy();\r\n};\r\n\r\nconst removeComponentKeyed = (entity, component) => {\r\n    const key = component._ckey;\r\n    const keyProp = component[component.keyProperty];\r\n\r\n    delete entity[key][keyProp];\r\n    delete entity.components[key][keyProp];\r\n\r\n    if (Object.keys(entity[key]).length <= 0) {\r\n        delete entity[key];\r\n        delete entity.components[key];\r\n        entity._cbits = subtractBit(entity._cbits, component._cbit);\r\n        entity._candidacy();\r\n    }\r\n};\r\n\r\nconst removeComponentArray = (entity, component) => {\r\n    const key = component._ckey;\r\n    const idx = entity[key].indexOf(component);\r\n\r\n    entity[key].splice(idx, 1);\r\n    entity.components[key].splice(idx, 1);\r\n\r\n    if (entity[key].length <= 0) {\r\n        delete entity[key];\r\n        delete entity.components[key];\r\n        entity._cbits = subtractBit(entity._cbits, component._cbit);\r\n        entity._candidacy()\r\n    }\r\n};\r\n\r\nconst serializeComponent = (component) => {\r\n    return component.serialize();\r\n};\r\n\r\nconst serializeComponentArray = (arr) => {\r\n    return arr.map(serializeComponent);\r\n};\r\n\r\nconst serializeComponentKeyed = (ob) => {\r\n    const ser = {};\r\n\r\n    for (const k in ob) {\r\n        ser[k] = serializeComponent(ob[k]);\r\n    }\r\n\r\n    return ser;\r\n};\r\n\r\nexport class Entity {\r\n    _cbits = 0n;\r\n    _qeligible = true;\r\n\r\n    constructor(world, id) {\r\n        this.world = world;\r\n        this.id = id;\r\n        this.components = {};\r\n        this.isDestroyed = false;\r\n    }\r\n\r\n    _candidacy() {\r\n        if (this._qeligible) {\r\n            this.world._candidate(this);\r\n        }\r\n    }\r\n\r\n    add(clazz, properties) {\r\n        const component = new clazz(properties);\r\n\r\n        if (component.keyProperty) {\r\n            attachComponentKeyed(this, component);\r\n        } else if (component.allowMultiple) {\r\n            attachComponentArray(this, component);\r\n        } else {\r\n            attachComponent(this, component);\r\n        }\r\n\r\n        this._cbits = addBit(this._cbits, component._cbit);\r\n        component._onAttached(this);\r\n\r\n        this._candidacy();\r\n    }\r\n\r\n    has(clazz) {\r\n        return hasBit(this._cbits, clazz.prototype._cbit);\r\n    }\r\n\r\n    remove(component) {\r\n        if (component.keyProperty) {\r\n            removeComponentKeyed(this, component);\r\n        } else if (component.allowMultiple) {\r\n            removeComponentArray(this, component);\r\n        } else {\r\n            removeComponent(this, component);\r\n        }\r\n\r\n        component._onDestroyed();\r\n    }\r\n\r\n    destroy() {\r\n        for (const k in this.components) {\r\n            const v = this.components[k];\r\n\r\n            if (v instanceof Component) {\r\n                this._cbits = subtractBit(this._cbits, v._cbit);\r\n                v._onDestroyed();\r\n            } else if (v instanceof Array) {\r\n                for (const component of v) {\r\n                    this._cbits = subtractBit(this._cbits, component._cbit);\r\n                    component._onDestroyed();\r\n                }\r\n            } else {\r\n                for (const component of Object.values(v)) {\r\n                    this._cbits = subtractBit(this._cbits, component._cbit);\r\n                    component._onDestroyed();\r\n                }\r\n            }\r\n\r\n            delete this[k];\r\n            delete this.components[k];\r\n        }\r\n\r\n        this._candidacy();\r\n        this.world._destroyed(this.id);\r\n        this.components = {};\r\n        this.isDestroyed = true;\r\n    }\r\n\r\n    serialize() {\r\n        const components = {};\r\n\r\n        for (const k in this.components) {\r\n            const v = this.components[k];\r\n\r\n            if (v instanceof Component) {\r\n                components[k] = serializeComponent(v);\r\n            } else if (v instanceof Array) {\r\n                components[k] = serializeComponentArray(v);\r\n            } else {\r\n                components[k] = serializeComponentKeyed(v);\r\n            }\r\n        }\r\n\r\n        return {\r\n            id: this.id,\r\n            ...components,\r\n        };\r\n    }\r\n\r\n    fireEvent(name, data) {\r\n        const evt = new EntityEvent(name, data);\r\n\r\n        for (const key in this.components) {\r\n            const v = this.components[key];\r\n\r\n            if (v instanceof Component) {\r\n                v._onEvent(evt);\r\n\r\n                if (evt.prevented) {\r\n                    return evt;\r\n                }\r\n            } else if (v instanceof Array) {\r\n                for (let i = 0; i < v.length; i++) {\r\n                    v[i]._onEvent(evt);\r\n\r\n                    if (evt.prevented) {\r\n                        return evt;\r\n                    }\r\n                }\r\n            } else {\r\n                for (const component of Object.values(v)) {\r\n                    component._onEvent(evt);\r\n\r\n                    if (evt.prevented) {\r\n                        return evt;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return evt;\r\n    }\r\n}\r\n","import { addBit, bitIntersection } from './util/bit-util';\r\n\r\nexport class Query {\r\n    _cache = [];\r\n    _onAddListeners = [];\r\n    _onRemoveListeners = [];\r\n\r\n    constructor(world, filters) {\r\n        this._world = world;\r\n\r\n        const any = filters.any || [];\r\n        const all = filters.all || [];\r\n        const none = filters.none || [];\r\n\r\n        this._any = any.reduce((s, c) => {\r\n            return addBit(s, c.prototype._cbit);\r\n        }, 0n);\r\n\r\n        this._all = all.reduce((s, c) => {\r\n            return addBit(s, c.prototype._cbit);\r\n        }, 0n);\r\n\r\n        this._none = none.reduce((s, c) => {\r\n            return addBit(s, c.prototype._cbit);\r\n        }, 0n);\r\n\r\n        this.refresh();\r\n    }\r\n\r\n    onEntityAdded(fn) {\r\n        this._onAddListeners.push(fn);\r\n    }\r\n\r\n    onEntityRemoved(fn) {\r\n        this._onRemoveListeners.push(fn);\r\n    }\r\n\r\n    has(entity) {\r\n        return this.idx(entity) >= 0;\r\n    }\r\n\r\n    idx(entity) {\r\n        return this._cache.indexOf(entity);\r\n    }\r\n\r\n    matches(entity) {\r\n        const bits = entity._cbits;\r\n\r\n        const any = this._any === 0n || bitIntersection(bits, this._any) > 0;\r\n        const all = bitIntersection(bits, this._all) === this._all;\r\n        const none = bitIntersection(bits, this._none) === 0n;\r\n\r\n        return any && all && none;\r\n    }\r\n\r\n    candidate(entity) {\r\n        const idx = this.idx(entity);\r\n        const isTracking = idx >= 0;\r\n\r\n        if (!entity.isDestroyed && this.matches(entity)) {\r\n            if (!isTracking) {\r\n                this._cache.push(entity);\r\n                this._onAddListeners.forEach((cb) => cb(entity));\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        if (isTracking) {\r\n            this._cache.splice(idx, 1);\r\n            this._onRemoveListeners.forEach((cb) => cb(entity));\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    refresh() {\r\n        this._cache = [];\r\n        this._world._entities.forEach((entity) => {\r\n            this.candidate(entity);\r\n        });\r\n    }\r\n\r\n    get() {\r\n        return this._cache;\r\n    }\r\n}\r\n","import { Entity } from './Entity';\r\nimport { Query } from './Query';\r\nimport { camelString } from './util/string-util';\r\n\r\nexport class World {\r\n    _id = 0;\r\n    _queries = [];\r\n    _entities = new Map();\r\n\r\n    constructor(engine) {\r\n        this.engine = engine;\r\n    }\r\n\r\n    createId() {\r\n        return ++this._id + Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    getEntity(id) {\r\n        return this._entities.get(id);\r\n    }\r\n\r\n    getEntities() {\r\n        return this._entities.values();\r\n    }\r\n\r\n    createEntity(id = this.createId()) {\r\n        const entity = new Entity(this, id);\r\n\r\n        this._entities.set(id, entity);\r\n\r\n        return entity;\r\n    }\r\n\r\n    destroyEntity(id) {\r\n        const entity = this.getEntity(id);\r\n\r\n        if (entity) {\r\n            entity.destroy();\r\n        }\r\n    }\r\n\r\n    destroyEntities() {\r\n        this._entities.forEach((entity) => {\r\n            entity.destroy();\r\n        });\r\n    }\r\n\r\n    destroy() {\r\n        this.destroyEntities();\r\n        this._id = 0;\r\n        this._queries = [];\r\n        this._entities = new Map();\r\n    }\r\n\r\n    createQuery(filters) {\r\n        const query = new Query(this, filters);\r\n\r\n        this._queries.push(query);\r\n\r\n        return query;\r\n    }\r\n\r\n    createPrefab(name, properties = {}) {\r\n        return this.engine._prefabs.create(this, name, properties);\r\n    }\r\n\r\n    serialize(entities) {\r\n        const json = [];\r\n        const list = entities || this._entities;\r\n\r\n        list.forEach((e) => {\r\n            json.push(e.serialize());\r\n        });\r\n\r\n        return {\r\n            entities: json,\r\n        };\r\n    }\r\n\r\n    deserialize(data) {\r\n        for (const entityData of data.entities) {\r\n            this._createOrGetEntityById(entityData.id);\r\n        }\r\n\r\n        for (const entityData of data.entities) {\r\n            this._deserializeEntity(entityData);\r\n        }\r\n    }\r\n\r\n    _createOrGetEntityById(id) {\r\n        return this.getEntity(id) || this.createEntity(id);\r\n    }\r\n\r\n    _deserializeEntity(data) {\r\n        const { id, ...components } = data;\r\n        const entity = this._createOrGetEntityById(id);\r\n        entity._qeligible = false;\r\n\r\n        Object.entries(components).forEach(([key, value]) => {\r\n            const type = camelString(key);\r\n            const def = this.engine._components.get(type);\r\n\r\n            if (def.allowMultiple) {\r\n                Object.values(value).forEach((d) => {\r\n                    entity.add(def, d);\r\n                });\r\n            } else {\r\n                entity.add(def, value);\r\n            }\r\n        });\r\n\r\n        entity._qeligible = true;\r\n        entity._candidacy();\r\n    }\r\n\r\n    _candidate(entity) {\r\n        this._queries.forEach((q) => q.candidate(entity));\r\n    }\r\n\r\n    _destroyed(id) {\r\n        return this._entities.delete(id);\r\n    }\r\n}\r\n","import { ComponentRegistry } from './ComponentRegistry';\r\nimport { PrefabRegistry } from './PrefabRegistry';\r\nimport { World } from './World';\r\n\r\nexport class Engine {\r\n    _components = new ComponentRegistry();\r\n    _prefabs = new PrefabRegistry(this);\r\n\r\n    registerComponent(clazz) {\r\n        this._components.register(clazz);\r\n    }\r\n\r\n    registerPrefab(data) {\r\n        this._prefabs.register(data);\r\n    }\r\n\r\n    createWorld() {\r\n        return new World(this);\r\n    }\r\n\r\n    destroyWorld(world) {\r\n        world.destroy();\r\n    }\r\n}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Ai extends Component {}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Animate extends Component {\r\n  static allowMultiple = true;\r\n  static properties = {\r\n    startTime: null,\r\n    duration: 250,\r\n    char: '',\r\n    color: '',\r\n  };\r\n\r\n  onSetStartTime(evt) {\r\n    this.startTime = evt.data.time;\r\n  }\r\n}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Layer100 extends Component {}\r\nexport class Layer300 extends Component {}\r\nexport class Layer400 extends Component {}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Dropped extends Component {}\r\nexport class IsBlocking extends Component {}\r\nexport class IsDead extends Component {}\r\nexport class IsEquippable extends Component {}\r\nexport class IsEquipped extends Component {}\r\nexport class IsInFov extends Component {}\r\nexport class IsOpaque extends Component {}\r\nexport class IsPickup extends Component {}\r\nexport class IsRevealed extends Component {}\r\nexport class IsStairs extends Component {}\r\n","import { Component } from 'geotic';\r\nimport { Ai } from './Ai';\r\nimport { Layer300, Layer400 } from './Layers';\r\nimport { IsBlocking, IsDead } from './Status';\r\n\r\nexport class Defense extends Component {\r\n  static properties = { base: 1, current: 1 };\r\n}\r\n\r\nexport class Health extends Component {\r\n  static properties = { base: 10, current: 10 };\r\n\r\n  onTakeDamage(evt) {\r\n    this.current -= evt.data.amount;\r\n\r\n    if (this.current <= 0) {\r\n      if (this.entity.has(Ai)) {\r\n        this.entity.remove(this.entity.ai);\r\n      }\r\n      if (this.entity.has(IsBlocking)) {\r\n        this.entity.remove(this.entity.isBlocking);\r\n      }\r\n      if (this.entity.has(Layer400)) {\r\n        this.entity.remove(this.entity.layer400);\r\n      }\r\n\r\n      this.entity.add(IsDead);\r\n      this.entity.add(Layer300);\r\n      this.entity.appearance.char = '%';\r\n    }\r\n    evt.handle();\r\n  }\r\n}\r\n\r\nexport class Power extends Component {\r\n  static properties = { base: 5, current: 5 };\r\n}\r\n","import { Component } from 'geotic';\r\n\r\nconst effectProps = {\r\n  component: '',\r\n  delta: '',\r\n  animate: { char: '', color: '' },\r\n  events: [], // { name: \"\", args: {} },\r\n  addComponents: [], // { name: '', properties: {} }\r\n  duration: 0, // in turns\r\n};\r\nexport class ActiveEffects extends Component {\r\n  static allowMultiple = true;\r\n  static properties = effectProps;\r\n}\r\n\r\nexport class Effects extends Component {\r\n  static allowMultiple = true;\r\n  static properties = effectProps;\r\n}\r\n","import { Component } from 'geotic';\r\nexport class Slot extends Component {\r\n  static properties = { name: '' };\r\n}\r\n\r\nexport class EquipmentEffect extends Component {\r\n  static allowMultiple = true;\r\n  static properties = {\r\n    component: '',\r\n    delta: '',\r\n  };\r\n}\r\n\r\nexport class EquipmentSlot extends Component {\r\n  static allowMultiple = true;\r\n  static keyProperty = 'name';\r\n\r\n  static properties = {\r\n    name: '',\r\n    itemId: this.itemId,\r\n  };\r\n\r\n  get item() {\r\n    return this.world.getEntity(this.itemId);\r\n  }\r\n\r\n  set item(entity) {\r\n    return (this.itemId = entity.id);\r\n  }\r\n\r\n  onEquip(evt) {\r\n    if (!evt.data.equipmentEffect) return;\r\n    evt.data.equipmentEffect.forEach((effect) => {\r\n      if (effect.component === 'health') {\r\n        this.entity[effect.component].base += effect.delta;\r\n      }\r\n      this.entity[effect.component].current += effect.delta;\r\n    });\r\n    evt.handle();\r\n  }\r\n\r\n  onUnequip(evt) {\r\n    if (!evt.data.equipmentEffect) return;\r\n    evt.data.equipmentEffect.forEach((effect) => {\r\n      if (effect.component === 'health') {\r\n        this.entity[effect.component].base -= effect.delta;\r\n      }\r\n      this.entity[effect.component].current -= effect.delta;\r\n    });\r\n    evt.handle();\r\n  }\r\n}\r\n","import { Component } from 'geotic';\r\nimport { addCacheSet, deleteCacheSet } from '../cache';\r\n\r\nexport class Position extends Component {\r\n  static properties = { x: 0, y: 0, z: -1 };\r\n  onAttached() {\r\n    const locId = `${this.entity.position.x},${this.entity.position.y},${this.entity.position.z}`;\r\n\r\n    addCacheSet('entitiesAtLocation', locId, this.entity.id);\r\n  }\r\n\r\n  onDestroyed() {\r\n    const locId = `${this.x},${this.y},${this.z}`;\r\n    deleteCacheSet('entitiesAtLocation', locId, this.entity.id);\r\n  }\r\n}\r\n","import { Component } from 'geotic';\r\nimport { getEntityArrayRef } from '../../utils/ecs-refs';\r\nimport { Position } from './Position';\r\nimport { IsPickup } from './Status';\r\n\r\nexport class Inventory extends Component {\r\n  static properties = {\r\n    inventoryItemIds: [],\r\n  };\r\n\r\n  get inventoryItems() {\r\n    return getEntityArrayRef(this, 'inventoryItemIds');\r\n  }\r\n\r\n  onPickUp(evt) {\r\n    this.inventoryItemIds.push(evt.data.id);\r\n\r\n    if (evt.data.position) {\r\n      evt.data.remove(evt.data.position);\r\n      evt.data.remove(evt.data.isPickup);\r\n    }\r\n  }\r\n\r\n  onDrop(evt) {\r\n    this.inventoryItemIds = this.inventoryItemIds.filter(\r\n      (itemId) => itemId !== evt.data.id\r\n    );\r\n    console.log(evt);\r\n    evt.data.add(Position, {\r\n      x: this.entity.position.x,\r\n      y: this.entity.position.y,\r\n      z: this.entity.position.z,\r\n    });\r\n    evt.data.add(IsPickup);\r\n  }\r\n\r\n  onConsume(evt) {\r\n    this.inventoryItemIds = this.inventoryItemIds.filter(\r\n      (itemId) => itemId !== evt.data.id\r\n    );\r\n\r\n    evt.data.destroy();\r\n  }\r\n}\r\n","export const getEntityRef = (entity, idProp) => {\r\n  const id = entity[idProp];\r\n\r\n  if (!id) {\r\n    return;\r\n  }\r\n\r\n  const targetEntity = entity.world.getEntity(id);\r\n\r\n  if (!targetEntity) {\r\n    entity[idProp] = undefined;\r\n  }\r\n\r\n  return;\r\n};\r\n\r\nexport const setEntityRef = (entity, idProp, value) => {\r\n  let id = value;\r\n\r\n  if (!(value instanceof String)) {\r\n    id = value.id;\r\n  }\r\n\r\n  entity[idProp] = id;\r\n};\r\n\r\nexport const getEntityArrayRef = (entity, idArrayProp) => {\r\n  const ids = entity[idArrayProp];\r\n  const newIds = [];\r\n  const entities = [];\r\n\r\n  for (const id of ids) {\r\n    const targetEntity = entity.world.getEntity(id);\r\n\r\n    if (!targetEntity) {\r\n      entity[idProp] = undefined;\r\n    } else {\r\n      newIds.push(id);\r\n      entities.push(targetEntity);\r\n    }\r\n  }\r\n\r\n  entity[idArrayProp] = newIds;\r\n\r\n  return entities;\r\n};\r\n","import { Component } from 'geotic';\r\n\r\nexport class Description extends Component {\r\n  static properties = { name: 'No Name' };\r\n}\r\n\r\nexport class Appearance extends Component {\r\n  static properties = {\r\n    color: '#ff0077',\r\n    char: '?',\r\n    background: '#000',\r\n  };\r\n}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Move extends Component {\r\n  static properties = { x: 0, y: 0, z: 0, relative: true };\r\n}\r\n","import { Component } from 'geotic';\r\n\r\nexport class Frozen extends Component {}\r\nexport class Paralyzed extends Component {}\r\nexport class Poisoned extends Component {}\r\n","import { Component } from 'geotic';\r\nimport { getEntityRef, setEntityRef } from '../../utils/ecs-refs';\r\n\r\nexport class RequiresTarget extends Component {\r\n  static properties = {\r\n    acquired: 'RANDOM',\r\n    aoeRange: 0,\r\n  };\r\n}\r\n\r\nexport class Target extends Component {\r\n  static allowMultiple = true;\r\n  static properties = { locId: '' };\r\n}\r\n\r\nexport class TargetingItem extends Component {\r\n  static properties = { itemId: 0 };\r\n\r\n  get item() {\r\n    return getEntityRef(this, 'itemId');\r\n  }\r\n\r\n  set item(value) {\r\n    setEntityRef(this, 'itemId', value);\r\n  }\r\n}\r\n","// ---------- Base>> ---------- //\r\nexport const Tile = {\r\n  name: 'Tile',\r\n  components: [\r\n    { type: 'Appearance' },\r\n    { type: 'Description' },\r\n    { type: 'Layer100' },\r\n  ],\r\n};\r\n\r\nexport const Being = {\r\n  name: 'Being',\r\n  components: [\r\n    { type: 'Appearance' },\r\n    { type: 'Defense' },\r\n    { type: 'Description' },\r\n    { type: 'Health' },\r\n    { type: 'IsBlocking' },\r\n    { type: 'Layer400' },\r\n    { type: 'Power' },\r\n  ],\r\n};\r\n\r\nexport const Item = {\r\n  name: 'Item',\r\n  components: [\r\n    { type: 'Appearance' },\r\n    { type: 'Description' },\r\n    { type: 'Layer300' },\r\n    { type: 'IsPickup' },\r\n  ],\r\n};\r\n// ---------- <<Base ---------- //\r\n\r\n// ---------- Complex>> ---------- //\r\n// ---------- Tiles> ---------- //\r\nexport const Wall = {\r\n  name: 'Wall',\r\n  inherit: ['Tile'],\r\n  components: [\r\n    {\r\n      type: 'IsBlocking',\r\n    },\r\n    {\r\n      type: 'IsOpaque',\r\n    },\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '',\r\n        color: '#AAA',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'wall',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Floor = {\r\n  name: 'Floor',\r\n  inherit: ['Tile'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '',\r\n        color: '#333',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'floor',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const StairsUp = {\r\n  name: 'StairsUp',\r\n  inherit: ['Tile'],\r\n  components: [\r\n    {\r\n      type: 'IsStairs',\r\n    },\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '<',\r\n        color: '#AAA',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'set of stairs leading up',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const StairsDown = {\r\n  name: 'StairsDown',\r\n  inherit: ['Tile'],\r\n  components: [\r\n    {\r\n      type: 'IsStairs',\r\n    },\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '>',\r\n        color: '#AAA',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'set of stairs leading down',\r\n      },\r\n    },\r\n  ],\r\n};\r\n// ---------- <Tiles ---------- //\r\n\r\n// ---------- Beings> ---------- //\r\nexport const Player = {\r\n  name: 'Player',\r\n  inherit: ['Being'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: { char: '@', color: '#FFF' },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'You' },\r\n    },\r\n    { type: 'Inventory' },\r\n  ],\r\n};\r\n\r\nexport const Goblin = {\r\n  name: 'Goblin',\r\n  inherit: ['Being'],\r\n  components: [\r\n    { type: 'Ai' },\r\n    {\r\n      type: 'Appearance',\r\n      properties: { char: 'g', color: 'green' },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'goblin' },\r\n    },\r\n    { type: 'Power', properties: { base: 2, current: 2 } },\r\n    { type: 'Health', properties: { base: 7, current: 7 } },\r\n  ],\r\n};\r\n\r\nexport const GoblinWarrior = {\r\n  name: 'GoblinWarrior',\r\n  inherit: ['Being'],\r\n  components: [\r\n    { type: 'Ai' },\r\n    {\r\n      type: 'Appearance',\r\n      properties: { char: 'w', color: 'green' },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'goblin warrior' },\r\n    },\r\n    { type: 'Defense', properties: { base: 2, current: 2 } },\r\n    { type: 'Power', properties: { base: 4, current: 4 } },\r\n  ],\r\n};\r\n// ---------- <Beings ---------- //\r\n\r\n// ---------- Items> ---------- //\r\nexport const Gear = {\r\n  name: 'Gear',\r\n  inherit: ['Item'],\r\n  components: [{ type: 'IsEquippable' }],\r\n};\r\n\r\n// Complex\r\nexport const Weapon = {\r\n  name: 'Weapon',\r\n  inherit: ['Gear'],\r\n  components: [\r\n    { type: 'Appearance', properties: { char: '', color: '#0066ff' } },\r\n\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'weapon' },\r\n    },\r\n    {\r\n      type: 'Slot',\r\n      properties: {\r\n        name: 'weapon',\r\n      },\r\n    },\r\n    {\r\n      type: 'EquipmentEffect',\r\n      properties: {\r\n        component: 'power',\r\n        delta: 1,\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Armor = {\r\n  name: 'Armor',\r\n  inherit: ['Gear'],\r\n  components: [\r\n    { type: 'Appearance', properties: { char: '', color: '#ff99ff' } },\r\n\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'armor piece' },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Chest = {\r\n  name: 'Chest',\r\n  inherit: ['Armor'],\r\n  components: [\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'chest piece' },\r\n    },\r\n    {\r\n      type: 'Slot',\r\n      properties: {\r\n        name: 'chest',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Helmet = {\r\n  name: 'Helmet',\r\n  inherit: ['Armor'],\r\n  components: [\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'helmet' },\r\n    },\r\n    {\r\n      type: 'Slot',\r\n      properties: {\r\n        name: 'head',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Shield = {\r\n  name: 'Shield',\r\n  inherit: ['Armor'],\r\n  components: [\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'shield' },\r\n    },\r\n    {\r\n      type: 'Slot',\r\n      properties: {\r\n        name: 'shield',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const Boots = {\r\n  name: 'Boots',\r\n  inherit: ['Armor'],\r\n  components: [\r\n    {\r\n      type: 'Description',\r\n      properties: { name: 'boots' },\r\n    },\r\n    {\r\n      type: 'Slot',\r\n      properties: {\r\n        name: 'legs',\r\n      },\r\n    },\r\n  ],\r\n};\r\nexport const HealthPotion = {\r\n  name: 'HealthPotion',\r\n  inherit: ['Item'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '!',\r\n        color: '#DAA520',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'health potion',\r\n      },\r\n    },\r\n    {\r\n      type: 'Effects',\r\n      properties: {\r\n        component: 'health',\r\n        delta: 5,\r\n        animate: {\r\n          color: '#ff0000',\r\n          char: '',\r\n        },\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const ManaPotion = {\r\n  name: 'ManaPotion',\r\n  inherit: ['Item'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '&',\r\n        color: '#12A520',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'mana potion',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const ScrollLightning = {\r\n  name: 'ScrollLightning',\r\n  inherit: ['Item'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '',\r\n        color: '#DAA520',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'scroll of lightning',\r\n      },\r\n    },\r\n    {\r\n      type: 'Effects',\r\n      properties: {\r\n        animate: {\r\n          color: '#F7FF00',\r\n        },\r\n        events: [\r\n          {\r\n            name: 'take-damage',\r\n            args: {\r\n              amount: 25,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      type: 'RequiresTarget',\r\n      properties: {\r\n        acquired: 'RANDOM',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const ScrollParalyze = {\r\n  name: 'ScrollParalyze',\r\n  inherit: ['Item'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '',\r\n        color: '#DAA520',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'scroll of paralyze',\r\n      },\r\n    },\r\n    {\r\n      type: 'Effects',\r\n      properties: {\r\n        animate: {\r\n          color: '#FFB0B0',\r\n        },\r\n        addComponents: [\r\n          {\r\n            name: 'Paralyzed',\r\n            properties: {},\r\n          },\r\n        ],\r\n        duration: 10,\r\n      },\r\n    },\r\n    {\r\n      type: 'RequiresTarget',\r\n      properties: {\r\n        acquired: 'MANUAL',\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const ScrollFireball = {\r\n  name: 'ScrollFireball',\r\n  inherit: ['Item'],\r\n  components: [\r\n    {\r\n      type: 'Appearance',\r\n      properties: {\r\n        char: '',\r\n        color: '#DAA520',\r\n      },\r\n    },\r\n    {\r\n      type: 'Description',\r\n      properties: {\r\n        name: 'scroll of fireball',\r\n      },\r\n    },\r\n    {\r\n      type: 'Effects',\r\n      properties: {\r\n        animate: {\r\n          color: '#FFA200',\r\n          char: '^',\r\n        },\r\n        events: [\r\n          {\r\n            name: 'take-damage',\r\n            args: {\r\n              amount: 25,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      type: 'RequiresTarget',\r\n      properties: {\r\n        acquired: 'MANUAL',\r\n        aoeRange: 3,\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\n// ---------- <Items ---------- //\r\n// ---------- <<Complex ---------- //\r\n","import { Engine } from 'geotic';\r\nimport {\r\n  ActiveEffects,\r\n  Ai,\r\n  Animate,\r\n  Appearance,\r\n  Defense,\r\n  Description,\r\n  Dropped,\r\n  Effects,\r\n  EquipmentEffect,\r\n  EquipmentSlot,\r\n  Health,\r\n  Inventory,\r\n  IsBlocking,\r\n  IsDead,\r\n  IsEquippable,\r\n  IsEquipped,\r\n  IsInFov,\r\n  IsOpaque,\r\n  IsPickup,\r\n  IsRevealed,\r\n  IsStairs,\r\n  Layer100,\r\n  Layer300,\r\n  Layer400,\r\n  Move,\r\n  Paralyzed,\r\n  Position,\r\n  Power,\r\n  RequiresTarget,\r\n  Slot,\r\n  Target,\r\n  TargetingItem,\r\n} from './components/';\r\nimport {\r\n  Armor,\r\n  Being,\r\n  Boots,\r\n  Chest,\r\n  Floor,\r\n  Gear,\r\n  Goblin,\r\n  GoblinWarrior,\r\n  HealthPotion,\r\n  Helmet,\r\n  Item,\r\n  Player,\r\n  ScrollFireball,\r\n  ScrollLightning,\r\n  ScrollParalyze,\r\n  Shield,\r\n  StairsDown,\r\n  StairsUp,\r\n  Tile,\r\n  Wall,\r\n  Weapon,\r\n} from './prefabs';\r\n\r\nexport const ecs = new Engine();\r\n\r\n// all Components must be `registered` by the engine\r\necs.registerComponent(ActiveEffects);\r\necs.registerComponent(Animate);\r\necs.registerComponent(Ai);\r\necs.registerComponent(Appearance);\r\necs.registerComponent(Description);\r\necs.registerComponent(Defense);\r\necs.registerComponent(Dropped);\r\necs.registerComponent(Effects);\r\necs.registerComponent(EquipmentSlot);\r\necs.registerComponent(EquipmentEffect);\r\necs.registerComponent(Health);\r\necs.registerComponent(Inventory);\r\necs.registerComponent(IsBlocking);\r\necs.registerComponent(IsDead);\r\necs.registerComponent(IsEquippable);\r\necs.registerComponent(IsEquipped);\r\necs.registerComponent(IsInFov);\r\necs.registerComponent(IsOpaque);\r\necs.registerComponent(IsPickup);\r\necs.registerComponent(IsRevealed);\r\necs.registerComponent(IsStairs);\r\necs.registerComponent(Layer100);\r\necs.registerComponent(Layer300);\r\necs.registerComponent(Layer400);\r\necs.registerComponent(Move);\r\necs.registerComponent(RequiresTarget);\r\necs.registerComponent(Paralyzed);\r\necs.registerComponent(Position);\r\necs.registerComponent(Power);\r\necs.registerComponent(Slot);\r\necs.registerComponent(Target);\r\necs.registerComponent(TargetingItem);\r\n\r\n// register \"primitives\" first!\r\n\r\n// register \"base\" prefabs first!\r\necs.registerPrefab(Tile);\r\necs.registerPrefab(Being);\r\necs.registerPrefab(Item);\r\necs.registerPrefab(Gear);\r\n\r\n// tiles\r\necs.registerPrefab(Floor);\r\necs.registerPrefab(StairsDown);\r\necs.registerPrefab(StairsUp);\r\necs.registerPrefab(Wall);\r\n\r\n// items\r\necs.registerPrefab(HealthPotion);\r\necs.registerPrefab(ScrollFireball);\r\necs.registerPrefab(ScrollLightning);\r\necs.registerPrefab(ScrollParalyze);\r\n\r\n// equipment\r\necs.registerPrefab(Armor);\r\necs.registerPrefab(Boots);\r\necs.registerPrefab(Chest);\r\necs.registerPrefab(Helmet);\r\necs.registerPrefab(Shield);\r\necs.registerPrefab(Weapon);\r\n\r\n// enemies\r\necs.registerPrefab(Goblin);\r\necs.registerPrefab(GoblinWarrior);\r\n\r\n// player\r\necs.registerPrefab(Player);\r\n\r\nconst world = ecs.createWorld();\r\nexport default world;\r\n","export const WEAPON_PREFIXES = {\r\n  glinting: {\r\n    component: 'power',\r\n    delta: 1,\r\n  },\r\n  polished: {\r\n    component: 'power',\r\n    delta: 3,\r\n  },\r\n  tempered: {\r\n    component: 'power',\r\n    delta: 5,\r\n  },\r\n};\r\n\r\nexport const ARMOR_PREFIXES = {\r\n  healthy: {\r\n    component: 'health',\r\n    delta: 1,\r\n  },\r\n  stalwart: {\r\n    component: 'health',\r\n    delta: 2,\r\n  },\r\n  virile: {\r\n    component: 'health',\r\n    delta: 3,\r\n  },\r\n};\r\n\r\nexport const ARMOR_SUFFIXES = {\r\n  laquered: {\r\n    component: 'defense',\r\n    delta: 1,\r\n  },\r\n  fortified: {\r\n    component: 'defense',\r\n    delta: 2,\r\n  },\r\n  plated: {\r\n    component: 'defense',\r\n    delta: 3,\r\n  },\r\n};\r\n","export const toCamelCase = (string) => {\r\n  return string[0].toLowerCase() + string.slice(1);\r\n};\r\n\r\n/**\r\n * returns highest match to a given needle, that doesn't exceed needle\r\n *\r\n * @param {Array} array\r\n * @param {Number} needle\r\n * @returns\r\n */\r\nexport const getHighestMatch = (array, needle) => {\r\n  let highest_match;\r\n  for (let floor of array) {\r\n    if (floor > needle) {\r\n      break;\r\n    }\r\n    highest_match = floor;\r\n  }\r\n  return highest_match;\r\n};\r\n\r\n/**\r\n * gets weighted chances for all entities based on the level provided\r\n * Object structure:\r\n *   level: [{entity, weight}, {entity, weight}] *\r\n *\r\n * @param {Object} weightedChances\r\n * @param {Number} level\r\n * @returns {Object}\r\n */\r\nexport const getEntityChancesForLevel = (weightedChances, level) => {\r\n  const entityWeightedChances = {};\r\n\r\n  for (const floor in weightedChances) {\r\n    if (floor > level) {\r\n      break;\r\n    } else {\r\n      weightedChances[floor].forEach((entity) => {\r\n        entityWeightedChances[entity.name] = entity.weight;\r\n      });\r\n    }\r\n  }\r\n  return entityWeightedChances;\r\n};\r\n\r\n/**\r\n * gets weighted key based on values from an object\r\n * Object structure\r\n * data: {key: weighting}\r\n *\r\n * @param {object} data\r\n * @returns key\r\n */\r\nexport const getWeightedValue = (data) => {\r\n  let total = 0;\r\n\r\n  for (let key in data) {\r\n    total += data[key];\r\n  }\r\n\r\n  let random = Math.random() * total;\r\n  let key,\r\n    part = 0;\r\n  for (key in data) {\r\n    part += data[key];\r\n    if (random < part) {\r\n      return key;\r\n    }\r\n  }\r\n\r\n  // If by some floating-point annoyance we have\r\n  // random >= total, just return the last id.\r\n  return key;\r\n};\r\n","import { grid } from './canvas';\r\n\r\nexport const DUNGEON_LAYOUT = {\r\n  1: {\r\n    maxRoomCount: 6,\r\n    width: Math.round(grid.map.width * 0.6),\r\n    height: Math.round(grid.map.height * 0.6),\r\n  },\r\n  5: {\r\n    maxRoomCount: 12,\r\n    width: Math.round(grid.map.width * 0.8),\r\n    height: Math.round(grid.map.height * 0.8),\r\n  },\r\n  9: {\r\n    maxRoomCount: 18,\r\n    width: grid.map.width,\r\n    height: grid.map.height,\r\n  },\r\n  14: {\r\n    maxRoomCount: 24,\r\n    width: grid.map.width,\r\n    height: grid.map.height,\r\n  },\r\n  19: { maxRoomCount: 30, width: grid.map.width, height: grid.map.height },\r\n};\r\n","export const MAX_ITEMS_BY_FLOOR = {\r\n  // floor: items\r\n  1: 2,\r\n  5: 3,\r\n  9: 5,\r\n  14: 7,\r\n  19: 10,\r\n};\r\n\r\nexport const ITEM_WEIGHT = {\r\n  0: [\r\n    { name: 'HealthPotion', weight: 50 },\r\n    { name: 'Weapon', weight: 30 },\r\n    { name: 'Shield', weight: 20 },\r\n    { name: 'Boots', weight: 20 },\r\n    { name: 'Helmet', weight: 20 },\r\n    { name: 'Chest', weight: 20 },\r\n  ],\r\n  2: [{ name: 'ScrollParalyze', weight: 10 }],\r\n  4: [{ name: 'ScrollLightning', weight: 25 }],\r\n  6: [{ name: 'ScrollFireball', weight: 25 }],\r\n};\r\n\r\nexport const MAX_MONSTERS_BY_FLOOR = {\r\n  // floor: monsters\r\n  1: 3,\r\n  5: 6,\r\n  9: 9,\r\n  14: 12,\r\n  19: 15,\r\n};\r\n\r\nexport const MONSTER_WEIGHT = {\r\n  0: [{ name: 'Goblin', weight: 80 }],\r\n  3: [{ name: 'GoblinWarrior', weight: 15 }],\r\n  5: [{ name: 'GoblinWarrior', weight: 30 }],\r\n  7: [{ name: 'GoblinWarrior', weight: 60 }],\r\n};\r\n","import random from 'lodash/random';\r\nimport sample from 'lodash/sample';\r\nimport times from 'lodash/times';\r\nimport { readCache } from '../state/cache';\r\nimport {\r\n  Dropped,\r\n  EquipmentEffect,\r\n  IsEquippable,\r\n  IsPickup,\r\n  Position,\r\n} from '../state/components/';\r\nimport world from '../state/ecs';\r\nimport {\r\n  ARMOR_PREFIXES,\r\n  ARMOR_SUFFIXES,\r\n  WEAPON_PREFIXES,\r\n} from '../systems/affix';\r\nimport {\r\n  getEntityChancesForLevel,\r\n  getHighestMatch,\r\n  getWeightedValue,\r\n} from '../utils/misc';\r\nimport { grid } from './canvas';\r\nimport { DUNGEON_LAYOUT } from './dungeon_layout';\r\nimport { rectangle, rectsIntersect } from './grid';\r\nimport {\r\n  ITEM_WEIGHT,\r\n  MAX_ITEMS_BY_FLOOR,\r\n  MAX_MONSTERS_BY_FLOOR,\r\n  MONSTER_WEIGHT,\r\n} from './level_entities';\r\n\r\nfunction digHorizontalPassage(x1, x2, y, z) {\r\n  const tiles = {};\r\n  const start = Math.min(x1, x2);\r\n  const end = Math.max(x1, x2) + 1;\r\n  let x = start;\r\n\r\n  while (x < end) {\r\n    tiles[`${x},${y},${z}`] = { x, y, z, sprite: 'FLOOR' };\r\n    x++;\r\n  }\r\n  return tiles;\r\n}\r\n\r\nfunction digVerticalPassage(y1, y2, x, z) {\r\n  const tiles = {};\r\n  const start = Math.min(y1, y2);\r\n  const end = Math.max(y1, y2) + 1;\r\n  let y = start;\r\n\r\n  while (y < end) {\r\n    tiles[`${x},${y},${z}`] = { x, y, z, sprite: 'FLOOR' };\r\n    y++;\r\n  }\r\n\r\n  return tiles;\r\n}\r\n\r\nexport const createDungeon = ({\r\n  x,\r\n  y,\r\n  z,\r\n  width,\r\n  height,\r\n  minRoomSize = 6,\r\n  maxRoomSize = 12,\r\n  maxRoomCount = 30,\r\n}) => {\r\n  // fill with walls that can be digged out later\r\n  const dungeon = rectangle({ x, y, z, width, height }, { sprite: 'WALL' });\r\n\r\n  const rooms = [];\r\n  let roomTiles = {};\r\n\r\n  times(maxRoomCount, () => {\r\n    let rw = random(minRoomSize, maxRoomSize);\r\n    let rh = random(minRoomSize, maxRoomSize);\r\n    let rx = random(x, width + x - rw);\r\n    let ry = random(y, height + y - rh);\r\n\r\n    const candidate = rectangle(\r\n      { x: rx, y: ry, z, width: rw, height: rh, hasWalls: true },\r\n      { sprite: 'FLOOR' }\r\n    );\r\n\r\n    if (!rooms.some((room) => rectsIntersect(room, candidate))) {\r\n      rooms.push(candidate);\r\n      roomTiles = { ...roomTiles, ...candidate.tiles };\r\n    }\r\n  });\r\n\r\n  let prevRoom = null;\r\n  let passageTiles;\r\n\r\n  for (let room of rooms) {\r\n    if (prevRoom) {\r\n      const prev = prevRoom.center;\r\n      const curr = room.center;\r\n\r\n      passageTiles = {\r\n        ...passageTiles,\r\n        ...digHorizontalPassage(prev.x, curr.x, curr.y, z),\r\n        ...digVerticalPassage(prev.y, curr.y, prev.x, z),\r\n      };\r\n    }\r\n\r\n    prevRoom = room;\r\n  }\r\n\r\n  dungeon.rooms = rooms;\r\n  dungeon.tiles = { ...dungeon.tiles, ...roomTiles, ...passageTiles };\r\n\r\n  Object.keys(dungeon.tiles).forEach((key) => {\r\n    const tile = dungeon.tiles[key];\r\n    if (tile.sprite === 'WALL') {\r\n      world.createPrefab('Wall').add(Position, { ...dungeon.tiles[key], z });\r\n    }\r\n\r\n    if (tile.sprite === 'FLOOR') {\r\n      world.createPrefab('Floor').add(Position, { ...dungeon.tiles[key], z });\r\n    }\r\n  });\r\n\r\n  return dungeon;\r\n};\r\n\r\nexport const getOpenTiles = (dungeon) => {\r\n  const openTiles = Object.values(dungeon.tiles).filter(\r\n    (x) => x.sprite === 'FLOOR'\r\n  );\r\n  return sample(openTiles);\r\n};\r\n\r\nexport const createDungeonLevel = ({\r\n  createStairsUp = true,\r\n  createStairsDown = true,\r\n} = {}) => {\r\n  const currentLevel = Math.abs(readCache('z'));\r\n  const dimensions =\r\n    DUNGEON_LAYOUT[getHighestMatch(Object.keys(DUNGEON_LAYOUT), currentLevel)];\r\n\r\n  const dungeon = createDungeon({\r\n    x: grid.map.x,\r\n    y: grid.map.y,\r\n    z: readCache('z'),\r\n    width: dimensions.width,\r\n    height: dimensions.height,\r\n    maxRoomCount: dimensions.maxRoomCount,\r\n  });\r\n\r\n  generateEntities(currentLevel, MAX_ITEMS_BY_FLOOR, ITEM_WEIGHT, dungeon);\r\n  generateAffixes();\r\n\r\n  generateEntities(\r\n    currentLevel,\r\n    MAX_MONSTERS_BY_FLOOR,\r\n    MONSTER_WEIGHT,\r\n    dungeon\r\n  );\r\n\r\n  let stairsUp, stairsDown;\r\n\r\n  if (createStairsUp) {\r\n    times(1, () => {\r\n      stairsUp = world.createPrefab('StairsUp');\r\n      stairsUp.add(Position, getOpenTiles(dungeon));\r\n    });\r\n  }\r\n\r\n  if (createStairsDown) {\r\n    times(1, () => {\r\n      stairsDown = world.createPrefab('StairsDown');\r\n      stairsDown.add(Position, getOpenTiles(dungeon));\r\n    });\r\n  }\r\n\r\n  return { dungeon, stairsUp, stairsDown };\r\n};\r\n\r\nconst generateEntities = (level, maxEntitiesByFloor, entityWeight, dungeon) => {\r\n  const amount =\r\n    maxEntitiesByFloor[getHighestMatch(Object.keys(maxEntitiesByFloor), level)];\r\n  getEntitiesAtRandom(entityWeight, amount, level, dungeon);\r\n};\r\n\r\nconst getEntitiesAtRandom = (\r\n  weightedChances,\r\n  amountOfEntities,\r\n  currentLevel,\r\n  dungeon\r\n) => {\r\n  const entityWeightedChances = getEntityChancesForLevel(\r\n    weightedChances,\r\n    currentLevel\r\n  );\r\n\r\n  times(Math.floor(Math.random() * amountOfEntities + 1), () => {\r\n    let prefab = getWeightedValue(entityWeightedChances);\r\n    world.createPrefab(prefab).add(Position, getOpenTiles(dungeon));\r\n  });\r\n};\r\n\r\n/**\r\n * generates affixes and associates them to existing equippable items on the floor\r\n */\r\nconst generateAffixes = () => {\r\n  const equippableItems = world\r\n    .createQuery({ all: [IsEquippable, IsPickup], none: [Dropped] })\r\n    .get();\r\n\r\n  equippableItems.forEach((item) => {\r\n    if (item.slot.name === 'weapon') {\r\n      addAffix(item, WEAPON_PREFIXES);\r\n      return;\r\n    }\r\n\r\n    // suffix\r\n    addAffix(item, ARMOR_SUFFIXES);\r\n\r\n    // prefix\r\n\r\n    addAffix(item, ARMOR_PREFIXES);\r\n  });\r\n};\r\n\r\n/**\r\n * adds affixes to an item based on an object\r\n * affixes structure:\r\n * {\r\n *    healthy: { component: 'health', delta: 1,},\r\n *    stalwart: {component: 'health', delta: 2,},\r\n *    virile: { component: 'health', delta: 3,},\r\n * };\r\n *\r\n * @param {entity} item\r\n * @param {Object} affixes\r\n */\r\nconst addAffix = (item, affixes) => {\r\n  times(getWeightedNumber(false), () => {\r\n    const affix = Object.keys(affixes)[getWeightedNumber()];\r\n    item.add(EquipmentEffect, affixes[affix]);\r\n    item.description.name = `${affix} ${item.description.name}`;\r\n  });\r\n};\r\n\r\n/**\r\n * Generate a weighted number\r\n * if isAffix is true, it generates a number between 0 and 2\r\n * this number is used to generate the specific affix.\r\n *\r\n * if isAffix is false, it generates a number between 0 and 1\r\n * this number is used to define how many affixes are generated\r\n *\r\n * @param {Boolean} isAffix\r\n * @returns Number\r\n */\r\nconst getWeightedNumber = (isAffix = true) => {\r\n  const rng = Math.floor(Math.random() * 20 + 1);\r\n\r\n  if (!isAffix) {\r\n    if (rng <= 13) return 0;\r\n    return 1;\r\n  }\r\n\r\n  if (rng <= 10) return 0;\r\n  if (rng <= 16) return 1;\r\n  return 2;\r\n};\r\n","import some from 'lodash/some';\r\nimport times from 'lodash/times';\r\nimport PF from 'pathfinding';\r\nimport { readCache, readCacheSet } from '../state/cache';\r\nimport world from '../state/ecs';\r\nimport { grid } from './canvas';\r\nimport { toCell } from './grid';\r\n\r\nconst baseMatrix = [];\r\ntimes(grid.height, () => baseMatrix.push(new Array(grid.width).fill(0)));\r\n\r\nexport const aStar = (start, goal) => {\r\n  const matrix = JSON.parse(JSON.stringify(baseMatrix));\r\n\r\n  const locIds = Object.keys(readCache('entitiesAtLocation'));\r\n\r\n  locIds.forEach((locId) => {\r\n    const cell = toCell(locId);\r\n    if (cell.z === readCache('z')) {\r\n      if (\r\n        some([...readCacheSet('entitiesAtLocation', locId)], (eId) => {\r\n          return world.getEntity(eId).isBlocking;\r\n        })\r\n      ) {\r\n        matrix[cell.y][cell.x] = 1;\r\n      }\r\n    }\r\n  });\r\n\r\n  matrix[start.y][start.x] = 0;\r\n  matrix[goal.y][goal.x] = 0;\r\n\r\n  const grid = new PF.Grid(matrix);\r\n  const finder = new PF.AStarFinder({\r\n    allowDiagonal: false,\r\n    dontCrossCorners: true,\r\n  });\r\n\r\n  const path = finder.findPath(start.x, start.y, goal.x, goal.y, grid);\r\n\r\n  return path;\r\n};\r\n","import { aStar } from '../lib/pathfinding';\r\nimport { readCache } from '../state/cache';\r\nimport { Ai, Description, IsInFov, Move } from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst aiEntities = world.createQuery({\r\n  all: [Ai, Description],\r\n});\r\n\r\nexport const ai = (player) => {\r\n  aiEntities.get().forEach((entity) => {\r\n    if (entity.has(IsInFov)) {\r\n      moveToTarget(entity, player);\r\n    }\r\n  });\r\n};\r\n\r\nconst moveToTarget = (entity, target) => {\r\n  const path = aStar(entity.position, target.position);\r\n\r\n  if (path.length) {\r\n    const newLoc = path[1];\r\n    entity.add(Move, {\r\n      x: newLoc[0],\r\n      y: newLoc[1],\r\n      z: readCache('z'),\r\n      relative: false,\r\n    });\r\n  }\r\n};\r\n","import last from 'lodash/last';\r\nimport { gameState } from '..';\r\nimport { clearCanvas, drawCell } from '../lib/canvas';\r\nimport { Animate } from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst animatingEntities = world.createQuery({\r\n  all: [Animate],\r\n});\r\n\r\nconst hexToRgb = (hex) => {\r\n  let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  return result\r\n    ? {\r\n        r: parseInt(result[1], 16),\r\n        g: parseInt(result[2], 16),\r\n        b: parseInt(result[3], 16),\r\n      }\r\n    : {};\r\n};\r\n\r\nexport const animation = () => {\r\n  if (gameState !== 'GAME') {\r\n    return;\r\n  }\r\n\r\n  animatingEntities.get().forEach((entity) => {\r\n    const animate = last(entity.animate);\r\n\r\n    const { r = 255, g = 255, b = 255 } = hexToRgb(animate.color);\r\n\r\n    const time = new Date();\r\n    // set animation startTime\r\n    if (!animate.startTime) {\r\n      entity.fireEvent('set-start-time', { time });\r\n    }\r\n\r\n    const frameTime = time - animate.startTime;\r\n    // end animation when complete\r\n    if (frameTime > animate.duration) {\r\n      return entity.remove(animate);\r\n    }\r\n    const framePercent = frameTime / animate.duration;\r\n    // do the animation\r\n    // clear the cell first\r\n    clearCanvas(entity.position.x, entity.position.y, 1, 1);\r\n\r\n    // redraw the existing entity\r\n    drawCell(entity);\r\n\r\n    // draw the animation over top\r\n    drawCell({\r\n      appearance: {\r\n        char: animate.char || entity.appearance.char,\r\n        color: `rgba(${r}, ${g}, ${b}, ${1 - framePercent})`,\r\n        background: 'transparent',\r\n      },\r\n      position: entity.position,\r\n    });\r\n  });\r\n};\r\n","import { ActiveEffects, Animate } from '../state/components/';\r\nimport { Frozen, Paralyzed, Poisoned } from '../state/components/StatusEffects';\r\nimport world from '../state/ecs';\r\nimport { toCamelCase } from '../utils/misc';\r\n\r\nconst classes = { Frozen, Paralyzed, Poisoned };\r\n\r\nconst activeEffectsEntities = world.createQuery({\r\n  all: [ActiveEffects],\r\n});\r\n\r\nexport const effects = () => {\r\n  activeEffectsEntities.get().forEach((entity) => {\r\n    entity.activeEffects.forEach((c) => {\r\n      if (entity[c.component]) {\r\n        entity[c.component].current += c.delta;\r\n\r\n        if (entity[c.component].current > entity[c.component].max) {\r\n          entity[c.component].current = entity[c.component].max;\r\n        }\r\n      }\r\n\r\n      if (c.events.length) {\r\n        c.events.forEach((event) => entity.fireEvent(event.name, event.args));\r\n      }\r\n\r\n      //handle addComponents\r\n      if (c.addComponents.length) {\r\n        c.addComponents.forEach((component) => {\r\n          if (!entity.has(classes[component.name])) {\r\n            entity.add(classes[component.name], component.properties);\r\n          }\r\n        });\r\n      }\r\n\r\n      entity.add(Animate, { ...c.animate });\r\n\r\n      if (!c.duration) {\r\n        c.destroy();\r\n\r\n        if (c.addComponents.length) {\r\n          c.addComponents.forEach((component) => {\r\n            if (entity.has(classes[component.name])) {\r\n              entity.remove(entity[toCamelCase(component.name)]);\r\n            }\r\n          });\r\n        }\r\n      } else {\r\n        c.duration -= 1;\r\n      }\r\n    });\r\n  });\r\n};\r\n","import { addLog } from '..';\r\nimport { EquipmentSlot, IsEquipped } from '../state/components';\r\nimport world from '../state/ecs';\r\n\r\nexport const equipItem = (entity, player) => {\r\n  if (player.equipmentSlot?.[entity.slot.name]) {\r\n    const previousEquipped = world.getEntity(\r\n      player.equipmentSlot?.[entity.slot.name].itemId\r\n    );\r\n    previousEquipped.remove(previousEquipped.isEquipped);\r\n\r\n    player.fireEvent('unequip', previousEquipped);\r\n    player.remove(player.equipmentSlot[previousEquipped.slot.name]);\r\n    addLog(`You unequip ${previousEquipped.description.name}`);\r\n  }\r\n  player.add(EquipmentSlot, {\r\n    name: entity.slot.name,\r\n    itemId: entity.id,\r\n  });\r\n\r\n  entity.add(IsEquipped);\r\n\r\n  player.fireEvent('equip', entity);\r\n  addLog(`You equip ${entity.description.name}`);\r\n};\r\n\r\nexport const unequipItem = (entity, player) => {\r\n  entity.remove(entity.isEquipped);\r\n\r\n  player.fireEvent('unequip', entity);\r\n  player.equipmentSlot[entity.slot.name].destroy();\r\n  addLog(`You unequip ${entity.description.name}`);\r\n};\r\n","import { distance, idToCell } from './grid';\r\n\r\nconst octantTransforms = [\r\n  { xx: 1, xy: 0, yx: 0, yy: 1 },\r\n  { xx: 1, xy: 0, yx: 0, yy: -1 },\r\n  { xx: -1, xy: 0, yx: 0, yy: 1 },\r\n  { xx: -1, xy: 0, yx: 0, yy: -1 },\r\n  { xx: 0, xy: 1, yx: 1, yy: 0 },\r\n  { xx: 0, xy: 1, yx: -1, yy: 0 },\r\n  { xx: 0, xy: -1, yx: 1, yy: 0 },\r\n  { xx: 0, xy: -1, yx: -1, yy: 0 },\r\n];\r\n\r\n// width: width of map (or visible map?)\r\n// height: height of map (or visible map?)\r\nexport default function createFOV(\r\n  opaqueEntities,\r\n  width,\r\n  height,\r\n  originX,\r\n  originY,\r\n  originZ,\r\n  radius\r\n) {\r\n  const visible = new Set();\r\n\r\n  const blockingLocations = new Set();\r\n  opaqueEntities.get().forEach((x) => {\r\n    if (x.position.z === originZ) {\r\n      blockingLocations.add(`${x.position.x},${x.position.y},${x.position.z}`);\r\n    }\r\n  });\r\n\r\n  const isOpaque = (x, y) => {\r\n    const locId = `${x},${y},${originZ}`;\r\n    return !!blockingLocations.has(locId);\r\n  };\r\n  const reveal = (x, y) => {\r\n    return visible.add(`${x},${y},${originZ}`);\r\n  };\r\n\r\n  function castShadows(originX, originY, row, start, end, transform, radius) {\r\n    let newStart = 0;\r\n    if (start < end) return;\r\n\r\n    let blocked = false;\r\n\r\n    for (let distance = row; distance < radius && !blocked; distance++) {\r\n      let deltaY = -distance;\r\n      for (let deltaX = -distance; deltaX <= 0; deltaX++) {\r\n        let currentX = originX + deltaX * transform.xx + deltaY * transform.xy;\r\n        let currentY = originY + deltaX * transform.yx + deltaY * transform.yy;\r\n\r\n        let leftSlope = (deltaX - 0.5) / (deltaY + 0.5);\r\n        let rightSlope = (deltaX + 0.5) / (deltaY - 0.5);\r\n\r\n        if (\r\n          !(\r\n            currentX >= 0 &&\r\n            currentY >= 0 &&\r\n            currentX < width &&\r\n            currentY < height\r\n          ) ||\r\n          start < rightSlope\r\n        ) {\r\n          continue;\r\n        } else if (end > leftSlope) {\r\n          break;\r\n        }\r\n\r\n        if (Math.sqrt(deltaX * deltaX + deltaY * deltaY) <= radius) {\r\n          reveal(currentX, currentY);\r\n        }\r\n\r\n        if (blocked) {\r\n          if (isOpaque(currentX, currentY)) {\r\n            newStart = rightSlope;\r\n            continue;\r\n          } else {\r\n            blocked = false;\r\n            start = newStart;\r\n          }\r\n        } else {\r\n          if (isOpaque(currentX, currentY) && distance < radius) {\r\n            blocked = true;\r\n            castShadows(\r\n              originX,\r\n              originY,\r\n              distance + 1,\r\n              start,\r\n              leftSlope,\r\n              transform,\r\n              radius\r\n            );\r\n            newStart = rightSlope;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  reveal(originX, originY);\r\n  for (let octant of octantTransforms) {\r\n    castShadows(originX, originY, 1, 1, 0, octant, radius);\r\n  }\r\n\r\n  return {\r\n    fov: visible,\r\n    distance: [...visible].reduce((acc, val) => {\r\n      const cell = idToCell(val);\r\n      acc[val] = distance({ x: originX, y: originY }, { x: cell.x, y: cell.y });\r\n      return acc;\r\n    }, {}),\r\n  };\r\n}\r\n","import { grid } from '../lib/canvas';\r\nimport createFOV from '../lib/fov';\r\nimport { readCache, readCacheSet } from '../state/cache';\r\nimport { IsInFov, IsOpaque, IsRevealed } from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst inFovEntities = world.createQuery({\r\n  all: [IsInFov],\r\n});\r\n\r\nconst opaqueEntities = world.createQuery({\r\n  all: [IsOpaque],\r\n});\r\n\r\nexport const fov = (origin) => {\r\n  const { width, height } = grid;\r\n\r\n  const originX = origin.position.x;\r\n  const originY = origin.position.y;\r\n\r\n  const FOV = createFOV(\r\n    opaqueEntities,\r\n    width,\r\n    height,\r\n    originX,\r\n    originY,\r\n    readCache('z'),\r\n    10\r\n  );\r\n\r\n  // clear out stale fov\r\n  inFovEntities.get().forEach((x) => x.remove(x.isInFov));\r\n\r\n  FOV.fov.forEach((locId) => {\r\n    const entitiesAtLoc = readCacheSet('entitiesAtLocation', locId);\r\n\r\n    if (entitiesAtLoc) {\r\n      entitiesAtLoc.forEach((eId) => {\r\n        const entity = world.getEntity(eId);\r\n        entity.add(IsInFov);\r\n        if (!entity.has(IsRevealed)) {\r\n          entity.add(IsRevealed);\r\n        }\r\n      });\r\n    }\r\n  });\r\n};\r\n","import { addLog } from '..';\r\nimport { grid } from '../lib/canvas';\r\nimport { readCacheSet } from '../state/cache';\r\nimport {\r\n  Defense,\r\n  Health,\r\n  Move,\r\n  Paralyzed,\r\n  Position,\r\n} from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst movableEntities = world.createQuery({\r\n  all: [Move],\r\n});\r\n\r\nconst attack = (entity, target) => {\r\n  let damage = entity.power.current - target.defense.current;\r\n  if (damage > 0) {\r\n    target.fireEvent('take-damage', { amount: damage });\r\n  } else {\r\n    damage = 0;\r\n  }\r\n\r\n  if (target.health.current <= 0) {\r\n    return addLog(\r\n      `${entity.description.name} kicked a ${target.description.name} for ${damage} damage and killed ${target.description.name}!`\r\n    );\r\n  }\r\n  addLog(\r\n    `${entity.description.name} kicked ${target.description.name} for ${damage} damage!`\r\n  );\r\n};\r\n\r\nexport const movement = () => {\r\n  movableEntities.get().forEach((entity) => {\r\n    if (entity.has(Paralyzed)) {\r\n      return;\r\n    }\r\n\r\n    let mx = entity.move.x;\r\n    let my = entity.move.y;\r\n    let mz = entity.move.z;\r\n    if (entity.move.relative) {\r\n      mx = entity.position.x + entity.move.x;\r\n      my = entity.position.y + entity.move.y;\r\n    }\r\n\r\n    // this is where we will run any checks to see if entity can move to new location\r\n    // observe map boundaries\r\n    mx = Math.min(grid.map.width + grid.map.x - 1, Math.max(0, mx));\r\n    my = Math.min(grid.map.height + grid.map.y - 1, Math.max(0, my));\r\n\r\n    // check for blockers\r\n    const blockers = [];\r\n    const stairs = [];\r\n\r\n    const entitiesAtLocation = readCacheSet(\r\n      'entitiesAtLocation',\r\n      `${mx},${my},${mz}`\r\n    );\r\n\r\n    for (const eId of entitiesAtLocation) {\r\n      if (world.getEntity(eId).isBlocking) {\r\n        blockers.push(eId);\r\n      }\r\n    }\r\n\r\n    if (blockers.length) {\r\n      blockers.forEach((eId) => {\r\n        const target = world.getEntity(eId);\r\n        if (target.has(Health) && target.has(Defense)) {\r\n          attack(entity, target);\r\n        } else {\r\n          addLog(\r\n            `${entity.description.name} bump into a ${target.description.name}`\r\n          );\r\n        }\r\n      });\r\n      entity.remove(entity.move);\r\n      return;\r\n    }\r\n\r\n    entity.remove(entity.position);\r\n    entity.add(Position, { x: mx, y: my, z: mz });\r\n    entity.remove(entity.move);\r\n  });\r\n};\r\n","export const Sword =\r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"#color\"><g transform=\"scale(-1 -1) translate(-512, -512)\"><path d=\"M24.68 24.68c-3.535 3.537-5.85 9.779-5.85 16.264 0 4.39 1.123 8.6 2.905 12.003l23.41-7.803 7.802-23.409c-3.403-1.782-7.612-2.904-12.003-2.904-6.485 0-12.727 2.314-16.263 5.85zm17.133 40.545L84.49 105.82c2.94-4.483 5.96-8.317 9.486-11.843 3.526-3.525 7.36-6.546 11.843-9.486L65.226 41.814l-5.854 17.558zm64.892 41.48c-3.067 3.067-5.818 6.763-8.872 11.806l77.446 73.667c2.645-3.307 5.214-6.216 7.948-8.95 2.735-2.735 5.644-5.304 8.951-7.949l-73.667-77.446c-5.043 3.054-8.739 5.805-11.806 8.872zm88.941 88.94c-9.114 9.115-17.08 22.447-35.67 50.598l11.092 11.092c34.16-51.62 34.647-52.106 86.267-86.267l-11.092-11.092c-28.15 18.59-41.483 26.556-50.597 35.67zm24.042 24.043c-3.998 3.997-7.577 8.54-11.858 14.661l242.865 237.584 42.474 21.236-21.236-42.474L234.349 207.83c-6.12 4.281-10.664 7.86-14.661 11.858z\"/></g></svg>';\r\n\r\nexport const Helmet =\r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"#color\"><g><path d=\"M240.028 26v221.481L257.065 256l17.037-8.519V26h-34.074zM222.99 60.074c-80.22 0-136.297 56.077-136.297 136.296h119.26l17.037 17.037V60.074zm66.018 0v153.333l17.037-17.037h119.26c0-80.219-56.077-136.296-136.297-136.296zM69.657 213.407v34.074h50.047l-33.01-34.074H69.657zm41.528 0l34.074 34.074h34.074l-34.074-34.074h-34.074zm58.565 0l34.074 34.074h19.167v-8.518l-25.556-25.556H169.75zm144.815 0l-25.556 25.556v8.518h19.167l34.074-34.074h-27.685zm52.176 0l-34.074 34.074h34.074l34.074-34.074H366.74zm58.565 0l-33.01 34.074h50.047v-34.074h-17.037zM86.694 264.52v34.074l120.325 60.694 5.68-36.497-100.449-41.234-8.519-17.037H86.694zm321.575 0l-8.519 17.037-100.448 41.234 5.68 36.497 120.324-60.694v-34.074h-17.037zm-168.241 2.13L222.99 366.74l34.074 17.037 34.074-17.037-17.037-100.093-17.037 8.519-17.037-8.519zM78.176 314.564l-46.852 41.528v59.63l61.76-93.704-14.908-7.454zm355.648 0l-14.907 7.454 61.759 93.703v-59.63l-46.852-41.527zm-324.768 15.972L40.907 432.759l64.954 44.722 58.565-119.259-55.37-27.685zm293.888 0l-55.37 27.685 58.565 119.26 64.954-44.723-68.149-102.222zm-222.546 35.139L120.768 486h89.445l12.778-51.111h25.555v-36.204l-68.148-33.01zm151.204 0l-68.148 33.01v36.203h25.555L301.787 486h89.444l-59.63-120.324z\"/></g></svg>';\r\n\r\nexport const Legs =\r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"#color\"><g><path d=\"M128 22.781c-11.101 10.941-19.822 27.6-26.076 41.203 6.044 20.063 11.083 40.869 27.539 54.926 18.862-14.015 27.05-33.752 35.187-56.351C154.631 51.155 144.412 34.368 128 22.78zm256 0c-16.412 11.587-26.631 28.374-36.65 39.778 8.137 22.599 16.325 42.336 35.187 56.351 16.456-14.057 21.495-34.863 27.54-54.926C403.821 50.381 395.1 33.722 384 22.781zM222.23 46.104c-11.546 2.749-24.948 7.229-37.04 12.68-8.622 28.9-21.924 55.363-45.965 74.734l16.55 177.107-19.933-8.438-14.61-167.787c-16.163-16.006-28.001-43.023-38.39-71.285-3.545-2.304-7.083-4.15-10.621-5.424 6.237 82.926 25.341 186.732 47.006 274.592 2.544-1.159 5.746-2.4 8.724-3.459 29.464 7.318 56.995 29.357 81.848 53.067C192 272 256 160 222.23 46.104zm67.54 0C256 160 320 272 302.2 381.89c24.853-23.71 52.384-45.75 81.848-53.067 2.978 1.06 6.18 2.3 8.724 3.46 21.665-87.86 40.77-191.667 47.006-274.593-3.538 1.274-7.076 3.12-10.62 5.424-10.39 28.262-22.228 55.28-38.391 71.285l-14.61 167.787-19.933 8.438 16.55-177.107c-24.04-19.37-37.343-45.834-45.964-74.735-12.093-5.45-25.495-9.93-37.041-12.68zM129.004 347.83c-13.31 5.672-27.915 18.355-33.014 34.666 23.725 4.679 52.808 18.407 75.524 40.389l3.947 26.867 33.467-12.074-1.33-29.082c-19.75-28.701-51.073-52.92-78.594-60.766zm253.992 0c-27.52 7.846-58.843 32.065-78.594 60.766l-1.33 29.082 33.467 12.074 3.947-26.867c22.716-21.982 51.8-35.71 75.524-40.389-5.099-16.311-19.704-28.994-33.014-34.666zM90.69 399.703l-52.257 39.272c-10.312 15.251-12.923 32.609-8.657 47.158 52.559 9.293 88.252-3.287 129.043-25.838l-4.275-29.084c-14.703-15.135-33.665-26.354-63.854-31.508zm330.622 0c-30.189 5.154-49.151 16.373-63.854 31.508l-4.275 29.084c40.791 22.55 76.484 35.131 129.043 25.838 4.266-14.55 1.655-31.907-8.657-47.158l-52.257-39.272z\"/></g></svg>';\r\n\r\nexport const Chest =\r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"#color\"><g><path d=\"M162 35.75l-94.49 27.1c-12.05 6.3-23.47 23.9-31.01 46.35-6.07 18.2-9.62 38.9-10.93 58.3L136.7 112zm188 .1L375.4 112l111 55.6c-1.3-19.3-4.9-40.2-10.9-58.3-5.7-17.05-13.6-31.35-22.5-40.05-2.7-2.8-5.5-4.9-8.4-6.4zm-172.9 11.5l-25.7 77.45-92.9 46.4 14.08 53.5 88.82 44.4 94.6-15.9 94.6 15.9 88.8-44.4 14.1-53.5-92.8-46.4-25.8-77.35h-10.5l-59.3 73.95-.1 61.1h-18.1l.1-61-59.3-74.15zM78.65 247.7l22.05 83.9 146.2-43.8v-14.7l-88.4 14.7zm354.75 0l-80 40.1-88.4-14.7v14.7l146.3 43.8zm-186.5 58.7l-31.6 9.6-35.1 70.2 66.7-33.3zm18.1 0v46.5l66.9 33.4-35.2-70.3zM191.7 323l-86.4 26 25.3 96.3zm128.6.1l61.1 122.1 25.3-96.2zm-55.3 50l.1 43.2 100.7 37.8-20.4-40.8zm-18.1 0l-80.2 40.1-20.5 40.9L247 416.3zm.1 62.4l-81.6 30.6 81.6 10.2zm18.1 0v40.7l81.7-10.2z\"/></g></svg>';\r\n\r\nexport const Shield =\r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"#color\"><g><path d=\"M129.656 21.188L37.936 79.78c3.54 26.805 8.915 53.547 16.127 80.126L240.72 39.594l-19.282-12.5c-31.28-.885-62.204-2.842-91.782-5.907zm253.47.625c-40.51 3.975-83.496 5.938-126.47 5.843l204.625 132.72c7.108-25.89 12.487-51.92 16.095-78.032l-94.25-60.53zM257.937 50.75L59.468 178.656c8.025 26.32 17.865 52.456 29.532 78.313l243.25-158-74.313-48.22zm91.468 59.344l-74.562 48.437 151.28 98.782c11.714-25.803 21.592-51.91 29.688-78.187l-106.406-69.03zm-91.687 59.562L97 274.062c12.202 25.17 26.14 50.064 41.844 74.563l196.094-128.53-77.22-50.44zM352 231.22l-77.53 50.843 101.405 67.187c15.822-24.6 29.895-49.584 42.22-74.875L352 231.22zm-94.53 61.968l-108.345 71.03c13.564 20.062 28.326 39.847 44.28 59.313l132.032-85.28-67.968-45.063zm84.967 56.312L274.5 393.406l47.03 30.375c15.845-19.342 30.513-38.993 44.033-58.936L342.438 349.5zm-84.968 54.875L205.5 437.97c16.233 18.933 33.614 37.54 52.156 55.78 18.385-18.152 35.637-36.678 51.78-55.53l-52.092-33.626.125-.22z\"/></g></svg>';\r\n","import throttle from 'lodash/throttle';\r\nimport { gameState, messageLog, selectedInventoryIndex, targetRange } from '..';\r\nimport {\r\n  clearCanvas,\r\n  drawCell,\r\n  drawCircle,\r\n  drawImage,\r\n  drawRect,\r\n  drawText,\r\n  grid,\r\n  pxToCell,\r\n} from '../lib/canvas';\r\nimport { Chest, Helmet, Legs, Shield, Sword } from '../lib/equipment';\r\nimport { toLocId } from '../lib/grid';\r\nimport { readCache, readCacheSet } from '../state/cache';\r\nimport {\r\n  Appearance,\r\n  EquipmentEffect,\r\n  Inventory,\r\n  IsInFov,\r\n  IsRevealed,\r\n  Layer100,\r\n  Layer300,\r\n  Layer400,\r\n  Position,\r\n} from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst layer100Entities = world.createQuery({\r\n  all: [Position, Appearance, Layer100],\r\n  any: [IsInFov, IsRevealed],\r\n});\r\n\r\nconst layer300Entities = world.createQuery({\r\n  all: [Position, Appearance, Layer300],\r\n  any: [IsInFov, IsRevealed],\r\n});\r\n\r\nconst layer400Entities = world.createQuery({\r\n  all: [Position, Appearance, Layer400, IsInFov],\r\n});\r\n\r\nconst clearMap = () => {\r\n  clearCanvas(grid.map.x - 1, grid.map.y, grid.map.width + 1, grid.map.height);\r\n};\r\n\r\nexport const renderMap = (player) => {\r\n  clearMap();\r\n\r\n  layer100Entities.get().forEach((entity) => {\r\n    if (entity.position.z !== readCache('z')) return;\r\n\r\n    if (entity.isInFov) {\r\n      drawCell(entity);\r\n    } else {\r\n      drawCell(entity, { color: '#333' });\r\n    }\r\n  });\r\n\r\n  layer300Entities.get().forEach((entity) => {\r\n    if (entity.position.z !== readCache('z')) return;\r\n\r\n    if (entity.isInFov) {\r\n      drawCell(entity);\r\n    } else {\r\n      drawCell(entity, { color: '#333' });\r\n    }\r\n  });\r\n\r\n  layer400Entities.get().forEach((entity) => {\r\n    if (entity.position.z !== readCache('z')) return;\r\n\r\n    if (entity.isInFov) {\r\n      drawCell(entity);\r\n    } else {\r\n      drawCell(entity, { color: '#100' });\r\n    }\r\n  });\r\n};\r\n\r\nconst clearPlayerHud = () => {\r\n  clearCanvas(\r\n    grid.playerHud.x,\r\n    grid.playerHud.y,\r\n    grid.playerHud.width + 1,\r\n    grid.playerHud.height\r\n  );\r\n};\r\n\r\nconst renderPlayerHud = (player) => {\r\n  clearPlayerHud();\r\n\r\n  drawText({\r\n    text: `${player.appearance.char} ${player.description.name}`,\r\n    background: `${player.appearance.background}`,\r\n    color: `${player.appearance.color}`,\r\n    x: grid.playerHud.x,\r\n    y: grid.playerHud.y,\r\n  });\r\n\r\n  const goodHealth =\r\n    player.health.current > player.health.base / 2 ? true : false;\r\n  drawText({\r\n    text: `${player.health.current}/${player.health.base} HP`,\r\n    background: 'black',\r\n    color: `${goodHealth ? 'green' : 'red'}`,\r\n    x: grid.playerHud.x,\r\n    y: grid.playerHud.y + 1,\r\n  });\r\n\r\n  drawText({\r\n    text: `Depth: ${Math.abs(readCache('z'))}`,\r\n    background: 'black',\r\n    color: '#666',\r\n    x: grid.playerHud.x,\r\n    y: grid.playerHud.y + 2,\r\n  });\r\n\r\n  drawText({\r\n    text: `Power: ${player.power.current}`,\r\n    background: 'black',\r\n    color: '#DDD',\r\n    x: grid.playerHud.x,\r\n    y: grid.playerHud.y + 4,\r\n  });\r\n\r\n  drawText({\r\n    text: `Defense: ${player.defense.current}`,\r\n    background: 'black',\r\n    color: '#DDD',\r\n    x: grid.playerHud.x,\r\n    y: grid.playerHud.y + 5,\r\n  });\r\n};\r\n\r\nconst clearPlayerEquipment = () => {\r\n  clearCanvas(\r\n    grid.playerEquipment.x,\r\n    grid.playerEquipment.y,\r\n    grid.playerEquipment.width + 1,\r\n    grid.playerEquipment.height\r\n  );\r\n};\r\n\r\nconst renderPlayerEquipment = (player) => {\r\n  clearPlayerEquipment();\r\n  let equipmentSlots = [\r\n    { head: Helmet },\r\n    { weapon: Sword },\r\n    { chest: Chest },\r\n    { shield: Shield },\r\n    { legs: Legs },\r\n  ];\r\n\r\n  equipmentSlots.forEach((slot) => {\r\n    const [name, image] = Object.entries(slot)[0];\r\n    drawImage({\r\n      x: grid.playerEquipment[name].x,\r\n      y: grid.playerEquipment[name].y,\r\n      width: 3,\r\n      height: 3,\r\n      image: image,\r\n      color: player.equipmentSlot?.[name] ? '#FFFFFF' : '#111111',\r\n    });\r\n  });\r\n};\r\n\r\nconst clearEquipmentInfo = () => {\r\n  clearCanvas(\r\n    grid.equipmentInfo.x,\r\n    grid.equipmentInfo.y,\r\n    grid.equipmentInfo.width + 1,\r\n    grid.equipmentInfo.height\r\n  );\r\n};\r\n\r\nconst renderEquipmentInfo = (item) => {\r\n  clearEquipmentInfo();\r\n\r\n  drawText({\r\n    text: `${item.appearance.char} ${item.description.name}`,\r\n    background: `${item.appearance.background}`,\r\n    color: `#DDD`,\r\n    x: grid.equipmentInfo.x,\r\n    y: grid.equipmentInfo.y,\r\n  });\r\n\r\n  if (item.has(EquipmentEffect)) {\r\n    item.equipmentEffect.forEach((effect, index) => {\r\n      drawText({\r\n        text: `${effect.component}: +${effect.delta}`,\r\n        background: 'black',\r\n        color: '#DDD',\r\n        x: grid.equipmentInfo.x,\r\n        y: grid.equipmentInfo.y + index + 1,\r\n      });\r\n    });\r\n  }\r\n};\r\n\r\nconst hoverEquipment = (x, y) => {\r\n  let equipmentSlots = [\r\n    { head: Helmet },\r\n    { weapon: Sword },\r\n    { chest: Chest },\r\n    { shield: Shield },\r\n    { legs: Legs },\r\n  ];\r\n\r\n  equipmentSlots.forEach((slot) => {\r\n    const [name] = Object.entries(slot)[0];\r\n    if (\r\n      x >= grid.playerEquipment[name].x &&\r\n      x <= grid.playerEquipment[name].x + 3 &&\r\n      y >= grid.playerEquipment[name].y &&\r\n      y <= grid.playerEquipment[name].y + 3\r\n    ) {\r\n      const query = world.createQuery({\r\n        all: [Inventory],\r\n      });\r\n\r\n      let player = query.get()[0];\r\n      if (player.equipmentSlot?.[name]) {\r\n        const item = world.getEntity(player.equipmentSlot?.[name].itemId);\r\n        renderEquipmentInfo(item);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nconst clearMessageLog = () => {\r\n  clearCanvas(\r\n    grid.messageLog.x,\r\n    grid.messageLog.y,\r\n    grid.messageLog.width + 1,\r\n    grid.messageLog.height\r\n  );\r\n};\r\n\r\nconst renderMessageLog = () => {\r\n  clearMessageLog();\r\n\r\n  drawText({\r\n    text: messageLog[2],\r\n    background: '#000',\r\n    color: '#666',\r\n    x: grid.messageLog.x,\r\n    y: grid.messageLog.y,\r\n  });\r\n\r\n  drawText({\r\n    text: messageLog[1],\r\n    background: '#000',\r\n    color: '#aaa',\r\n    x: grid.messageLog.x,\r\n    y: grid.messageLog.y + 1,\r\n  });\r\n\r\n  drawText({\r\n    text: messageLog[0],\r\n    background: '#000',\r\n    color: '#fff',\r\n    x: grid.messageLog.x,\r\n    y: grid.messageLog.y + 2,\r\n  });\r\n};\r\n\r\n//info bar on mouseover\r\nconst clearInfoBar = () => {\r\n  drawText({\r\n    text: ` `.repeat(grid.infoBar.width),\r\n    x: grid.infoBar.x,\r\n    y: grid.infoBar.y,\r\n    background: 'black',\r\n  });\r\n};\r\n\r\nconst renderInfoBar = (mPos) => {\r\n  clearInfoBar();\r\n\r\n  const { x, y, z } = mPos;\r\n  const locId = toLocId({ x, y, z });\r\n\r\n  const esAtLoc = readCacheSet('entitiesAtLocation', locId) || [];\r\n  const entitiesAtLoc = [...esAtLoc];\r\n\r\n  clearInfoBar();\r\n\r\n  if (entitiesAtLoc) {\r\n    if (entitiesAtLoc.some((eId) => world.getEntity(eId).isRevealed)) {\r\n      drawCell({\r\n        appearance: {\r\n          char: '',\r\n          background: 'rgba(255,255,255, 0.5)',\r\n        },\r\n        position: { x, y, z },\r\n      });\r\n    }\r\n\r\n    entitiesAtLoc\r\n      .filter((eId) => {\r\n        const entity = world.getEntity(eId);\r\n        return (\r\n          layer100Entities.matches(entity) ||\r\n          layer300Entities.matches(entity) ||\r\n          layer400Entities.matches(entity)\r\n        );\r\n      })\r\n      .forEach((eId) => {\r\n        const entity = world.getEntity(eId);\r\n        clearInfoBar();\r\n\r\n        const isPlural =\r\n          [...entity.description.name][\r\n            [...entity.description.name].length - 1\r\n          ] === 's'\r\n            ? true\r\n            : false;\r\n\r\n        const entityText = `${!isPlural ? 'a ' : ''}${\r\n          entity.description.name\r\n        }(${entity.appearance.char})`;\r\n\r\n        if (entity.isInFov) {\r\n          drawText({\r\n            text: `You see ${entityText} here.`,\r\n            x: grid.infoBar.x,\r\n            y: grid.infoBar.y,\r\n            color: 'white',\r\n            background: 'black',\r\n          });\r\n        } else {\r\n          drawText({\r\n            text: `You remember seeing ${entityText} here.`,\r\n            x: grid.infoBar.x,\r\n            y: grid.infoBar.y,\r\n            color: 'white',\r\n            background: 'black',\r\n          });\r\n        }\r\n      });\r\n  }\r\n};\r\n\r\nconst renderInventory = (player) => {\r\n  // translucent to obscure the game map\r\n  drawRect(0, 0, grid.width, grid.height, 'rgba(0,0,0,0.65)');\r\n\r\n  drawText({\r\n    text: 'INVENTORY',\r\n    background: 'black',\r\n    color: 'white',\r\n    x: grid.inventory.x,\r\n    y: grid.inventory.y,\r\n  });\r\n\r\n  drawText({\r\n    text: '(c)Consume (d)Drop (e)Equip',\r\n    background: 'black',\r\n    color: '#666',\r\n    x: grid.inventory.x,\r\n    y: grid.inventory.y + 1,\r\n  });\r\n\r\n  if (player.inventory.inventoryItems.length) {\r\n    player.inventory.inventoryItems.forEach((item, index) => {\r\n      drawText({\r\n        text: `${index === selectedInventoryIndex ? '*' : ' '}${\r\n          item.description.name\r\n        }${item.isEquipped ? '[e]' : ''}`,\r\n        background: 'black',\r\n        color: 'white',\r\n        x: grid.inventory.x,\r\n        y: grid.inventory.y + 3 + index,\r\n      });\r\n    });\r\n  } else {\r\n    drawText({\r\n      text: '-empty-',\r\n      background: 'black',\r\n      color: '#666',\r\n      x: grid.inventory.x,\r\n      y: grid.inventory.y + 3,\r\n    });\r\n  }\r\n};\r\n\r\nconst renderTargeting = (mPos) => {\r\n  const { x, y, z } = mPos;\r\n  const locId = toLocId({ x, y, z });\r\n  const esAtLoc = readCacheSet('entitiesAtLocation', locId) || [];\r\n  const entitiesAtLoc = [...esAtLoc];\r\n\r\n  clearInfoBar();\r\n\r\n  if (entitiesAtLoc) {\r\n    if (entitiesAtLoc.some((eId) => world.getEntity(eId).isRevealed)) {\r\n      if (targetRange > 1) {\r\n        drawCircle(x, y, targetRange);\r\n        return;\r\n      }\r\n      drawCell({\r\n        appearance: {\r\n          char: '',\r\n          background: 'rgba(74, 232, 218, 0.5)',\r\n        },\r\n        position: { x, y, z },\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nconst renderMenu = () => {\r\n  drawText({\r\n    text: `(n)New (s)Save (l)Load | (i)Inventory (g)Pickup (arrow keys)Move/Attack (mouse)Look/Target`,\r\n    background: '#000',\r\n    color: '#666',\r\n    x: grid.menu.x,\r\n    y: grid.menu.y,\r\n  });\r\n};\r\n\r\nexport const render = (player) => {\r\n  renderMap();\r\n  renderPlayerHud(player);\r\n  renderPlayerEquipment(player);\r\n  renderMessageLog();\r\n  renderMenu();\r\n\r\n  if (gameState === 'INVENTORY') {\r\n    renderInventory(player);\r\n  }\r\n};\r\n\r\nconst canvas = document.querySelector('canvas');\r\ncanvas.onmousemove = throttle((e) => {\r\n  if (gameState === 'GAME') {\r\n    const [x, y] = pxToCell(e);\r\n\r\n    if (\r\n      x >= grid.playerEquipment.x &&\r\n      y >= grid.playerEquipment.y &&\r\n      x <= grid.playerEquipment.x + grid.playerEquipment.width &&\r\n      y <= grid.playerEquipment.y + grid.playerEquipment.height\r\n    ) {\r\n      clearEquipmentInfo();\r\n      hoverEquipment(x, y);\r\n    }\r\n\r\n    renderMap();\r\n    renderInfoBar({ x, y, z: readCache('z') });\r\n  }\r\n\r\n  if (gameState === 'TARGETING') {\r\n    const [x, y] = pxToCell(e);\r\n    renderMap();\r\n    renderTargeting({ x, y, z: readCache('z') });\r\n  }\r\n}, 100);\r\n","import { addLog } from '..';\r\nimport { readCacheSet } from '../state/cache';\r\nimport {\r\n  ActiveEffects,\r\n  Effects,\r\n  Target,\r\n  TargetingItem,\r\n} from '../state/components/';\r\nimport world from '../state/ecs';\r\n\r\nconst targetingEntities = world.createQuery({\r\n  all: [Target, TargetingItem],\r\n});\r\n\r\nexport const targeting = (player) => {\r\n  targetingEntities.get().forEach((entity) => {\r\n    const item = world.getEntity(entity.targetingItem.itemId);\r\n\r\n    if (item && item.has(Effects)) {\r\n      entity.target.forEach((t, idx) => {\r\n        const targets = readCacheSet('entitiesAtLocation', t.locId);\r\n\r\n        targets.forEach((eId) => {\r\n          const target = world.getEntity(eId);\r\n          if (target.isInFov) {\r\n            item.effects.forEach((x) => {\r\n              target.add(ActiveEffects, { ...x.serialize() });\r\n            });\r\n          }\r\n        });\r\n        entity.remove(entity.target[idx]);\r\n      });\r\n      entity.remove(entity.targetingItem);\r\n\r\n      addLog(`You use a ${item.description.name}`);\r\n      player.fireEvent('consume', item);\r\n    }\r\n  });\r\n};\r\n","import get from 'lodash/get';\r\nimport sample from 'lodash/sample';\r\nimport Favicon from './images/favicon.png';\r\nimport './lib/canvas';\r\nimport { pxToCell } from './lib/canvas';\r\nimport { createDungeonLevel, getOpenTiles } from './lib/dungeon';\r\nimport { circle, toCell, toLocId } from './lib/grid';\r\nimport {\r\n  addCache,\r\n  clearCache,\r\n  deserializeCache,\r\n  readCache,\r\n  readCacheSet,\r\n  serializeCache,\r\n} from './state/cache';\r\nimport {\r\n  ActiveEffects,\r\n  Ai,\r\n  Dropped,\r\n  Effects,\r\n  IsDead,\r\n  IsEquipped,\r\n  IsInFov,\r\n  Move,\r\n  Position,\r\n  Target,\r\n  TargetingItem,\r\n} from './state/components/';\r\nimport world from './state/ecs';\r\nimport { ai } from './systems/ai';\r\nimport { animation } from './systems/animation';\r\nimport { effects } from './systems/effects';\r\nimport { equipItem, unequipItem } from './systems/equip';\r\nimport { fov } from './systems/fov';\r\nimport { movement } from './systems/movement';\r\nimport { render } from './systems/render';\r\nimport { targeting } from './systems/targeting';\r\n\r\nif (!document.getElementById('favicon')) {\r\n  const favicon = document.createElement('link');\r\n  favicon.id = 'favicon';\r\n  favicon.rel = 'icon';\r\n  favicon.href = Favicon;\r\n\r\n  document.head.appendChild(favicon);\r\n}\r\n\r\nexport let messageLog = ['', \"Welcome to Gobs 'O Goblins!\", ''];\r\nexport const addLog = (text) => {\r\n  messageLog.unshift(text);\r\n};\r\n\r\nconst saveGame = () => {\r\n  const gameSaveData = {\r\n    world: world.serialize(),\r\n    cache: serializeCache(),\r\n    playerId: player.id,\r\n    messageLog,\r\n  };\r\n  localStorage.setItem('gameSaveData', JSON.stringify(gameSaveData));\r\n  addLog('Game saved');\r\n};\r\n\r\nconst loadGame = () => {\r\n  const data = JSON.parse(localStorage.getItem('gameSaveData'));\r\n  if (!data) {\r\n    addLog('Failed to load - no saved games found');\r\n    return;\r\n  }\r\n\r\n  for (let entity of world.getEntities()) {\r\n    entity.destroy();\r\n  }\r\n  clearCache();\r\n\r\n  world.deserialize(data.world);\r\n  deserializeCache(data.cache);\r\n\r\n  player = world.getEntity(data.playerId);\r\n\r\n  userInput = null;\r\n  playerTurn = true;\r\n  gameState = 'GAME';\r\n  selectedInventoryIndex = 0;\r\n\r\n  messageLog = data.messageLog;\r\n  addLog('Game loaded');\r\n};\r\n\r\nconst newGame = () => {\r\n  for (let item of world.getEntities()) {\r\n    item.destroy();\r\n  }\r\n  clearCache();\r\n\r\n  userInput = null;\r\n  playerTurn = true;\r\n  gameState = 'GAME';\r\n  selectedInventoryIndex = 0;\r\n\r\n  messageLog = ['', \"Welcome to Gobs 'O Goblins!\", ''];\r\n\r\n  initGame();\r\n};\r\n\r\nconst enemiesInFOV = world.createQuery({ all: [IsInFov, Ai] });\r\n\r\nexport const goToDungeonLevel = (level) => {\r\n  const goingUp = readCache('z') < level;\r\n  const floor = readCache('floors')[level];\r\n\r\n  const deadEntities = world.createQuery({ all: [IsDead] }).get();\r\n\r\n  deadEntities.forEach((deadEntity) => deadEntity.destroy());\r\n\r\n  addCache('z', level);\r\n  player.remove(player.position);\r\n\r\n  let newPosition = goingUp ? floor?.stairsDown : floor?.stairsUp;\r\n\r\n  if (!floor) {\r\n    const { stairsDown, stairsUp } = createDungeonLevel();\r\n\r\n    addCache(`floors.${level}`, {\r\n      stairsDown: toLocId(stairsDown.position),\r\n      stairsUp: toLocId(stairsUp.position),\r\n    });\r\n\r\n    newPosition = goingUp ? stairsDown.position : stairsUp.position;\r\n  }\r\n\r\n  player.add(Position, toCell(newPosition));\r\n\r\n  fov(player);\r\n  render(player);\r\n};\r\n\r\nconst initGame = () => {\r\n  const { dungeon, stairsDown, stairsUp } = createDungeonLevel({\r\n    createStairsUp: false,\r\n  });\r\n\r\n  player = world.createPrefab('Player', { health: { base: 20, current: 20 } });\r\n\r\n  addCache(`floors.${-1}`, {\r\n    stairsDown: toLocId(stairsDown.position),\r\n  });\r\n\r\n  const playerSpawn = stairsUp ? stairsUp.position : getOpenTiles(dungeon);\r\n\r\n  player.add(Position, playerSpawn);\r\n\r\n  fov(player);\r\n  render(player);\r\n};\r\n\r\nlet player = {};\r\nlet userInput = null;\r\nlet playerTurn = true;\r\nexport let gameState = 'GAME';\r\nexport let targetRange = 1;\r\nexport let selectedInventoryIndex = 0;\r\n\r\ninitGame();\r\n\r\ndocument.addEventListener('keydown', (ev) => {\r\n  if (ev.key !== 'Shift') {\r\n    userInput = ev.key;\r\n  }\r\n});\r\n\r\nconst processUserInput = () => {\r\n  if (userInput === 'l') {\r\n    loadGame();\r\n  }\r\n\r\n  if (userInput === 'n') {\r\n    newGame();\r\n  }\r\n\r\n  if (userInput === 's') {\r\n    saveGame();\r\n  }\r\n\r\n  if (gameState === 'GAME') {\r\n    if (userInput === '>') {\r\n      if (\r\n        toLocId(player.position) !==\r\n        readCache(`floors.${readCache('z')}.stairsDown`)\r\n      ) {\r\n        addLog('There are no stairs here to descend');\r\n\r\n        userInput = null;\r\n        return;\r\n      }\r\n      addLog('You descend deeper into the dungeon');\r\n      goToDungeonLevel(readCache('z') - 1);\r\n    }\r\n\r\n    if (userInput === '<') {\r\n      if (\r\n        toLocId(player.position) !==\r\n        readCache(`floors.${readCache('z')}.stairsUp`)\r\n      ) {\r\n        addLog('There are no stairs here to climb');\r\n\r\n        userInput = null;\r\n        return;\r\n      }\r\n      addLog('You climb from the depths of the dungeon');\r\n      goToDungeonLevel(readCache('z') + 1);\r\n    }\r\n\r\n    if (userInput === 'ArrowUp') {\r\n      player.add(Move, { x: 0, y: -1, z: readCache('z') });\r\n    }\r\n    if (userInput === 'ArrowRight') {\r\n      player.add(Move, { x: 1, y: 0, z: readCache('z') });\r\n    }\r\n    if (userInput === 'ArrowDown') {\r\n      player.add(Move, { x: 0, y: 1, z: readCache('z') });\r\n    }\r\n    if (userInput === 'ArrowLeft') {\r\n      player.add(Move, { x: -1, y: 0, z: readCache('z') });\r\n    }\r\n\r\n    if (userInput === 'g') {\r\n      let pickupFound = false;\r\n      readCacheSet('entitiesAtLocation', toLocId(player.position)).forEach(\r\n        (eId) => {\r\n          const entity = world.getEntity(eId);\r\n          if (entity.isPickup) {\r\n            pickupFound = true;\r\n            player.fireEvent('pick-up', entity);\r\n            addLog(`You pick up a ${entity.description.name}`);\r\n            if (entity.has(Dropped)) {\r\n              entity.remove(entity.dropped);\r\n            }\r\n          }\r\n        }\r\n      );\r\n      if (!pickupFound) {\r\n        addLog('There is nothing to pick up here');\r\n      }\r\n    }\r\n\r\n    if (userInput === 'i') {\r\n      gameState = 'INVENTORY';\r\n    }\r\n\r\n    if (userInput === 'z') {\r\n      gameState = 'TARGETING';\r\n    }\r\n\r\n    userInput = null;\r\n  }\r\n\r\n  if (gameState === 'TARGETING') {\r\n    if (userInput === 'z' || userInput === 'Escape') {\r\n      player.remove(player.targetingItem);\r\n      gameState = 'GAME';\r\n    }\r\n\r\n    userInput = null;\r\n  }\r\n\r\n  if (gameState === 'INVENTORY') {\r\n    if (userInput === 'i' || userInput === 'Escape') {\r\n      gameState = 'GAME';\r\n    }\r\n\r\n    if (userInput === 'ArrowUp') {\r\n      selectedInventoryIndex -= 1;\r\n      if (selectedInventoryIndex < 0) selectedInventoryIndex = 0;\r\n    }\r\n\r\n    if (userInput === 'ArrowDown') {\r\n      selectedInventoryIndex += 1;\r\n      if (selectedInventoryIndex > player.inventory.inventoryItems.length - 1)\r\n        selectedInventoryIndex = player.inventory.inventoryItems.length - 1;\r\n    }\r\n\r\n    if (userInput === 'c') {\r\n      const entity = player.inventory.inventoryItems[selectedInventoryIndex];\r\n\r\n      if (entity) {\r\n        if (entity.requiresTarget) {\r\n          targetRange = entity.requiresTarget.aoeRange || 1;\r\n\r\n          if (entity.requiresTarget.acquired === 'RANDOM') {\r\n            // get a target that is NOT the player\r\n            const target = sample([...enemiesInFOV.get()]);\r\n            if (target) {\r\n              player.add(TargetingItem, { itemId: entity.id });\r\n              player.add(Target, { locId: toLocId(target.position) });\r\n              targeting(player);\r\n            } else {\r\n              addLog(`The scroll disintegrates uselessly in your hand`);\r\n              player.fireEvent('consume', entity);\r\n            }\r\n          } else if (entity.requiresTarget.acquired === 'MANUAL') {\r\n            player.add(TargetingItem, { itemId: entity.id });\r\n            gameState = 'TARGETING';\r\n            return;\r\n          }\r\n        } else if (entity.has(Effects)) {\r\n          entity.effects.forEach((x) =>\r\n            player.add(ActiveEffects, { ...x.serialize() })\r\n          );\r\n          addLog(`You consume a ${entity.description.name}`);\r\n          player.fireEvent('consume', entity);\r\n        } else {\r\n          addLog(`You can't consume ${entity.description.name}`);\r\n        }\r\n      }\r\n      selectedInventoryIndex = 0;\r\n      gameState = 'GAME';\r\n    }\r\n\r\n    if (userInput === 'd') {\r\n      if (player.inventory.inventoryItems.length) {\r\n        const entity = player.inventory.inventoryItems[selectedInventoryIndex];\r\n        addLog(`You drop a ${entity.description.name}`);\r\n        entity.add(Dropped);\r\n        player.fireEvent('drop', entity);\r\n        if (entity.has(IsEquipped)) {\r\n          unequipItem(entity, player);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (userInput === 'e') {\r\n      const entity = player.inventory.inventoryItems[selectedInventoryIndex];\r\n\r\n      if (entity) {\r\n        if (entity.isEquippable) {\r\n          if (!entity.has(IsEquipped)) {\r\n            equipItem(entity, player);\r\n          } else {\r\n            unequipItem(entity, player);\r\n          }\r\n        }\r\n\r\n        selectedInventoryIndex = 0;\r\n\r\n        gameState = 'GAME';\r\n      }\r\n    }\r\n\r\n    userInput = null;\r\n  }\r\n};\r\n\r\nconst update = () => {\r\n  animation();\r\n\r\n  if (player.isDead) {\r\n    if (gameState !== 'GAMEOVER') {\r\n      addLog('You are dead.');\r\n      render(player);\r\n    }\r\n    gameState = 'GAMEOVER';\r\n    processUserInput();\r\n    return;\r\n  }\r\n\r\n  if (playerTurn && userInput && gameState === 'TARGETING') {\r\n    processUserInput();\r\n    effects();\r\n    render(player);\r\n\r\n    playerTurn = true;\r\n  }\r\n\r\n  if (playerTurn && userInput && gameState === 'INVENTORY') {\r\n    processUserInput();\r\n    effects();\r\n    gameState === 'TARGETING';\r\n    render(player);\r\n    playerTurn = true;\r\n  }\r\n\r\n  if (playerTurn && userInput && gameState === 'GAME') {\r\n    processUserInput();\r\n    effects();\r\n    movement();\r\n    fov(player);\r\n    render(player);\r\n\r\n    playerTurn = false;\r\n  }\r\n\r\n  if (!playerTurn) {\r\n    ai(player);\r\n    effects();\r\n    movement();\r\n    fov(player);\r\n    render(player);\r\n\r\n    playerTurn = true;\r\n  }\r\n};\r\n\r\nconst gameLoop = () => {\r\n  update();\r\n  requestAnimationFrame(gameLoop);\r\n};\r\n\r\nrequestAnimationFrame(gameLoop);\r\n\r\nconst canvas = document.querySelector('#canvas');\r\n\r\ncanvas.onclick = (e) => {\r\n  const [x, y] = pxToCell(e);\r\n  const locId = toLocId({ x, y, z: readCache('z') });\r\n\r\n  if (!readCacheSet('entitiesAtLocation', locId)) return;\r\n\r\n  readCacheSet('entitiesAtLocation', locId).forEach((eId) => {\r\n    const entity = world.getEntity(eId);\r\n\r\n    // Only do this during development\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(\r\n        `${get(entity, 'appearance.char', '?')} ${get(\r\n          entity,\r\n          'description.name',\r\n          '?'\r\n        )}`,\r\n        entity.serialize()\r\n      );\r\n    }\r\n\r\n    if (gameState === 'TARGETING') {\r\n      const entity = player.inventory.inventoryItems[selectedInventoryIndex];\r\n      if (entity.requiresTarget.aoeRange) {\r\n        const targets = circle({ x, y }, entity.requiresTarget.aoeRange).map(\r\n          (locId) => `${locId},${readCache('z')}`\r\n        );\r\n        targets.forEach((locId) => player.add(Target, { locId }));\r\n      } else {\r\n        player.add(Target, { locId });\r\n      }\r\n      gameState = 'GAME';\r\n      targeting(player);\r\n      effects();\r\n      render(player);\r\n    }\r\n  });\r\n};\r\n"],"sourceRoot":""}